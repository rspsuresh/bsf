    <style>
	#dataTable .jqx-grid-header 	{height:75px !important;}
	.mar_20{margin-top:20px!important;}
	/* Excel Floating Icon */
    .fixed-action-btn          	    {position:fixed;top:85px;right:5px;padding-top:15px;margin-bottom:0;z-index:998;}
    .fixed-action-btn:hover ul li a.btn-floating{transform: scaleY(1) scaleX(1) translateX(0px);opacity: 1;}
    .btn-floating.btn-large         {width:45px;height:45px;}
    .fixed-action-btn ul 			{left:-142px;right:0;text-align:center;position:absolute;margin:0;top:22px;}
    .fixed-action-btn ul li 		{margin-left:8px;list-style-type:none;float:left;}
    .fixed-action-btn ul li a.btn-floating {transform: scaleY(0.4) scaleX(0.4) translateX(40px);opacity: 0;}
    .fixed-action-btn ul a.btn-floating i  {font-size: 17px;line-height: 37px;}
    .btn-floating                   {display:inline-block;color:#fff;position:relative;overflow:hidden;z-index:1;width:37px;height:37px;line-height:37px;padding: 0;
        background-color: #26a69a;border-radius:50%;cursor:pointer;vertical-align: middle;
        box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);text-decoration: none;transition: all .3s ease;
        -webkit-transition: all .3s ease; -moz-transition: all .3s ease; -o-transition: all .3s ease;}
    .btn-floating i                 {width: inherit;display: inline-block;text-align: center;color: #fff;font-size:20px;line-height: 45px; font-weight:normal; color:#fff;}
    .next-bt                        {text-align:center;}
    .next-bt a:hover                {border:1px solid #3580C4 !important; background:#fff !important; color:#3580C4 !important;}
    .next-bt a                      {background:#3580C4!important;border:1px solid #3580C4; border-radius: 4px;
    color:#fff!important; font-size:14px; padding: 5px 10px; text-align: center; transition: all 0.4s ease 0s;}
	.commargin_top 					{margin-top: 30px;}

    /* Excel Floating Icon end*/
</style>
    <script type="text/javascript" src="<?php echo $this->basePath(); ?>/library/jqwidgets/jqxgrid.grouping.js"></script>
    <script type="text/javascript" src="<?php echo $this->basePath(); ?>/library/jqwidgets/jqxgrid.aggregates.js"></script>
    <script type="text/javascript" src="<?php echo $this->basePath(); ?>/library/jqwidgets/jqx-all.js"></script>
<div class="content_wrapper padlr0">
			<div class="container-fluid">
      			<div class="row">
					<div class="col-lg-9 col-md-6 col-sm-6">
						<h1>Request Register
							<div class="stgedit_btn req_addbtn brad_50">
								<a href="<?php echo $this->basePath();?>/ats/index/sample" class="ripple" data-toggle="tooltip" data-placement="right" title="AddNew Request"><i class="fa fa-plus"></i></a>
							</div>
						</h1>
						<div class="col-lg-6">
							<div class="fixed-action-btn active">
								<a class="btn-floating btn-large">
									<i class="fa fa-print"></i>
								</a>
								<ul>
									<li>
										<a class="btn-floating hide-input-file" id="print" href="javascript:void(0);" data-toggle="tooltip" data-placement="top" data-original-title="Print Report">
											<i class="fa fa-print"></i>

										</a>
									</li>
									<li>
										<a class="btn-floating" id="excelExport" href="javascript:void(0);" data-toggle="tooltip" data-placement="top" data-original-title="Download Excel">
											<i class="fa fa-download"></i>
										</a>
									</li>
									<li>
										<a class="btn-floating" id="csvExport" href="javascript:void(0);" data-toggle="tooltip" data-placement="top" data-original-title="Export CSV">
											<i class="fa fa-file-archive-o"></i>
										</a>
									</li>
								</ul>
							</div>
						</div>
						<div class="col-lg-12">
							<div class="col-lg-6 col-lg-offset-3 col-md-8 col-md-offset-2 col-sm-8 col-sm-offset-2">
								<label for="multiColumn" class="col-lg-6 col-md-6 col-sm-6 control-label txt_right">Column Chooser</label>
								<div class="col-lg-6 col-md-6 col-sm-6">
									<?php
									$arrGridColumn = array();
									if(isset($GridColumn)) {
										$arrGridColumn = explode(",", $GridColumn['ColumnName']);
									} ?>
									<select name="multiColumn[]" id="multiColumn" class="form-control selectpicker" data-size="5" multiple title="Choose Multiple Status">
										<option value="RequestNo" <?php echo (in_array('RequestNo',$arrGridColumn)) ? '' :'selected'?>>Request No</option>
										<option value="RequestDate"<?php echo (in_array('RequestDate',$arrGridColumn)) ? '' :'selected'?>>Request Date</option>
										<option value="CostCentreName" <?php echo (in_array('CostCentreName',$arrGridColumn)) ? '' :'selected'?>>Project Name</option>
										<option value="TypeName" <?php echo (in_array('TypeName',$arrGridColumn)) ? '' :'selected'?>>Request Type</option>
										<option value="priorityVal" <?php echo (in_array('priorityVal',$arrGridColumn)) ? '' :'selected'?>>Priority</option>
										<option value="ApproveReg" <?php echo (in_array('ApproveReg',$arrGridColumn)) ? '' :'selected'?>>Approve</option>
									</select>
								</div>
							</div>
						</div>
					</div>
                  <!-- <div class="col-lg-3 col-md-6 col-sm-6">
                      <span class="float_r"><label class="ripple"><input class="ios_checkbox" id="activity" checked type="checkbox"/><div class="ios_switch"><span></span></div></label></span>
                      <h4 class="heading_h4 float_r txt_right">Activity Center</h4>
                   </div>
                    <div class="col-lg-12 clear" id="activityCenter">
                        <div class="col-lg-5 col-md-5">
                            <h4 class="heading_h4">Recent Activity...</h4>
                           <div class="row">
                            <div class=" col-lg-5 col-md-5 col-sm-5 col-xs-5"><p class="space_p">Request No<span class="colon_r">:</span></p></div>
                            <div class="col-lg-7 col-md-7 col-sm-7 col-xs-7"><p class="space_p"><?php echo $RequestNo; ?>&nbsp;&nbsp;<a href="<?php echo $this->basePath();?>/ats/index/request-detailed/<?php echo $RequestId; ?>"><span class="edit_symbols"><i class="fa fa-eye"></i></span></a></p></div>
                           </div>
                           <div class="row">
                            <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5"><p class="space_p">Request Date<span class="colon_r">:</span></p></div>
                            <div class="col-lg-7 col-md-7 col-sm-7 col-xs-7"><p class="space_p"><?php echo $RequestDate; ?></p></div>
                           </div>
                            <div class="row">
                            <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5"><p class="space_p">RequestType<span class="colon_r">:</span></p></div>
                            <div class="col-lg-7 col-md-7 col-sm-7 col-xs-7"><p class="space_p"><?php echo $TypeName; ?></p></div>
                           </div>
                            <div class="row">
                            <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5"><p class="space_p">Status<span class="colon_r">:</span></p></div>
                            <div class="col-lg-7 col-md-7 col-sm-7 col-xs-7"><p class="space_p"><?php echo $Approve; ?></p></div>
                           </div>
                        </div>
                    <div class="col-lg-7 col-md-7">
                        <h4 class="heading_h4">Requests By Month</h4>
                       <div class="row">
                            <div class="col-lg-12">
                                 <ul class="pieinln">
                                   <li class="col-sm-2">
                                        <div class="pie_loader piebg1">
                                            <div class="pieload_cnt" id="note_0" data-note="<?php echo $ActivityPer; ?>"></div>
                                        </div>
                                       <p class="space_b">Activity</p>
                                    </li>
                                    <li class="col-sm-2">
                                        <div class="pie_loader piebg2">
                                            <div class="pieload_cnt" id="note_1" data-note="<?php echo $AssetPer; ?>"></div>
                                        </div>
                                        <p class="space_b">Asset</p>
                                    </li>
                                    <li class="col-sm-2">
                                        <div class="pie_loader piebg3">
                                            <div class="pieload_cnt" id="note_2" data-note="<?php echo $LabourPer; ?>"></div>
                                        </div>
                                        <p class="space_b">Labour</p>
                                    </li>
                                    <li class="col-sm-2">
                                        <div class="pie_loader piebg4">
                                            <div class="pieload_cnt" id="note_3" data-note="<?php echo $MaterialPer; ?>"></div>
                                        </div>
                                        <p class="space_b">Material</p>
                                    </li>
                                    <li class="col-sm-2">
                                        <div class="pie_loader piebg5">
                                            <div class="pieload_cnt" id="note_4" data-note="100"></div>
                                        </div>
                                        <p class="space_b">Service</p>
                                    </li>
                                  </ul>
                           </div>
                         </div>
                       </div>
                  </div>-->
          			<div class="col-lg-12 clear">
              			<div class="table-responsive clear mar_20">
                             <div id="dataTable"></div>
              			</div>
          			</div>
                </div>
            </div>
        </div>
<!--button--->
	
<script>
$(document).ready(function () {
	var $treeGrid = $("#dataTable");
	var source =
	{	
		localdata:<?php echo json_encode($gridResult); ?>,
		dataType: "json",
		dataFields: [

			{ name: 'RequestId', type: 'string' },
			{ name: 'CostCentreId', type: 'string' },
			{ name: 'RequestNo', type: 'string' },
			{ name: 'RequestDate', type: "date", format: 'DD-MM-yyyy'  },
			{ name: 'CostCentreName', type: 'string' },
			{ name: 'TypeName', type: 'string' },
			{ name: 'priorityVal', type: 'string' },
			{ name: 'ApproveReg', type: 'string' }
		],
		id: 'RequestId'
	};
	var dataAdapter = new $.jqx.dataAdapter(source);

    var initrowdetails = function (index, parentElement, gridElement, datarecord) {
        var $tabsdiv = $($(parentElement).children()[0]);
        $tabsdiv.append(renderRowDetail(datarecord.RequestId,datarecord.CostCentreId));
    };
	
	var showhideColumns = function () {
		$("#dataTable").jqxGrid('beginupdate');
		$.each($('#multiColumn option'), function (i,o) {
			if($(this).is(':selected')) {
				$("#dataTable").jqxGrid('showcolumn', $(this).val());
			} else {
				$("#dataTable").jqxGrid('hidecolumn', $(this).val());
			}
		});
		$("#dataTable").jqxGrid('endupdate');
	};
	
    $treeGrid.jqxGrid(
	{
		width: '100%',
		pageable: true,
		selectionMode: 'singleRow',
		pagerButtonsCount: 6,
		autoheight:true,
		autorowheight: true,
		filterable: true,
		sortable: true,
		pagermode: 'advanced',				
		columnsResize: true,
		showfilterrow: true,
        pagerMode: 'advanced',
        pagerHeight: 40,
        rowsheight:40,
        columnsresize: true,
        altrows: true,
        enabletooltips: true,
        groupable: true,
        showstatusbar: true,
        statusbarheight: 35,
        showaggregates: true,
        groupsexpandedbydefault: true,
        rowdetails:true,
        initrowdetails: initrowdetails,

        rowdetailstemplate: {
            rowdetails: "<div style='height:auto;overflow:visible; border:2px solid #5bc0de;'></div>",
            rowdetailsheight:400
        },
		ready:function(){
			var localizationobj = {};
			localizationobj.emptydatastring = "No request to display";
            $treeGrid.jqxGrid('localizestrings', localizationobj);
			showhideColumns();
		},
		source:dataAdapter,
		columns: [
		{ text: 'RequestId', datafield: 'RequestId',  hidden: true, filterable: false},
		{ text: 'CostCentreId', datafield: 'CostCentreId',  hidden: true, filterable: false},
		{ text: 'Request No', dataField: 'RequestNo', width:'10%' },
		{ text: 'Request Date', filtertype: 'date', cellsformat: 'dd-MM-yyyy', dataField: 'RequestDate', width:'10%', cellsalign: 'center', align: 'center' },
		{ text: 'ProjectName', dataField: 'CostCentreName', width: '30%', cellsalign: 'center', align: 'center' },
		{ text: 'Request Type', dataField: 'TypeName', width: '15%' },
		{ text: 'Priority', dataField: 'priorityVal', width:'15%'},
		{ text: 'Approve', dataField: 'ApproveReg', width:'10%', cellsalign: 'center', align: 'center' },
        { text: 'Action', sortable: false, filterable: false, cellsalign: 'center',width:'10%',
            cellsrenderer: function (row) {
                //var rowData = $("#subGrid").jqxGrid('getrowdata', row);
                var RequestId = $treeGrid.jqxGrid('getCellValue', row, 'RequestId');
                var Approve = $treeGrid.jqxGrid('getCellValue', row, 'ApproveReg');
                if(Approve == "Yes" || Approve == "Partial")
                {
                    var editLink = '<a title="Detailed" href="' + getBaseURL() + 'ats/index/request-detailed/' + RequestId + '" style="margin-left: 12px; margin-top:8px;"><i class="fa fa-paper-plane reg-icon"></i></a>';
                    return editLink + "&nbsp;&nbsp;" + '<a title="Report" href="' + getBaseURL() + 'ats/index/request/' + RequestId + '" style="margin-left: 8px;"><i class="fa fa-file-text-o reg-icon-file"></i></a>';
                }
                else {
                    var editLink = '<a title="Edit" href="' + getBaseURL() + 'ats/index/entry-sample/' + RequestId + '" title="Edit" onclick="reqedit(' + RequestId + ');return false;" style="padding-left: 15px; margin-top:8px;"><i class="fa fa-pencil-square-o reg-icon"></i></a>' +
                        "&nbsp;&nbsp;" + '<a href="' + getBaseURL() + 'ats/index/request-delete/' + RequestId + '"  title="Delete" onclick="reqdelete(' + RequestId + ');return false;""><i class="fa fa-trash-o reg-icon"></i></a>' +
                        '<a title="Detailed" href="' + getBaseURL() + 'ats/index/request-detailed/' + RequestId + '" style="margin-left: 12px; margin-top:8px;"><i class="fa fa-paper-plane reg-icon"></i></a>';
                    return editLink + "&nbsp;&nbsp;" + '<a title="Report" href="' + getBaseURL() + 'ats/index/request/' + RequestId + '" style="margin-left: 8px;"><i class="fa fa-file-text-o reg-icon-file"></i></a>';
                }
            }
        }
	  ]
	});
    $treeGrid.jqxGrid('showgroupsheader', false);
	
	
	//Print option
	$("#excelExport").click(function () {
		$("#dataTable").jqxGrid('exportdata', 'xls', 'jqxGrid');
	});
	$("#csvExport").click(function () {
		$("#dataTable").jqxGrid('exportdata', 'csv', 'jqxGrid');
	});
	$("#htmlExport").click(function () {
		$("#dataTable").jqxGrid('exportdata', 'html', 'jqxGrid');
	});

	$("#print").click(function () {
		var gridContent = $("#dataTable").jqxGrid('exportdata', 'html');
		var newWindow = window.open('', '', 'width=800, height=500'),
			document = newWindow.document.open(),
			pageContent =
				'<!DOCTYPE html>\n' +
				'<html>\n' +
				'<head>\n' +
				'<meta charset="utf-8" />\n' +
				'<title>Request Register</title>\n' +
				'<h1>Request Register</h1>\n' +
				'</head>\n' +
				'<body>\n' + gridContent + '\n</body>\n</html>';
		document.write(pageContent);
		document.close();
		newWindow.print();
	});
	
	
    $treeGrid.bind('rowselect', function (event) {
        var row = event.args.rowindex;
        var datarow = $treeGrid.jqxGrid('getrowdata', row);
    });
});

$('#multiColumn').on('change', function () {
	var unSelected = [];
	var Selected = [];
	$("#dataTable").jqxGrid('beginupdate');
	$.each($('#multiColumn option'), function (i,o) {
		if($(this).is(':selected')) {
			Selected.push($(this).val());
			$("#dataTable").jqxGrid('showcolumn', $(this).val());
		} else {
			unSelected.push($(this).val());
			$("#dataTable").jqxGrid('hidecolumn', $(this).val());
		}
	});
	$("#dataTable").jqxGrid('endupdate');

	$.ajax({
		url:"<?php echo $this->basePath(); ?>/ats/index/display-register",
		type:"post",
		data:{'unCheckedColumnNames':unSelected.toString(),'type':'updateColumn'},
		success:function(data, textStatus, jqXHR){
		},
		error:function(jqXHR, textStatus, errorThrown){
		}
	});
});
$('#activity').change(function(){
		if(!$(this).is(':checked'))
			$('#activityCenter').hide();
		else
			$('#activityCenter').show();
	});

function reqdelete(reqId) {
    var dCheck = '<?php echo (isset($dAns)) ? $dAns : 0;?>';
    if(dCheck == ''){
        alert("No Rights to Delete");
        return false;
    } else {
        var val = confirm("Do you want to delete this request?");
        if(val==true) {
            location.replace('request-delete/'+reqId);
        }
    }
}
function reqedit(reqId) {
    var rCheck = '<?php echo (isset($rAns)) ? $rAns : 0;?>';

    if(rCheck == ''){
        alert("No Rights to Modify");
        return false;
    } else {
         location.replace('entry-sample/'+reqId);
    }
}
function renderRowDetail(id,ccid){
    $.ajax({
        url: getBaseURL() + 'ats/index/request-register-detail',
        type: 'POST',
        data: "reqId="+id+"&costcentreid="+ccid,
        async: false,
        virtualmode: true,

        success: function(data,status, xhr) {
            if(xhr.status == 200)
                dataValue = data;
        }, error: function(xhr, status, errorThrown) {
        }
    });
    return dataValue;
}
</script>