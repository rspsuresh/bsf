<style type="text/css">
    .plan {
        display: none;
    }
</style>
<div class="signup_wrapper">
	<div class="signup_header">
		<img src="<?php echo $this->basePath(); ?>/images/rabills_logo.png" class="login_logo" alt="" title="Ra-Bills" />
	</div>
	<div class="signup_content">
		<?php if($success==0) { ?>
        <form id="signupForm" method="post" autocomplete="off">
            <div class="signupcnt">
            <div class="signupcnt_left float_l">
                <h1>Sign Up</h1>
                <p>Welcome to RA-Bills, your comprehensive billing solution.</p>
                <?php if(isset($messages)) {
                    foreach($messages as $message) {
                        foreach($message as $key=>$flash) { ?>
                            <p class="txt_center <?php echo $key; ?>"><?php echo $flash; ?></p>
                        <?php 	}
                    }
                }?>
                <ul class="login_form cb_login_form">
                    <li class="login_input">
                        <p class="label_p"><label for="firstName">First Name</label></p>
                        <input type="text" id="firstName" name="firstName" autocomplete="off"/>
                        <div class="error_message"><p>Required</p></div>
                    </li>
                    <li class="login_input">
                        <p class="label_p"><label for="lastName">Last Name</label></p>
                        <input type="text" id="lastName" name="lastName" autocomplete="off"/>
                        <div class="error_message"><p>Required</p></div>
                    </li>
                    <li class="login_input">
                        <p class="label_p"><label for="email">Email</label></p>
                        <input type="text" id="email" name="email" value=""  autocomplete="off"/>
                        <div class="error_message"></div>
                    </li>
                    <li class="login_input">
                        <p class="label_p"><label for="username">Username</label></p>
                        <input type="text" id="username" name="username" value="" autocomplete="off" />
                        <div class="error_message"></div>
                    </li>
                    <li class="login_input">
                        <p class="label_p"><label for="password">Password</label></p>
                        <input type="password" id="password" name="password" value=""autocomplete="off" />
                        <div class="error_message"><p>Required</p></div>
                    </li>
                    <li class="login_input animated fadeInUp">
                        <p class="label_p"><label for="confirmPassword">Confirm Password</label></p>
                        <input type="password" id="confirmPassword" name="confirmPassword" value="" autocomplete="off" />
                        <div class="error_message"></div>
                    </li>
                    <li class="login_input">
                        <p class="label_p"><label for="businessName">Company Name</label></p>
                        <input type="text" id="businessName" name="businessName" autocomplete="off" />
                        <div class="error_message"><p>Required</p></div>
                    </li>
                    <li class="login_input">
                        <p class="label_p"><label for="businessType">Company Type</label></p>
                        <select name="businessType" id="businessType" class="form-control selectpicker show-tick" data-size="5" title="Select Company Type">
                            <option value="0">Select Company Type</option>
                            <?php foreach($businessType as $key => $value) { ?>
                                <option value="<?php echo $key; ?>"><?php echo $value; ?></option>
                            <?php } ?>
                        </select>
                        <div class="error_message"><p>Please select company type</p></div>
                    </li>
                    <li class="login_input">
                        <p class="label_p"><label for="cityId">City</label></p>
                        <select name="cityId" id="cityId" class="form-control selectpicker show-tick" data-size="5" title="Select a City">
                            <option value="0">Select a City</option>
                            <?php foreach($cityMaster as $city) { ?>
                                <option value="<?php echo $city['CityId']; ?>"><?php echo $city['CityName']; ?></option>
                            <?php } ?>
                        </select>
                        <div class="error_message"><p>Required</p></div>
                    </li>
                    <li class="login_input">
                        <p class="label_p"><label for="mobile">Mobile Number (10 digits)</label></p>
                        <input type="text" id="mobile" name="mobile" value="" maxlength="10" autocomplete="off" onKeyPress="return isNumberKey(event);" />
                        <div class="error_message"><p>Required</p></div>
                    </li>
                    <li>
                        <div class="radio_check">
                            <p>
                                <input type="checkbox" id="i_accept" name="accept" value="1" />
                                <label for="i_accept">Yes, I have read and I accept the <span class="span_bsf_hl">RA-Bills</span> Terms of Service and the <span class="span_bsf_hl">RA-Bills</span> Privacy Policy.</label>
                            </p>
                        </div>
                        <div class="error_message plsagree_err"><p>Please accept terms and policy</p></div>
                    </li>
                    <li style="min-height: auto;">
                        <a href="<?php echo $this->basePath(); ?>/cb/index/login">Already have an account? Sign in</a>
                    </li>
                    <li>
                        <div class="login_load brad_2"><p><img src="<?php echo $this->basePath(); ?>/images/loading.gif" alt="" />Loading &nbsp;&nbsp;&nbsp;Please Wait!</p></div>
                        <button type="button" name="signup" class="signup_btn brad_2 ripple" onclick="return signupValidate();">Get Started</button>
                    </li>
                </ul>
            </div>
            <div class="signupcnt_right float_l">
                <img class="animated fadeInUp" src="<?php echo $this->basePath(); ?>/images/signup_rightAdd.jpg" alt="" title="" />
                <h1 class="txt_center animated fadeInDown">Free <span>15</span> days trial</h1>
                <h1 class="txt_center animated fadeInDown">Or</h1>
                <h1 class="txt_center animated fadeInDown">First bill of trial</h1>
            </div>
            </div>
            <div class="plan">
                <div class="pricing_table m_top20 m_btm20">
                    <div class="pricing_table_inner">
                        <ul class="pricetbl_column basic">
                            <li class="pad_t0">
                                <h2>Basic</h2>
                                <p>Best For Small Business</p>
                            </li>
                            <li class="price"><p>
                                <sup>&#8377;</sup>
                                <span>2500</span>
                                <sub>/mo.</sub>
                            </p>
                            </li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-user"></i></span>1 User</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-user-secret"></i></span>1 Clients</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-file-text-o"></i></span>2 Bills</li>
                            <!--<li><p>Features</p></li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-phone"></i></span>Support</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-newspaper-o"></i></span>Presentations</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-cubes"></i></span>Channels</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-tachometer"></i></span>Bonus Chart Side-Pack</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-phone"></i></span>Support</li>-->
                            <li class="selectplan_btn"><a href="javascript:void(0);" class="ripple" data-plan="a">Choose Plan</a></li>
                        </ul>
                        <ul class="pricetbl_column">
                            <li class="pad_t0">
                                <h2>Plus</h2>
                                <p>Best For Medium Business</p>
                            </li>
                            <li class="price"><p>
                                <sup>&#8377;</sup>
                                <span>5000</span>
                                <sub>/mo.</sub>
                            </p>
                            </li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-user"></i></span>1 User</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-user-secret"></i></span>3 Clients</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-file-text-o"></i></span>5 Bills</li>
                            <!--<li><p>Features</p></li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-phone"></i></span>Support</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-newspaper-o"></i></span>Presentations</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-cubes"></i></span>Channels</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-tachometer"></i></span>Bonus Chart Side-Pack</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-phone"></i></span>Support</li>-->
                            <li class="selectplan_btn"><a href="javascript:void(0);" class="ripple" data-plan="b">Choose Plan</a></li>
                        </ul>
                        <ul class="pricetbl_column premium">
                            <li class="pad_t0">
                                <h2>Premium</h2>
                                <p>Best For Large Business</p>
                            </li>
                            <li class="price"><p>
                                <sup>&#8377;</sup>
                                <span>10000</span>
                                <sub>/mo.</sub>
                            </p>
                            </li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-user"></i></span>1 User</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-user-secret"></i></span>5 Clients</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-file-text-o"></i></span>10 Bills</li>
                            <!--<li><p>Features</p></li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-phone"></i></span>Support</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-newspaper-o"></i></span>Presentations</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-cubes"></i></span>Channels</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-tachometer"></i></span>Bonus Chart Side-Pack</li>
                            <li class="txt_left"><span class="pt_spanicon"><i class="fa fa-phone"></i></span>Support</li>-->
                            <li class="selectplan_btn"><a href="javascript:void(0);" class="ripple" data-plan="c">Choose Plan</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1 col-sm-12 padlr0 col-sm-offset-0 m_top10 m_btm20 clear">
                    <div class="col-lg-3 col-md-3 col-sm-3 padlr0">
                        <label for="subcDuration_6m" class="col-lg-12 subcDuration_label">Subscription Duration</label>
                    </div>
                    <div class="col-lg-9 col-md-9 col-sm-9">
                        <div class="radio_check">
                            <p>
                                <input type="radio" value="1" name="subcriptionDuration" id="subcDuration_1m"/>
                                <label for="subcDuration_1m" class="ripple">1 Month</label>
                            </p>
                            <p>
                               <input type="radio" value="6" name="subcriptionDuration" id="subcDuration_6m"/>
                               <label for="subcDuration_6m" class="ripple">6 Months (5% Off)</label>
                           </p>
                           <p>
                               <input type="radio" value="12" name="subcriptionDuration" id="subcDuration_12m"/>
                               <label for="subcDuration_12m" class="ripple">12 Months (10% Off)</label>
                           </p>
                        </div>
                        <input type="hidden" name="plan" id="input-plan" value=""/>
                    </div>
                </div>
                <div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1 col-sm-10 col-sm-offset-1 m_top10 m_btm20 clear">
                    <h1 class="text-center" id="discount_amount" style="display: none;"></h1>
                </div>
                <div class="col-lg-12 m_top10 m_btm20 clear">
                    <button type="button" id="btn-pay" name="pay" class="signup_btn brad_2 ripple">Pay</button>
                </div>
            </div>
        </form>
		<div class="signup_footer clear">
			<p class="txt_center">Copyright © <?php echo date('Y'); ?> RA-Bills.com. All Rights Reserved <img class="float_r" src="<?php echo $this->basePath(); ?>/images/bsf_flogo.jpg" alt="" /></p>
		</div>
		<?php } else if($success==1) { ?>
		<div class="success_box animated fadeIn">
        	<div class="icon icon-success svg">
              <svg xmlns="http://www.w3.org/2000/svg" width="72px" height="72px">
                <g fill="none" stroke="#8EC343" stroke-width="2">
                  <circle cx="36" cy="36" r="35" style="stroke-dasharray:240px, 240px; stroke-dashoffset: 480px;"></circle>
                  <path d="M17.417,37.778l9.93,9.909l25.444-25.393" style="stroke-dasharray:50px, 50px; stroke-dashoffset: 0px;"></path>
                </g>
              </svg>
            </div>
            <h1 class="txt_center animated fadeInDown clear">
                Your profile is been created & Activation Code is sent to your E-mail & Mobile number provided!<br /><br />
				Sign in & activate your account
            </h1>
            <a class="gosignin_btn brad_2 ripple" href="login">Go Sign In</a>
        </div>
		<?php } ?>
	</div>
</div>
<script>
    var plan = '<?php echo (isset($plan)) ? strtolower($plan) : '';?>';

    $(document).ready(function() {
        var sysHeight = $(window).height();
        $('.success_box').css('min-height',sysHeight - 170);

        $('.selectplan_btn').on('click', 'a', function () {
            $(this).closest('ul').addClass('plus_column').siblings('ul').removeClass('plus_column');
            $('#input-plan').val($(this).attr('data-plan'));
            calcDiscount();
        });

        $('input[type=radio][name=subcriptionDuration]').on('click', function () {
            calcDiscount();
        });

        $('#btn-pay').on('click', function () {
            var plan = $('#input-plan').val();
            if(plan.length == 0 || plan == "") {
                alert('Please select a plan!');
                return false;
            }

            var duration = $('input[type=radio][name=subcriptionDuration]');
            if(!duration.is(':checked')) {
                alert('Please select a duration!');
                return false;
            }

            $("#signupForm").submit();
        });

        if(plan.length != 0 && plan != '') {
            $('.selectplan_btn a[data-plan='+plan+']').closest('ul').addClass('plus_column').siblings('ul').removeClass('plus_column');
            $('#input-plan').val(plan);
        }
    });

    function calcDiscount() {
        var plan = $('#input-plan').val();
        var $duration = $('input[type=radio][name=subcriptionDuration]');

        if(plan.length == 0 || plan == "" || !$duration.is(':checked')) {
            $('#discount_amount').html('').hide();
            return;
        }

        var subcriptionDuration = parseFloatVal($('input[type=radio][name=subcriptionDuration]:checked').val()),
            discount = 0;

        if(subcriptionDuration == 6)
            discount = 5;
        else if(subcriptionDuration == 12)
            discount = 10;

        var plan_amount = 0;
        if (plan == 'a')
            plan_amount = ((2500) * subcriptionDuration) - (((2500) * subcriptionDuration) * (discount / 100));
        else if (plan == 'b')
            plan_amount = ((5000) * subcriptionDuration) - (((5000) * subcriptionDuration) * (discount / 100));
        else if (plan == 'c')
            plan_amount = ((10000) * subcriptionDuration) - (((10000) * subcriptionDuration) * (discount / 100));

        $('#discount_amount').html('&#8377; ' + plan_amount).show();

    }

    function signupValidate() {
        $('.error_message').hide();
        var sFlag = 0;
        if($.trim($('#firstName').val()) == '') {
            $('#firstName').closest('.login_input').find(".error_message").show();
            $('#firstName').focus();
            sFlag = 1;
            return false;
        }
        if($.trim($('#lastName').val()) == '') {
            $('#lastName').closest('.login_input').find(".error_message").show();
            $('#lastName').focus();
            sFlag = 1;
            return false;
        }
        if($.trim($('#email').val()) == '') {
            $('#email').closest('.login_input').find(".error_message").show();
            $('#email').closest('.login_input').find(".error_message").html('<p>Required</p>');
            $('#email').focus();
            sFlag = 1;
            return false;
        } else if($.trim($('#email').val()) != '' && validateEmail($('#email').val())==false) {
            $('#email').closest('.login_input').find(".error_message").show();
            $('#email').closest('.login_input').find(".error_message").html('<p>Please enter a valid email!</p>');
            $('#email').focus();
            sFlag = 1;
            return false;
        }
        if($.trim($('#username').val()) == '') {
            $('#username').closest('.login_input').find(".error_message").show();
            $('#username').closest('.login_input').find(".error_message").html('<p>Required</p>');
            $('#username').focus();
            sFlag = 1;
            return false;
        }
        if( !(/^[a-zA-Z0-9]{6,16}$/.test($('#username').val())) ) {
            $('#username').closest('.login_input').find(".error_message").show();
            $('#username').closest('.login_input').find(".error_message").html('<p>Username should contain atleast six characters</p>');
            $('#username').focus();
            sFlag = 1;
            return false;
        }
        if($('#password').val() == '') {
            $('#password').closest('.login_input').find(".error_message").html('<p>Required</p>').show();
            $('#password').focus();
            sFlag = 1;
            return false;
        }
        if( !(/^(?=.*?[A-Z])(?=(.*[a-z]){1,})(?=(.*[\d]){1,})(?=(.*[\W]){1,})(?!.*\s).{6,16}$/.test($('#password').val())) ) {
            $('#password').closest('.login_input').find(".error_message").html('<p>Password should contain atleast one uppercase, lowercase, number, specialcharacter</p>').show();
            $('#password').focus();
            sFlag = 1;
            return false;
        }
        if($('#confirmPassword').val() == '') {
            $('#confirmPassword').closest('.login_input').find(".error_message").show();
            $('#confirmPassword').closest('.login_input').find(".error_message").html('<p>Required</p>');
            $('#confirmPassword').focus();
            sFlag = 1;
            return false;
        } else if($('#password').val() != $('#confirmPassword').val()) {
            $('#confirmPassword').closest('.login_input').find(".error_message").show();
            $('#confirmPassword').closest('.login_input').find(".error_message").html('<p>Password Mismatch!</p>');
            $('#confirmPassword').focus();
            sFlag = 1;
            return false;
        }
        if($.trim($('#businessName').val()) == '') {
            $('#businessName').closest('.login_input').find(".error_message").show();
            $('#businessName').focus();
            sFlag = 1;
            return false;
        }
        if($('#businessType').val() == '0') {
            $('#businessType').closest('.login_input').find(".error_message").show();
            $('#businessType').focus();
            sFlag = 1;
            return false;
        }
        if($('#cityId').val() == '0') {
            $('#cityId').closest('.login_input').find(".error_message").show();
            $('#cityId').focus();
            sFlag = 1;
            return false;
        }
        var mobileNo = $.trim($('#mobile').val());
        if(mobileNo == '') {
            $('#mobile').closest('.login_input').find(".error_message").html('<p>Required</p>').show();
            $('#mobile').focus();
            sFlag = 1;
            return false;
        }
        if(!/^\+?[0-9\-]{10,20}$/.test(mobileNo)) {
            $('#mobile').closest('.login_input').find(".error_message").html('<p>Please enter a valid mobile number!</p>').show();
            $('#mobile').focus();
            sFlag = 1;
            return false;
        }

        if($('#i_accept').is(":checked")==false) {
            $('.plsagree_err').show();
            sFlag = 1;
            return false;
        }

        if(sFlag == 0) {
            $.post(getBaseURL()+'cb/index/check-username-email', { userName: $('#username').val(), eMail: $('#email').val() },
            function(data) {
                var chkusr = JSON.parse(data);

                if(chkusr.uCount != 0) {
                    $('#username').closest('.login_input').find(".error_message").show();
                    $('#username').closest('.login_input').find(".error_message").html('<p>Username already exists!</p>');
                    $('#username').focus();
                } else if(chkusr.eCount != 0) {
                    $('#email').closest('.login_input').find(".error_message").show();
                    $('#email').closest('.login_input').find(".error_message").html('<p>Email already exists!</p>');
                    $('#email').focus();
                } else if(plan.length != 0){
                    $('.signupcnt').hide();
                    $('.plan').fadeIn();
                } else {
                    $("#signupForm").submit();
                }
            });
        }
        return false;
    }
</script>