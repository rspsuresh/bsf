<?php
		$url = $this->serverUrl(true);
		$url = array_pop(explode("/", $url));
		$url1 = array_pop(explode("/", $url));
?>
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/js/select2.full.min.js"></script>
<link type="text/css" rel="stylesheet" href="<?php echo $this->basePath(); ?>/css/select2.min.css" />
    
<style>
.main {
  width: 250px;
  height: 250px;
  transform: rotate(43deg) scale(0.8);
  margin-bottom: 20px;
  border-radius: 50% 50% 0 50%;
  background: #faf9f1;
  background: linear-gradient(270deg, #f6f4eb, #dcd6d2);
  border: 1px solid rgba(0, 0, 0, 0.1);
  position: relative;
  padding: 5px;
  transition: all 0.5s ease-out;
  box-shadow: 0 0 5px rgba(150, 100, 100, 0.3), 3px 3px 8px rgba(150, 100, 100, 0.3);
}

.inner {
  width: 100%;
  height: 100%;
  background: #faf9f1;
  background: linear-gradient(270deg, #fafaf2, #ece7e1);
  border-radius: inherit;
}

.inner:after {
  content: "";
  position: absolute;
  width: 170px;
  height: 170px;
  left: 30px;
  top: 30px;
  border-radius: 50%;
  box-shadow: inset -20px -20px 50px rgba(150, 100, 100, 0.075), 10px 10px 10px 5px rgba(150, 100, 100, 0.075);
  background:url(<?php echo $this->basePath(); ?>/images/Icon_5.png);
}

.inner:before {
  content: "";
  position: absolute;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  right: 20px;
  bottom: 20px;
  background:#e75252;
  box-shadow: inset 5px 5px 15px rgba(150, 100, 100, 0.075), -1px -1px 3px rgba(150, 100, 100, 0.075);
}
.main.checked-yes {
  transform: rotate(68deg) scale(0.8);
}
.main.checked-no {
  transform: rotate(25deg) scale(0.8);
}
.main.checked-yes .inner:after{background:url(<?php echo $this->basePath(); ?>/images/Icon_5.png);}
.main.checked-yes .inner:before{background:#7fb74c;}

</style>
<form class="form-horizontal" action="" method="post"   enctype="multipart/form-data">
<div class="content_wrapper padlr0">
    <div class="container-fluid padlr0">
        <div class="col-lg-12">
		
		 <h1 class="float_l" data-bsfhead="Broker Entry" >Broker Entry</h1>
		  <a class="clshvr float_r" href="<?php echo $this->basePath(); ?>/crm/broker/register"><span class="select2-selection__clear">Ã—</span> <span class="clscrm"> Close</span></a>
        </div> 
        <div class="col-lg-12 clear">
            <div class="row">
                
                <div class="col-lg-4 col-lg-offset-4 col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2">
                
			
				<div id="brokerentry" class="showDiv">
				 
                <div class="row"> 
				<div class="row form-group">  				
				<div class="col-lg-12">
						<span class="date_icon"><i class="fa fa-calendar"></i></span>
						<input type="text" name="brokerDate" id="brokerDate" class="form-control lbl_move date_picker" readonly="readonly" value="<?php echo isset($broker['BrokerDate'])?  $broker['BrokerDate'] :  date('d-m-Y');?>" data-bsfshare="BrokerDate" label="Date"/>
					<div class="error_message"><p>Choose BrokerDate...</p></div>
                     </div>
                  </div>
                <div class="row form-group">  				
				<div class="col-lg-12">
                      <input name="brokername" type="text" id="brokername" class="form-control lbl_move" value="<?php if(isset($broker)){ echo $broker['BrokerName']; } ?>" data-bsfshare="BrokerName" label="BrokerName" />
                       <div class="error_message"><p>please enter broker name</p></div>
                    </div>
                </div> 
                <div class="row form-group">
                   <div class="col-lg-12">
                        <select name="projectsId[]" id="projectsId " class="form-control multiple_dropdown lbl_move"  multiple="multiple" data-bsfshare="ProjectName" label="Projects" style="width:100%;">
                               <?php
									foreach($resultsLeadProjects as $type){ ?>
										<option <?php if(in_array($type['ProjectId'], $leadProjects)) {echo 'Selected';} ?> value='<?php echo $type['ProjectId']; ?>' ><?php echo $type['ProjectName']; ?></option>
									<?php }
								?>
                        </select>
                        <div class="error_message"><p>please select projects...</p></div>
                    </div>
                </div>				
				 <div class="row form-group">  
                     	<div class="col-lg-12">
                        	<input name="mobile" type="text" id="mobile" maxlength="10"  onKeyPress="return isNumberKey(event)" value="<?php echo $broker['Mobile'];?>" class="form-control lbl_move mobval" value="" data-bsfshare="mobileNo"  label="Mobile" />
                       <div class="error_message"><p>please enter mobile...</p></div>
					   </div>
					</div>
					
				<div class="row form-group">  
                     	<div class="col-lg-12">
                        	<input name="email" type="text" id="email" value="<?php echo $broker['EmailId'];?>" class="form-control lbl_move email" data-bsfshare="Email" label="Email" />
                       <div class="error_message"><p>please enter emailId...</p></div>
					   </div>
					</div>
				<div class="row form-group" id="geo">  
                     	<div class="col-lg-12">
                        	<input name="address" type="text" id="geocomplete"  class="form-control lbl_move" value="<?php echo $broker['Address'];?>" data-bsfshare="TypeAddress" label="Type Address" />
                       <div class="error_message"><p>please enter address...</p></div>
					   </div>
					</div>
						
					
					
                    </div>
         </div>
        </div>
        </div>
        </div>
        </div>
        </div>
   
<div class="col-lg-12 savebtn_area">
    <ul>
      
        <li class="save_btn float_r">
            <a href="javascript:void(0);" class="ripple continue">Save</a>
        </li>
      </ul>
</div>
 </form>


<script>

$("input:text").blur(function(){
	if($(this).val().trim().length != 0){
		$(this).next("span").text("");
	}
	else{
		$(this).next("span").text($(this).attr("error"));
	}
});
   
 $(document).ready(function() {
        $(".single_dropdown2").select2({
            placeholder: "",
            allowClear: true
        });
		 $(".multiple_dropdown").select2({
        });

		});  
$(".continue").click(function(){
	var ele = $(".showDiv:visible");
	var bool = true;
		ele.find("input,checkbox,textarea, select ").each(function(){
			var tagname = $(this).prop("tagName").toLowerCase();
			if(tagname == 'input'){
			var type = $(this).attr("type");
			if(type == 'text'){

			if($(this).is(":visible") && $(this).val().trim() == ''){
				bool=false;
				$(this).closest('.polymer-form').next(".error_message").show();
				$(this).focus();
				return false;
			}

			if($(this).hasClass("mobval")){
				var mobile=$('#mobile').val();
				var filter= /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;
				if(!filter.test(mobile)){
				bool=false;
				$(this).closest('.polymer-form').next(".error_message").show();
				$(this).focus();
				return false;
			}
			}

			if(this.id == 'email'){
				var emailaddress = $('#email').val();
				var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
				if(!emailReg.test(emailaddress)) {
				bool=false;
				$(this).closest('.polymer-form').next(".error_message").show();
				$(this).focus();
				return false;
			}
			}
			else{
			$(this).closest('.polymer-form').next(".error_message").hide();	
			}

			}}
			else if(tagname =='select'){
				if(this.id != 'worknature'){
                    if ($(this).val() == "" || $(this).val() == null){
                        bool = false;
                        $(this).closest('.form-group').find(".error_message").show();
                        $(this).focus();
                        return false;
                    }
                }
				if(this.id == 'worknature'){
					if($(this).is(":visible") && $(this).val().trim() == ''){
                        bool=false;
                        $(this).closest('.form-group').find(".error_message").show();
                        $(this).focus();
                        return false;
                    }
					 
				 }
			else{
				$(this).closest('.polymer-form').next(".error_message").hide();	
			}		
			}
			else if(tagname == 'textarea'){
				if($(this).val().trim().length == 0){
					bool = false;
					$(this).closest('.polymer-form').next(".error_message").show();
					$(this).focus();
				return false;
			}
			else{
				$(this).closest('.polymer-form').next(".error_message").hide();	
			}		

		}
			else {
			$(".error_message").remove();
			}
		});
		if(bool){
		if($(".showDiv:visible").index() != $(".showDiv:last").index()){
			$(".back").show();
			$(".showDiv:visible").next(".showDiv").show();
			ele.hide();
			if($(".showDiv:visible").index() == $(".showDiv:last").index()){
				$(".entry").show();
				$(this).text("Save");
			}
		}
		else
		{
			$('form').submit();
		}
	}
		});
		

</script>
<script src="http://maps.googleapis.com/maps/api/js?sensor=false&amp;libraries=places&amp;key=AIzaSyDaNPyxJ7NKmZ4rC8awB-BlBh6ieH1Q9os"></script>
    <script>
      $(function(){
		navigator.geolocation.getCurrentPosition(showPosition);
        $("#geocomplete").geocomplete({
          //map: ".map_canvas",
		  //location: $('#co-ordinates').val(),
          details: "#brokerentry",
          types: ["geocode", "establishment"],
		  //types: ["geocode"],
        });

        $("#find").click(function(){
			$("#geocomplete").trigger("geocode");
        });
		function showPosition(position) {
			var coordinates = position.coords.latitude + "," + position.coords.longitude; 
			$('#geocomplete').val(coordinates);
			$("#geocomplete").trigger("geocode");
		}
      });
	   
	   
</script>

