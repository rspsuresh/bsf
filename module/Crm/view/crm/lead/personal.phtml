<?php
		$url = $this->serverUrl(true);
		$url = array_pop(explode("/", $url));
		$url1 = array_pop(explode("/", $url));
?>
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/js/select2.full.min.js"></script>
<link type="text/css" rel="stylesheet" href="<?php echo $this->basePath(); ?>/css/select2.min.css" />
    
<style>
.main {
  width: 250px;
  height: 250px;
  transform: rotate(43deg) scale(0.8);
  margin-bottom: 20px;
  border-radius: 50% 50% 0 50%;
  background: #faf9f1;
  background: linear-gradient(270deg, #f6f4eb, #dcd6d2);
  border: 1px solid rgba(0, 0, 0, 0.1);
  position: relative;
  padding: 5px;
  transition: all 0.5s ease-out;
  box-shadow: 0 0 5px rgba(150, 100, 100, 0.3), 3px 3px 8px rgba(150, 100, 100, 0.3);
}

.inner {
  width: 100%;
  height: 100%;
  background: #faf9f1;
  background: linear-gradient(270deg, #fafaf2, #ece7e1);
  border-radius: inherit;
}

.inner:after {
  content: "";
  position: absolute;
  width: 170px;
  height: 170px;
  left: 30px;
  top: 30px;
  border-radius: 50%;
  box-shadow: inset -20px -20px 50px rgba(150, 100, 100, 0.075), 10px 10px 10px 5px rgba(150, 100, 100, 0.075);
  background:url(<?php echo $this->basePath(); ?>/images/Icon_5.png);
}

.inner:before {
  content: "";
  position: absolute;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  right: 20px;
  bottom: 20px;
  background:#e75252;
  box-shadow: inset 5px 5px 15px rgba(150, 100, 100, 0.075), -1px -1px 3px rgba(150, 100, 100, 0.075);
}
.main.checked-yes {
  transform: rotate(68deg) scale(0.8);
}
.main.checked-no {
  transform: rotate(25deg) scale(0.8);
}
.main.checked-yes .inner:after{background:url(<?php echo $this->basePath(); ?>/images/Icon_5.png);}
.main.checked-yes .inner:before{background:#7fb74c;}

</style>
<div class="content_wrapper padlr0">
    <div class="container-fluid padlr0">
        <div class="col-lg-12">
		  <?php if(count($resultsBuyer)>0) {?>
                <h1 class="float_l">Personal Details of Buyer 
                   <div class="btn-group proname_btn">
                    <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown"><?php echo ucfirst($responseLead['LeadName']);?> <span class="edit_symbols" data-placement="right" data-toggle="tooltip" data-original-title="Change&nbsp;Followup&nbsp;Name"><i class="fa fa-caret-down "></i></span></a> 							
                        <div class="dropdown-menu toolbar_ddown proname_ddown arrow" role="menu">
                            <ul>
                            <?php foreach($resultsLeadData as $leadData){?>
                                <li><a href="javascript:void(0);" class="followupId" data-index="<?php echo $leadData['LeadId'];?>"><?php echo ucfirst($leadData['LeadName']);?></a></li>
                            <?php }	?>
                            </ul>
                        </div>
                    </div>
		  </h1><?php } else{?>
		  <h1 class="float_l">Personal Details of Lead 
                   <div class="btn-group proname_btn">
                    <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown"><?php echo ucfirst($responseLead['LeadName']);?> <span class="edit_symbols" data-placement="right" data-toggle="tooltip" data-original-title="Change&nbsp;Followup&nbsp;Name"><i class="fa fa-caret-down "></i></span></a> 							
                        <div class="dropdown-menu toolbar_ddown proname_ddown arrow" role="menu">
                            <ul>
                            <?php foreach($resultsLeadData as $leadData){?>
                                <li><a href="javascript:void(0);" class="followupId" data-index="<?php echo $leadData['LeadId'];?>"><?php echo ucfirst($leadData['LeadName']);?></a></li>
                            <?php }	?>
                            </ul>
                        </div>
                    </div>
		  </h1><?php }?>
            	<a class="clshvr float_r" href="<?php echo $this->basePath(); ?>/crm/lead/register"><span class="select2-selection__clear">Ã—</span> <span class="clscrm"> Close</span></a>
        </div> 
        <div class="col-lg-12 clear">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-8 col-md-offset-2 col-sm-10 col-sm-offset-1">
                    <div class="col-lg-12">
                        <div class="row">
                            <div class="step_by_liner animated slideInDown"></div>
                            <ul class="step_by stepby_mb60">
                               <li>
								<div class="step_by_sep animated_0_4s slideInRight"><p>1</p></div>
								<p class="stepli_p1">General</p>
								</li>
								<li>
								<div class="step_by_sep stepsep_active animated slideInRight"><p>2</p></div>
								<p class="stepli_p2">Personal Info</p>
								</li>
								<li>
								<li class="opacity_08">
								<div class="step_by_sep animated_0_4s slideInRight"><p>3</p></div>
								<p class="stepli_p4">Lead Address</p>
							</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-lg-offset-4 col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2">
                <form class="form-horizontal" action="" method="post" id="personal"  enctype="multipart/form-data">
				<input type='hidden' name='POAId' id='pOAId' value='<?php echo $resultspoa['POAId'];?>' />
				<input type='hidden' name='cOAId' id='cOAId' value='<?php echo $resultscoa['CoAppId'];?>' />
				<div id="leadPersonal" class="showDiv">
				    <div class="row">   
                            <div class="form-group col-lg-12">
                    <?php 
                    if(count($resultsMain)>0){
                        ?>
                        <h1 class="txt_center animated fadeInDown">Edit Lead Personal</h1>
                    <?php
                    }
                    else{
                        ?>
                        <h1 class="txt_center animated fadeInDown">Lead Personal</h1>
                    <?php	
                    }
                    ?>
                    </div>
				</div>
                <div class="row">   
                    <div class="col-lg-12 ">
                        <span class="date_icon"><i class="fa fa-calendar"></i></span>
                        <input name="dob" type="text" id="Dob" class="form-control lbl_move date_picker"  value="<?php if(isset($resultsMain) && count($resultsMain)>0){ if(date( 'd-m-Y', strtotime(  $resultsMain[0]['leadDob']) )=='01-01-1970'||'01-01-1900'){
                            echo '';
                        }
                        else{
                            echo $resultsMain[0]['leadDob'];
                        }}?>"
                            readonly label="DOB" />
                       <div class="error_message"><p>please select dob...</p></div>
                    </div>
                </div>  

                   <div class="row" >   
                        <div class="form-group col-lg-12">
                            <div class="radio_check">
                                <p>
                                    <input type="radio" name="sex" <?php echo ((count($resultsMain)>0 && $resultsMain[0]['Gender'] == "Male")?'checked':'')?> id="Male" value="Male">
                                    <label for="Male">Male</label>
                                </p>
                                <p>
                                    <input type="radio" name="sex" <?php echo ((count($resultsMain)>0 && $resultsMain[0]['Gender'] == "Female")?'checked':'')?> id="Female" value="Female">
                                    <label for="Female">Female</label>
                                </p>
                            </div> 
                        </div>
                    </div>
                    <div class="row form-group">   
                        <div class="col-lg-12 ">
                           <select name="religion" id="Religion" class="single_dropdown2 lbl_move" style="width:100%;" label="Religion" >
								<option value="">Religion</option>
								<?php
									foreach($religion as $type){ 
									if(count($resultsMain)>0){
										?>
										<option <?php echo ($resultsMain[0]['Religion']==$type['ReligionId']? 'selected':''); ?> value="<?php echo $type['ReligionId'] ?>" ><?php echo $type['ReligionName'] ?></option>				
									<?php	
									}
									else{
									?>
										<option value="<?php echo $type['ReligionId'] ?>" ><?php echo $type['ReligionName'] ?></option>
									<?php				
									}
									?>
								<?php } ?>
							</select>
							<div class="error_message"><p>please select religion...</p></div>
                        </div>
                    </div>
					
					<div class="row form-group">   
                        <div class="col-lg-12 ">
                            <select name="nationality" id="Nationality" class="single_dropdown2 lbl_move" style="width:100%;" label="Nationality" >
								<option value="">Nationality</option>
								<?php
									foreach($nationality as $type){ 
									if(count($resultsMain)>0){
										?>
										<option <?php echo ($resultsMain[0]['NationalityId']==$type['NationalityId']? 'selected':''); ?> value="<?php echo $type['NationalityId'] ?>" ><?php echo $type['Description'] ?></option>				
									<?php	
									}
									else{
									?>
										<option value="<?php echo $type['NationalityId'] ?>" ><?php echo $type['Description'] ?></option>
									<?php				
									}
									?>
								<?php } ?>
							</select>
							<div class="error_message"><p>please select nationality...</p></div>
                        </div>
                    </div>
					<div class="row form-group">   
                        <div class="col-lg-12 ">
                            <select name="profession" id="Profession" class="single_dropdown2 lbl_move" style="width:100%;" label="Profession" >
								<option value="">Profession</option>
								<?php
									foreach($response as $type){ 
									if(count($resultsMain)>0){
										?>
										<option <?php echo ($resultsMain[0]['ProfessionId']==$type['ProfessionId']? 'selected':''); ?> value="<?php echo $type['ProfessionId'] ?>" ><?php echo $type['Description'] ?></option>				
									<?php	
									}
									else{
									?>
										<option value="<?php echo $type['ProfessionId'] ?>" ><?php echo $type['Description'] ?></option>
									<?php				
									}
									?>
								<?php } ?>
						   </select>
						   <div class="error_message"><p>please select profession...</p></div>
						</div>
                     </div>
					 <div class="row form-group">   
                     	<div class="col-lg-12 ">
                        	<input name="organization" type="text" id="Organization" class="form-control lbl_move" value="<?php echo (count($resultsMain)>0? $resultsMain[0]['Organization']:'');?>" label="Organization" />
                       <div class="error_message"><p>please enter organization...</p></div>
					   </div>
					</div>
					<div class="row form-group">   
                     	<div class="col-lg-12 ">
							<?php
								if(count($resultsMain)>0 && $resultsMain[0]['Photo'] != '') { 
								$resultsMainPhoto = "../".$resultsMain[0]['Photo'];
								
								?>
									<img src="<?php echo $this->basePath(); ?>/<?php echo $resultsMainPhoto;?>" class="brad_2001" alt="" title="" width="150" height="125"/>
								<?php } else { ?>
									<img src="<?php echo $this->basePath(); ?>/images/avatar.jpg" class="brad_200" alt="" title="" width="100" height="100"/>
								<?php } ?>
						</div>
					</div>
                     <!--div class="row">
								<div class="form-group col-lg-12 req_flds">
									</?php
										if( $resultsLeadData[0]['Photo'] != '') { 
								        $photo="../".$resultsLeadData[0]['Photo'];
								?>
									<img src="</?php echo $this->basePath(); ?>/</?php echo $photo;?>" class="brad_200" alt="" title=""/>
								</?php } else { ?>
									<img src="</?php echo $this->basePath(); ?>/images/avatar.jpg" class="brad_200" alt="" title=""/>
								</?php } ?>
								</div>
							</div-->
							<div class="row">
                        <div class="form-group col-lg-12 req_flds">
                            <div class="upload_file">
                                <input type="file" class="hide_file_input" id="files" name="files" value="" onchange="$('#uploadedFile').val(this.value)" />
                                <div class="upload_file_div">
                                    <input type="" class="upload_file_input" value="<?php echo (count($resultsMain)>0? $resultsMain[0]['Photo']:'');?>" id="uploadedFile" label="Select Photo" />
                                    <div class="upload_file_text">Upload</div>
                                </div>
                            </div>
                        </div>
                    </div>
				    </div>
					
					<div id="leadFamily" class="showDiv">
					<div class="row">   
                        <div class="form-group col-lg-12">
					<?php 
						if(count($resultsMain)>0){
						?>
						<h1 class="txt_center animated fadeInDown">Edit Lead Family Details</h1>
						<?php
						}
						else{
						?>
						<h1 class="txt_center animated fadeInDown">Lead Family Details</h1>
						<?php	
						}
						?>
						</div>
						</div>
					<div class="row form-group">   
                        <div class="col-lg-12">
                            <input name="fatherName" type="text" id="FatherName" class="form-control lbl_move" value="<?php echo (count($resultsMain)>0? $resultsMain[0]['FatherName']:'');?>" label="Father Name" />
							<div class="error_message"><p>please enter father name...</p></div>
                        </div>
                    </div>  
                    <div class="row form-group">   
                        <div class="col-lg-12">
                            <input name="motherName" type="text" id="MotherName" class="form-control lbl_move" value="<?php echo (count($resultsMain)>0? $resultsMain[0]['MotherName']:'');?>" label="Mother Name" />
							<div class="error_message"><p>please enter mother name...</p></div>
                        </div>
                    </div>
                    <div class="row form-group">   
                        <div class="col-lg-12">
                            <select name="maritalStatus" id="MaritalStatus" class="single_dropdown2 lbl_move" style="width:100%;" label="Marital Status" >
								<option value="">Marital Status</option>
									<?php
									foreach($responseMarital as $type){
									if(count($resultsMain)>0){
										?>
										<option <?php echo ($resultsMain[0]['MaritalStatus']==$type['MaritalId']? 'selected':''); ?> value="<?php echo $type['MaritalId'] ?>" ><?php echo $type['Description'] ?></option>				
									<?php	
									}
									else{
									?>
										<option value="<?php echo $type['MaritalId'] ?>" ><?php echo $type['Description'] ?></option>
									<?php				
									}
									?>
							<?php } ?>
							</select>
							<div class="error_message"><p>please select marital status...</p></div>
                        </div>
                    </div>
              <div class="row form-group" id="WeddingDate">   
                        <div class="col-lg-12 ">
                            <span class="date_icon"><i class="fa fa-calendar"></i></span>

                          <input name="weddingDate" type="text" id="WeddingDate" class="form-control lbl_move date_picker"  value="<?php if(isset($resultsMain) && count($resultsMain)>0){ if(date( 'd-m-Y', strtotime(  $resultsMain[0]['leadWeddingDate']) )=='01-01-1970'||'01-01-1900'){
                              echo '';
                          }
                          else{
                              echo $resultsMain[0]['leadWeddingDate'];
                          }}?>" readonly label="Wedding Date" />
							<div class="error_message"><p>please select wedding date...</p></div>
                    </div>  
                    </div>  
                    <div class="row form-group" id="SpouseName">   
                        <div class="col-lg-12">
                            <input name="spouseName" type="text" id="SpouseName" class="form-control lbl_move" value="<?php echo (count($resultsMain)>0? $resultsMain[0]['SpouseName']:'');?>" label="Spouse Name" />
						<div class="error_message"><p>please enter spouse name...</p></div>
                        </div>
                    </div>
                    <div class="row form-group" id="child">   
                        <div class="col-lg-12">
                            <select name="haveChild" id="HaveChild" class="single_dropdown2 lbl_move" style="width:100%;" label="Have Child">
								<option value="">Have Child</option>
								<option <?php echo ((count($resultsMain)>0 && $resultsMain[0]['HaveChild'] == "yes") ? 'selected':''); ?> value="yes" >Yes</option>
								<option <?php echo ((count($resultsMain)>0 && $resultsMain[0]['HaveChild']== "no") ? 'selected':''); ?> value="no" >No</option>				
							</select>
							<div class="error_message"><p>please select have child...</p></div>
                        </div>
                    </div>
					<div class="row form-group" id="childs"> 
                       <div class="col-lg-12">					
							<select name="childs" id="childnum" class="single_dropdown2 lbl_move" style="width:100%;" label="No of Childs">
								<option value="">Select No of Children</option>
								<option <?php echo ((count($resultsMain)>0 && $resultsMain[0]['NoOfChilds']== 1) ? 'selected':''); ?> value="1">1</option>
								<option <?php echo ((count($resultsMain)>0 && $resultsMain[0]['NoOfChilds']== 2) ? 'selected':''); ?> value="2">2</option>
								<option <?php echo ((count($resultsMain)>0 && $resultsMain[0]['NoOfChilds']== 3) ? 'selected':''); ?> value="3">3</option>
								<option <?php echo ((count($resultsMain)>0 && $resultsMain[0]['NoOfChilds']== 4) ? 'selected':''); ?> value="4">4</option>
							</select>
							<div class="error_message"><p>please select no of children...</p></div>
						</div>
                    </div>
					<div class="" id="addChildren" style="display:none;width:600px;margin-left:-100px;">
						<div class="table-responsive clear">
							<!--<div class="col-lg-12">
							<a href="#" class=" vendor_addnew" id="addCert">Addnew</a>
							</div>-->
							<div class="">
								<table class="table table-hover vendar_bottom clear" id="ChildrensTable">
									<thead>
										<tr>
											<th>S.No</th>
											<th>Child Name</th>
											<th>DOB</th>
											<th>Gender</th>
											<th></th>
										</tr>
									</thead>
									<tbody>
                                       
									</tbody>
								</table>
							</div>
							</div>
							</div>
							<div class="" id="loadChildren" style="display:none;width:600px;margin-left:-100px;">
						<div class="table-responsive clear">
							<!--<div class="col-lg-12">
							<a href="#" class=" vendor_addnew" id="addCert">Addnew</a>
							</div>-->
							<div class="">
							
								<table class="table table-hover vendar_bottom clear" id="ChildTable">
									<thead>
										<tr>
											<th>S.No</th>
											<th>Child Name</th>
											<th>DOB</th>
											<th>Gender</th>
											<th></th>
										</tr>
									</thead>
									<tbody>
                                       
									</tbody>
								</table>
							</div>
						</div>
					</div>
              </div>
         <div id="leadnri" class="showDiv">
        <div class="col-xs-12 col-centered float_c">
            <div class="row-centered wrappper">`
                 <h1 class="txt_center animated fadeInDown">Whether this Lead NRI?</h1>
                 <div class="main checked-no">
                    <div class="inner"></div>
                </div>
                 <div class="radio_check commargin_bottom" style="padding-left: 100px">
                    <p style="position: relative; right: 45px">
                        <input type="radio" id="lead_nri_yes" name="lead_nri_yes_no" value="1" <?php  if(count($resultsMain)>0) { if ($resultsMain[0]['NRI']==1){ echo "checked"; }}  ?> />
                        <label for="lead_nri_yes" class="ripple">Yes</label>
                    </p>
                    <p>
                        <input type="radio" id="lead_nri_no" name="lead_nri_yes_no" value="0" <?php if(count($resultsMain)>0) { if ($resultsMain[0]['NRI']==0){ echo "checked"; }}else { echo "checked"; } ?> />
                        <label for="lead_nri_no" class="No" >No</label>
                    </p>
                </div>	
                
		</div>
	</div>
</div>	
<div id="leadNriDetails" class="showDiv">
           <div class="row">   
             <div class="form-group col-lg-12">
				<?php 
			if(count($resultsMain)>0){
			?>
			<h1 class="txt_center animated fadeInDown">Edit Lead NRI Contact Details</h1>
			<?php
			}
			else{
			?>
			<h1 class="txt_center animated fadeInDown">Lead NRI Contact Details</h1>
			<?php	
			}
			?>
			</div>
			</div>
					<div class="row form-group" id="PersonName">   
                        <div class="col-lg-12">
                             <input  name="personName" type="text"  class="form-control lbl_move" value="<?php echo (count($resultsNri)>0? $resultsNri[0]['PersonName']:'');?>" label="Contact Person in India" />
							<div class="error_message"><p>please enter person name...</p></div>
                        </div>
                    </div>
					<div class="row form-group" id="geo" >   
                        <div class="col-lg-12 ">
                            <input  id="geocomplete"  name="address"  type="text" label="Type Address" value="<?php echo (count($resultsNri)>0? $resultsNri[0]['Address']:'');?>" class="form-control lbl_move" />
							<div class="error_message"><p>please enter address...</p></div>
                        </div>
                    </div>  
					 
                        <div class="col-lg-12">
							<input type="hidden" data-name="locality" name="city"  label="City" value="<?php echo (count($resultsNri)>0? $resultsNri[0]['City']:'');?>" />
							<div class="error_message"><p>please enter city...</p></div>
						</div>
					
					
                   <div class="row form-group" id="State">   
                        <div class="col-lg-12">
							<input type="text" data-name="administrative_area_level_1" name="state"  label="State" value="<?php echo (count($resultsNri)>0? $resultsNri[0]['State']:'');?>" class="form-control lbl_move"/>
							<div class="error_message"><p>please enter state...</p></div>
						</div>
					</div>

                        <div class="col-lg-12">
							<input data-name="country" type="hidden" name="country"  label="Country" value="<?php echo (count($resultsNri)>0? $resultsNri[0]['Country']:'');?>" />
							<div class="error_message"><p>please enter country...</p></div>
						</div>
	
					<div class="row form-group" id="Mobile">   
                        <div class="col-lg-12 ">
							<input name="mobile" type="text"  class="form-control lbl_move mobval" id="mobile" value="<?php echo (count($resultsNri)>0? $resultsNri[0]['MobileNo']:'');?>" label="Mobile" maxlength="10" onKeyPress="return isNumberKey(event)" />
							<div class="error_message"><p>please enter mobile number...</p></div>
						</div>
					</div>
							<div class="row form-group" id="Email">   
                        <div class="col-lg-12">
							<input name="email" type="text"  class="form-control lbl_move emailId" value="<?php echo (count($resultsNri)>0? $resultsNri[0]['Email']:'');?>" label="Email" />
							<div class="error_message"><p>please enter valid email...</p></div>
							</div>
							</div>
							<input type="hidden" name="saveExit" id="saveExit" value="1">
				    </div>			 
            </form>
				
                </div>
            </div>
        </div>
        </div>
        </div>
   
<div class="col-lg-12 savebtn_area">
    <ul>
       <li class="save_btn float_r">
        	<a href="javascript:void(0);" class="ripple saveExit" >Save &amp; Exit </a>
        </li>
        <li class="save_btn float_r">
            <a href="javascript:void(0);" class="ripple continue">Save &amp; Next</a>
        </li>
        <li class="cancel_btn float_r"><a href="javascript:void(0);" class="ripple back">back</a></li>
        <li class="goto">
            <label for="go_to" class="float_l">Go to</label> 
            <select id="dropdown" name="dropdown" class="dropdown float_l goto_select" title="choose page to go...">
                     <option value="1" <?php if($this->currentRequest()->get('action') == 'entry-edit') { echo 'selected';}?>>Lead Entry</option>
                <option value="2" <?php if($this->currentRequest()->get('action') == 'personal') { echo 'selected';}?>>Lead Personal</option>
                <option value="3" <?php if($this->currentRequest()->get('action') == 'address') { echo 'selected';}?>>Lead Address</option>
                <option value="4" <?php if($this->currentRequest()->get('action') == 'bank') { echo 'selected';}?>>Lead Bank</option>
                <option value="5" <?php if($this->currentRequest()->get('action') == 'coa') { echo 'selected';}?>>Lead Co-Applicant Address</option>
                <option value="6" <?php if($this->currentRequest()->get('action') == 'poa') { echo 'selected';}?>>Lead Power of Attroney</option>
                <option value="7" <?php if($this->currentRequest()->get('action') == 'financial') { echo 'selected';}?>>Lead Financial</option>
                <option value="8" <?php if($this->currentRequest()->get('action') == 'requirement') { echo 'selected';}?>>Lead Requirement</option>
            </select>  
        </li>
        <p class="donecngs_p">Done With Your Changes ?</p>
    </ul>
</div>

<script id="dummy-activity" type="text/template" class="hide">
    <tr id="fxt__">
        <th>--SNO--</th>
        <td><input class="form-control" type="text"  name="ChildName__" id="ChildName__" /> </td>
        <td><input class="form-control date_picker" readonly="readonly" type="text" name="DOB__" id="DOB__" /> </td>
        <td><input class="form-control" type="radio" name="Sex__" id="Sex__" value="M" />Male
            <input class="form-control" type="radio" name="Sex__" id="Sexs__" value="F" />Female
        </td>
    </tr>
</script>


<script>
$(".savedata").click(function(){
$('form').submit();	
});
	 $(function() {
		
		//lead nri on change
		 $('input[name="lead_nri_yes_no"]').on('change', function() {
			 var $main = $(this).closest('.wrapper').find('.main');
			 if($(this).val() == '1') {
				//yes
				 $main.removeClass('checked-no').addClass('checked-yes');
				 //$('#leadnri').hide();
	             //$('#leadNriDetails').show();
			 }
			 else if($(this).val() == '0'){
				//no
				 $main.removeClass('checked-yes').addClass('checked-no');
				 /*$('#leadNriDetails').find('input:text').val('');
				 if(confirm("Are you completed this?")){
					 $('form').submit();
				 }
				 else{
					 return false;
				 }*/
			 }
			
		 });
	 });
$("input:text").blur(function(){
	if($(this).val().trim().length != 0){
		$(this).next("span").text("");
	}
	else{
		$(this).next("span").text($(this).attr("error"));
	}
});
   
	$(".showDiv").hide();
	$(".back").hide();
	$(".entry").hide();
	$("#leadPersonal").show();
$(".continue").click(function(){
$('.error_message').hide();
	var ele = $(".showDiv:visible");
	$(".error").text("");
	var bool = true;
	ele.find("input").each(function(){
	
		if($(this).hasClass("mobval")){
						var mobile=$('#mobile').val();
						if(mobile!==''){
						var filter= /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;
						if(!filter.test(mobile)){
							bool=false;
							$(this).closest('.polymer-form').next(".error_message").show();
							$(this).focus();
							return false;
						}
		}}
		if($(this).hasClass("emailId")){
							var pan=$(this).val();
							if(pan!==''){
							var filter=  /^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/;
								if(!filter.test(pan)){
									bool=false;
									$(this).closest('.polymer-form').next(".error_message").show();
						              $(this).focus();
								}
		}}
				
		});
		
	if(bool){
		//alert($(".showDiv:visible").index()+'-----------'+$(".showDiv:last").index());
		if($(".showDiv:visible").index() != $(".showDiv:last").index()){
			$(".back").show();
			if($(".showDiv:visible").index() == '4'){
				$("#leadNriDetails").hide();
				var nriFound = $('input:radio[name=lead_nri_yes_no]:checked').val();
				if(nriFound == '0'){
					$('form').submit();
				}else if(nriFound != '0' && nriFound != '1') {
					alert("Please choose atleast one to proceed further");
					return;
				}
				else {
					ele.hide();
					$(".entry").show();
					$("#leadNriDetails").show();
					$(this).text("Save & Next");
				}
			} else {
				$(".showDiv:visible").next(".showDiv").show();
				ele.hide();
			}
		} else {
			$('form').submit();
		}
	}
});
//save and exit//
$(".saveExit").click(function(){

$('.error_message').hide();
	var ele = $(".showDiv:visible");
	$(".error").text("");
	var bool = true;
	ele.find("input").each(function(){
	
		if($(this).hasClass("mobval")){
						var mobile=$('#mobile').val();
						if(mobile!==''){
						var filter= /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;
						if(!filter.test(mobile)){
							bool=false;
							$(this).closest('.polymer-form').next(".error_message").show();
							$(this).focus();
							return false;
						}
		}}
		if($(this).hasClass("emailId")){
							var pan=$(this).val();
							if(pan!==''){
							var filter=  /^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/;
								if(!filter.test(pan)){
									bool=false;
									$(this).closest('.polymer-form').next(".error_message").show();
						              $(this).focus();
								}
		}}
				
		});
		
	if(bool){
		
	          var sum=2;
		$("#saveExit").val(sum);
			$('form').submit();
		}
	
});
$(".back").click(function(){
	var ele = $(".showDiv:visible");
	if(ele.closest(".showDiv").prev(".showDiv").index() == $(".showDiv:first").index())
		$(".back").hide();
        $(".entry").hide();
    ele.closest(".showDiv").prev(".showDiv").show();
	ele.hide();
});
$('#MaritalStatus').on('change',function(){
	var stype = $("#MaritalStatus option:selected").text();
		if(stype=='Single'||stype=='Widowed'||stype=='Divorced'){
			$('#WeddingDate').hide().find('input:text').val('');
			$('#SpouseName').hide().find('input:text').val('');
			$('#child').hide().find('select').val('');
			$('#childs').hide().find('select').val('');
			$('#children').hide();
			$('#ChildName').hide();
			$('#ChildSex').hide();
			$('#DateOfBirth').hide();
			$('#addChildren').hide();
			$('#loadChildren').hide();
		} else if(stype=='Married'){
			$('#WeddingDate').show();
			$('#SpouseName').show();
			$('#child').show();  
			
		}
		else{
			$('#WeddingDate').hide();
			$('#SpouseName').hide();
			$('#child').hide().find('select').val('');
			$('#HaveChild').hide().find('select').val('');
			$('#children').hide();
			$('#addChildren').hide();
			$('#childs').hide().find('select').val('');
			$('#ChildName').hide();
			$('#ChildSex').hide();
			$('#DateOfBirth').hide();
			$('#loadChildren').hide();
		}
}).change();



$("#City").change(function(){
	$.ajax({
		url:"<?php echo $this->basePath();?>/crm/lead/getcitydetail",
		type:"post",
		data:"cid="+$(this).val(),
		dataType:"json",
		success:function(data, textStatus, jqXHR){
			//alert(JSON.stringify(data))
			//var obj = jQuery.parseJSON(data);
			$('#State').val(data[0].StateName);
			$('#Country').val(data[0].CountryName);
		},
		error:function(jqXHR, textStatus, errorThrown){
			alert(textStatus+"-----"+errorThrown);
		}
	});
}).change();
$(".date_picker").datepicker({
	format: 'dd-mm-yyyy',
    autoclose: true
});
</script>
<script>
$(document).on('change','.date_picker', function() {
    $('.datepicker').hide();
});
var count = 0;
$('#childs').on('change',function(){
	$('#loadChildren').hide();
	$('#ChildTable').html('');
	$('#ChildTable').hide();
	var stype = $("#childs option:selected").text();
	// alert(stype);
	$("#addChildren").slideDown("slow");
		n = stype;
		if(count < n){
			//$("#ChildrensTable tbody").html('');
			for(var i= parseInt(count) + 1;i<=n;i++){
			$("#ChildrensTable tbody").append("<tr id='fxt_"+i+"'>"+
													"<th>"+i+"</th>"+
													//"<input class='form-control' type='hidden' name='CheckListName_"+$(this).val()+"' id='CheckListName_"+$(this).val()+"'value='"+$(this).attr('ename')+"'/>"+
													"<td><input class='form-control' type='text' placeholder ='Child Name' name='ChildName_"+i+"' id='ChildName"+i+"'/></td>"+
													"<td><input class='form-control date_picker' readonly='readonly' type='text' placeholder ='DOB' name='DOB_"+i+"' id='DOB"+i+"'/></td>"+

													"<td>"+
													
													"<input class='form-control' type='radio' name='Sex_"+i+"' id='Sex"+i+"' value='M'  />Male"+
													"<input class='form-control' type='radio' name='Sex_"+i+"' id='Sexs"+i+"' value='F'/>Female"+
													"</td>"+
													//"<p><td>Male<input class='form-control' type='radio' name='Sex_"+i+"' id='Sex"+i+"' value='M'/></td>" + "<td>Female<input class='form-control' type='radio' name='Sex_"+i+"' id='Sex"+i+"' value='F'/></td></p>"+
											"</tr>");
			}
		}
		else{
			for(var i= parseInt(count);i>n;i--){
				$('#fxt_'+i).remove();
			}
		}
		$(".date_picker").unbind();
		
		$(".date_picker").datepicker({
			format: 'dd-mm-yyyy'
		});
		count = n;
		
			$('#noOfChild').show();
			$('#ChildName').hide();
			$('#DateOfBirth').hide();
			$('#ChildSex').hide();
		
});
</script>
<script>
$('#HaveChild').on('change',function(){
	var stype = $("#HaveChild option:selected").text();
	if(stype=='No') {
		$('#childs').hide().find('select').val('');
		//$('#children').hide().find('input:select').val('');
		$('#ChildName').hide().find('input:text').val('')
		$('#DateOfBirth').hide().find('input:text').val('')
		$('#ChildSex').hide().find('radio').val('')
		$('#addChildren').hide();
	}  else if(stype=='Yes') {
		$('#childs').show();
	} else {
		$('#childs').hide().find('select').val('');
		$('#addChildren').hide();
	}
})
</script>

<script>
$("#dropdown").change(function(){
	if($(this).val() == 1){
		$(location).attr('href',"<?php echo $this->basePath(); ?>/crm/lead/entry-edit/<?php echo $url; ?>");
	}
	if($(this).val() == 2){
		$(location).attr('href',"<?php echo $this->basePath(); ?>/crm/lead/personal/<?php echo $url; ?>");
	}
	if($(this).val() == 3){
		$(location).attr('href',"<?php echo $this->basePath(); ?>/crm/lead/address/<?php echo $url; ?>");
	}
	if($(this).val() == 4){
		$(location).attr('href',"<?php echo $this->basePath(); ?>/crm/lead/bank/<?php echo $url; ?>");
	}
	if($(this).val() == 5){
		var coa=$("#cOAId").val();
		if(coa>0){ $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/lead/coa/<?php echo $url; ?>/<?php echo $resultscoa['CoAppId'];?>");}
	 else{ $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/lead/coa/<?php echo $url; ?>");}}
	
	 if($(this).val() == 6){
		var poa=$("#pOAId").val();
		if(poa>0){$(location).attr('href',"<?php echo $this->basePath(); ?>/crm/lead/poa/<?php echo $url; ?>/<?php echo $resultspoa['POAId'];?>");}
	 else{$(location).attr('href',"<?php echo $this->basePath(); ?>/crm/lead/poa/<?php echo $url; ?>");}}
	
	if($(this).val() == 7){
		$(location).attr('href',"<?php echo $this->basePath(); ?>/crm/lead/financial/<?php echo $url; ?>");
	}
	if($(this).val() == 8){
		
		$(location).attr('href',"<?php echo $this->basePath(); ?>/crm/lead/requirement/<?php echo $url; ?>");
	}
 });	
</script>
<script src="http://maps.googleapis.com/maps/api/js?sensor=false&amp;libraries=places&amp;key=AIzaSyDaNPyxJ7NKmZ4rC8awB-BlBh6ieH1Q9os"></script>
    <script>
      $(function(){
		navigator.geolocation.getCurrentPosition(showPosition);
        $("#geocomplete").geocomplete({
          //map: ".map_canvas",
		  //location: $('#co-ordinates').val(),
          details: "#personal",
          types: ["geocode", "establishment"]
		  //types: ["geocode"],
        });

        $("#find").click(function(){
			$("#geocomplete").trigger("geocode");
        });
		function showPosition(position) {
			var coordinates = position.coords.latitude + "," + position.coords.longitude; 
			$('#geocomplete').val(coordinates);
			$("#geocomplete").trigger("geocode");
		}
      });
</script>
<script>
	$(document).ready(function() {
        var stype = $("#HaveChild option:selected").text();
        var arr_Units = <?php echo (isset($resultsMainChild)) ? json_encode($resultsMainChild) : '[]';?>;
        if(stype=='No') {
            $('#childs').hide().find('select').val('');
            $('#ChildName').hide().find('input:text').val('')
            $('#DateOfBirth').hide().find('input:text').val('')
            $('#ChildSex').hide().find('radio').val('')
            $('#addChildren').hide();
            $('#loadChildren').hide();
        }  else if(stype=='Yes') {
			$('#addChildren').hide();
            $('#childs').show();
            $('#loadChildren').show();
            //$('#DateOfBirth').hide().find('input:text').val('')
            var cnt=arr_Units.length;
            if(cnt!=0){
                var template = $('#dummy-activity').html();
                var $tbody = $('#ChildTable');
                $.each(arr_Units, function (i, o) {
                    var k=i+1;
                    $tbody.find('tbody').append(template.replace(/__/g, '_' + k).replace(/--SNO--/g, + k));
                    $('#ChildName_' + k).val(o.ChildName);
                    $('#DOB_' + k).val(o.ChildDob);
                    if(o.ChildSex=="M") {
                        $('#Sex_' + k).attr('checked','checked');
                    } if(o.ChildSex=="F") {
                        $('#Sexs_' + k).attr('checked','checked');
                    }
                })
            }
        }
        $(".single_dropdown2").select2({
			placeholder: "",
			allowClear: true
		});
	});
</script>
<style type="text/css" media="screen">
    .map_canvas { float: left; }
    fieldset { width: 320px; margin-top: 20px}
    fieldset label { display: block; margin: 0.5em 0 0em; }
    fieldset input { width: 95%; }
</style>
<script>
$('.leadId').on('click',function(){
	var urlId = $(this).attr('data-index');
	location.replace("<?php echo $this->basePath(); ?>/crm/lead/entry-edit/"+urlId);
})

$('.followupId').on('click',function(){
	var urlId = $(this).attr('data-index');
	location.replace("<?php echo $this->basePath(); ?>/crm/lead/personal/"+urlId);
})
</script>