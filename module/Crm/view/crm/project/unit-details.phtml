<?php
$url = $this->serverUrl(true);
$url = array_pop(explode("/", $url));
?>
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/js/select2.full.min.js"></script>
<link type="text/css" rel="stylesheet" href="<?php echo $this->basePath(); ?>/css/select2.min.css" />
<form method="post" id="form">
	<div class="content_wrapper padlr0">
		<div class="container-fluid padlr0">
			<div class="col-lg-12">
				<h1>Project Info of
                    <div class="btn-group proname_btn">
                        <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown"><?php //echo ucfirst($responseLead['ProjectName']);?> <span class="edit_symbols" data-placement="right" data-toggle="tooltip" data-original-title="Change&nbsp;Followup&nbsp;Name"><i class="fa fa-caret-down "></i></span></a> 							
                        <div class="dropdown-menu toolbar_ddown proname_ddown arrow" role="menu">
                            <ul>
                                <?php foreach($resultsLeadData as $leadData){?>
                                <li><a href="javascript:void(0);" class="projectId" data-index="<?php //echo $leadData['ProjectsId'];?>"><?php//echo ucfirst($leadData['ProjectName']);?></a></li>
                                <?php }	?>
                            </ul>
                        </div>
                    </div>
                </h1>
			</div>
			<div class="col-lg-12 clear">
				<div class="row">
					<div class="col-lg-8 col-lg-offset-2 col-md-8 col-md-offset-2 col-sm-10 col-sm-offset-1">
                        <div class="col-lg-12">
                            <div class="row">
                                <div class="step_by_liner animated slideInDown"></div>
                                    <ul class="step_by stepby_mb60">
                                    <li>
                                <div class="step_by_sep animated_0_4s slideInRight"><p>1</p></div>
                                    <p class="stepli_p1">General</p>
                                    </li>
                                    <li>
                                <div class="step_by_sep stepsep_active animated slideInRight"><p>2</p></div>
                                    <p class="stepli_p2">Unit Details</p>
                                    </li>
                                    <li class="opacity_08">
                                <div class="step_by_sep animated_1_5s slideInRight"><p>3</p></div>
                                    <p class="stepli_p3">Land Cost Calculation</p>
                                    </li>
                                </ul>
                           </div>
                        </div>
                    </div>
                </div>
            </div>
			<div class="col-lg-4 col-lg-offset-4 col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2">			
                <!--Unit Particular-->
                <div id="UnitPart" class="showDiv">
                    <h1 class="txt_center form_main_h1">Unit Particulars</h1> 
                    <!--<div class="row">   
                        <div class="form-group col-lg-12 ">
                            <select name="UnitTypeId" id="UnitTypeId" class="single_dropdown2 lbl_move" style="width:100%;" label="Flat Type">
                            <option value="">Choose FlatType</option>
                                <?php
                                        //foreach($resultsUnitType as $type){ 
                                        //	echo "<option value='".$type['UnitTypeId']."' >".$type['UnitTypeName']."</option>";
                                        //}
                                ?>
                            </select>
                            <div class="error_message"><p>Please fill FlatType...</p></div>
                        </div>
                    </div> -->		
                <!--<div class="row">   
                        <div class="form-group col-lg-12 ">
                            <select name="Flat" id="FlatName" class="single_dropdown2 lbl_move" style="width:100%;" label="unit Type">
                                <option value="">Choose FlatType</option>
                                <?php
                                    //foreach($resultsFlat as $type){ 
                                        //echo "<option value='".$type['UnitTypeId']."' >".$type['UnitTypeName']."</option>";
                                    //}
                                ?>
                            </select>
                            <div class="error_message"><p>Please fill Area...</p></div>
                        </div>
                    </div>-->	
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move" label="unit No" name="UnitNo" id="UnitNo" >  
                            <div class="error_message"><p>Please fill BuyerName...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move" label="Floor Name" name="FloorName" id="FloorName" >  
                            <div class="error_message"><p>Please fill FloorName...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move" label="Buyer Name" name="BuyerName" id="BuyerName" >  
                            <div class="error_message"><p>Please fill BuyerName...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12 ">
                            <select name="ExecutiveId" id="ExecutiveName" class="single_dropdown2 lbl_move" style="width:100%;" label="Executive Name">
                                <option value="">Choose Executive Name</option>
                                <?php
                                        foreach($resultsExecutive as $type){ 
                                            echo "<option value='".$type['ExecutiveId']."' >".$type['ExecutiveName']."</option>";
                                        }
                                ?>
                            </select>
                            <div class="error_message"><p>please choose Executive Name...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12 ">
                            <select name="StatusId" id="StatusId" class="single_dropdown2 lbl_move" style="width:100%;" label="Status">
                                <option value="">Choose Status</option>
                                <?php
                                    foreach($resultsStatus as $type){ 
                                        echo "<option value='".$type['StatusId']."' >".$type['Description']."</option>";
                                    }
                                ?>
                            </select>
                            <div class="error_message"><p>please choose status...</p></div>
                        </div>
                    </div>
                </div>
            	<!-- unit Area Details-->
            	<div class="showDiv" id="UnitArea">
                    <h1 class="txt_center form_main_h1">Unit Area Details</h1> 
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move calculation" label="Area 0.00" name="Area" id="Area" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill Area...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move calculation" label="CarpetArea 0.00" name="CarpetArea" id="CarpetArea" onKeyPress="return isNumberKey(event)">
                            <div class="error_message"><p>Please fill CarpetArea...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move calculation" label="UdsLandArea 0.00" name="UdsLandArea" id="UDSLandArea" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill CarpetArea...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12 ">
                            <select name="FacingId" id="FacingId" class="single_dropdown2 lbl_move" style="width:100%;" label="Facing">
                                <option value="">Choose Face</option>
                                <?php
                                    foreach($resultsFace as $type){ 
                                        echo "<option value='".$type['FacingId']."' >".$type['Description']."</option>";
                                    }
                                ?>
                            </select>
                            <div class="error_message"><p>please choose Facing...</p></div>
                        </div>
                    </div>
                </div>
                <!--unit Cost Details-->
                <div class="showDiv" id="UnitCost">
                    <h1 class="txt_center form_main_h1">Unit Cost Details</h1> 
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move calculation" label="Rate 0.00" name="Rate" id="Rate" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill Rate...</p></div>
                        </div>
                    </div>
                    
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move gross" label="OtherCost 0.00" name="OtherCost" id="OtherCost" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill OtherCost...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move gross" label="GuideLineValue 0.00" name="GuideLinevalue" id="GuideLineValue" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill GuideLineValue...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move gross" label="MarketLandValue" name="MarketLandValue" id="MarketLandValue" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill MarketLandValue...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move gross" label="NetAmount 0.00" name="NetAmt" id="NetAmount" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill NetAmount...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move gross" label="LandAmount" name="LandAmount" id="LandAmount" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill LandAmount...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move gross" label="ConstructionAmount 0.00" name="ConstructionAmount" id="ConstructionAmount" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill ConstructionAmount...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move gross" label="GrossAmount 0.00" name="GrossAmount" id="GrossAmount" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill GrossAmount...</p></div>
                        </div>
                    </div>
                </div>
                <!--payable Amount Details-->
                <div class="showDiv" id="Payable">
                    <h1 class="txt_center form_main_h1">Payable Amount Details</h1> 
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="gross form-control lbl_move calculation" label="BaseAmount 0.00" name="BaseAmt" id="BaseAmount" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill BaseAmount...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move " label="QualifierAmount" name="QualifierAmount" id="QualifierAmount" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill QualifierAmount...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move percent" label="AdvanceAmount" name="AdvAmount" id="AdvanceAmount" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill AdvanceAmount...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move percent" label="AdvancePercent 0.00" name="AdvPercent" id="AdvancePercent" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill AdvancePercent...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move" label="LateInterest 0.00" name="LateInterestPercent" id="LateInterest" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill LateInterest...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <select name="PaymentSchId" id="PaymentSchId" class="single_dropdown2 lbl_move" style="width:100%;" label="Payement Schedule">
                                <option value="">PayementSchedule</option>
                                <?php
                                    foreach($resultsPayment as $type){ 
                                        echo "<option value='".$type['TemplateId']."' >".$type['Description']."</option>";
                                    }
                                ?>
                            </select>
                            <div class="error_message"><p>please choose Facing...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move " label="CreditDays" name="CreditDays" id="CreditDays" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill CreditDays...</p></div>
                        </div>
                    </div>
                <!--<div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move " label="LandDiscount" name="LandDiscount" id="LandDiscount" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill LandDiscount...</p></div>
                        </div>
                    </div>
                    <div class="row">   
                        <div class="form-group col-lg-12">
                            <input type="text" class="form-control lbl_move " label="ConstructionDiscount" name="ConstructionDiscount" id="ConstructionDiscount" onKeyPress="return isNumberKey(event)">  
                            <div class="error_message"><p>Please fill ConstructionDiscount...</p></div>
                        </div>
                    </div>-->
				</div>
            </div>
		</div>	
	</div>
</form>
<div class="col-lg-12 savebtn_area">
    <ul>
        <li class="dropdown save_btn float_r">
            <a href="javascript:void(0);" class="ripple continue">Save</a>
            <div class="save_trigger">
                <a href="javascript:void(0);" class="ripple " data-toggle="dropdown">
                    <i class="fa fa-angle-down"></i>
                </a>
                <ul class="ang_down_ul save_down_ul dropdown-menu dropdown-menu-right">
                    <li><a href="javascript:void(0);" class="ripple continue">Save &amp; Next</a></li>
                    <li><a href="<?php echo $this->basePath(); ?>/crm/project/Projects">Save &amp; Exit</a></li>
                </ul>
            </div>
        </li>
    </ul>
</div>
<script>
$(document).ready(function() {
	$(".single_dropdown2").select2({
		placeholder: "",
		allowClear: true
	});
	$(".multiple_dropdown").select2({
	});
});
	
</script>
<script>
$(".showDiv").hide();
$(".back").hide();
$("#UnitPart").show();
$(".continue").click(function(){
$('.error_message').hide();
	var ele = $(".showDiv:visible");
	$(".error").text("");
	var bool = true;
	ele.find("input,checkbox, select, textarea").each(function(){
		var tagname = $(this).prop("tagName").toLowerCase();
		// if(tagname == 'input'){
				// var type = $(this).attr("type");
				// if(type == 'text'){
					// if($(this).is(":visible") && $(this).val().trim() == ''){
						// bool=false;
						// $(this).closest('.polymer-form').next(".error_message").show();
						// $(this).focus();
						// return false;
					// }
			
					// if($(this).hasClass("mobval")){
						// var mobile=$('#Mobile').val();
						// var filter= /^([0-9]{1,10})$/;
						// if(!filter.test(mobile)){
							// bool=false;
							// $(this).closest('.polymer-form').next(".error_message").show();
							// $(this).focus();
							// return false;
						// }
					// }
				
				// } else if(type == 'checkbox'){
				// } else if(type == 'radio'){
				// }					
			// } 
		//else 
			if(tagname == 'select'){
			if($(this).val() == "" || $(this).val() == null){
				bool = false;
				//console.log($(this).closest('.polymer-form').next(".error_message"))
				$(this).closest('.form-group').find(".error_message").show();
				$(this).focus();
				return false;					
			}
		}
		 else if(tagname == 'textarea'){
				if($(this).is(":visible")){
					if($(this).val().trim().length == 0){
						bool = false;
						$(this).closest("div").next(".error").text($(this).attr("error"));
						$(this).focus();
						return false;
					}
				}
			} else {
				$(".error").remove();
			}		
		});
	if(bool){
		//alert($(".showDiv:visible").index()+'-----------'+$(".showDiv:last").index())
		if($(".showDiv:visible").index() != $(".showDiv:last").index()){
			$(".back").show();
			$(".showDiv:visible").next(".showDiv").show();
			ele.hide();
			if($(".showDiv:visible").index() == $(".showDiv:last").index()){
				$(".entry").show();
				$(this).text("Save & Next");
			}
		}
		else
		{
			$('form').submit();
		}
	}
});
$(".back").click(function(){
	var ele = $(".showDiv:visible");
	if($(".showDiv:visible").closest(".showDiv").prev(".showDiv").index() == $(".showDiv:first").index())
		$(".back").hide();
        $(".entry").hide();	
	$(".showDiv:visible").closest(".showDiv").prev(".showDiv").show();
	ele.hide();
});
</script>
<script>
$(".calculation").keyup(function(){
	if($(this).val().trim().length != 0 ){
		if($(this).attr("id") == "CarpetArea"){
			$("#UDSLandArea").val($(this).val()/$("#Area").val());	
			//$("#CarpetArea").val($("#Area").val()/$("#UDSLandArea").val());
		}
		else if($(this).attr("id") == "UDSLandArea"){
			
				$("#CarpetArea").val($("#Area").val()/($(this).val()));	
              		
			}
			else if($(this).attr("id") == "Rate"){
			
				$("#BaseAmount").val(($("#Area").val())*($(this).val()));
              		
			}
			
			else{
			if($("#Area").val()==0){
				$("#UDSLandArea").val(0);
				$("#CarpetArea").val(0);
			}
			}
 }
});
$(".percent").keyup(function(){
 if($(this).val().trim().length != 0 && $("#AdvanceAmount").val() != 0){
		if($(this).attr("id") == "AdvanceAmount"){
			$("#AdvancePercent").val(($("#AdvanceAmount").val())/100);
		}
		else if($(this).attr("id") == "AdvanceAmount"){
			if($(this).val()==0){
				$("#AdvancePercent").val(0);
							}			
		}
		else{
			$("#AdvanceAmount").val(($("#AdvancePercent").val())*100);
		}
	}
});

$(".gross").keyup(function(){
	if($(this).val().trim().length != 0 ){
       if($(this).attr("id") == ("MarketLandValue")){
			var a = parseInt($("#BaseAmount").val()) + "<br>";
			var b = parseInt($("#MarketLandValue").val()) + "<br>";
			var n= parseInt(a) - parseInt(b);
			$("#ConstructionAmount").val(n);
        }
	}
});
$(".gross").keyup(function(){
	if($(this).val().trim().length != 0 ){
		if($(this).attr("id") == ("GuideLineValue")){
			$("#LandAmount").val($("#GuideLineValue").val()* $("#UDSLandArea").val());
        }
		else{
			$("#LandAmount").val($("#GuideLineValue").val()* $("#UDSLandArea").val());  
		}
	}
});
$(".gross").keyup(function(){
	if($(this).val().trim().length != 0 ){
		var a = parseInt($("#LandAmount").val()) + "<br>";
		var b = parseInt($("#ConstructionAmount").val()) + "<br>";
		var c= parseInt($("#OtherCost").val()) + "<br>";
		var n=parseInt(a) + parseInt(b) + parseInt(c);
		$("#GrossAmount").val(n);
	}
});
</script>
							