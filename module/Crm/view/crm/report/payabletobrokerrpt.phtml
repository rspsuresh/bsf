<style>
 #treeGrid tbody tr.mainTr td{
	text-align: center;
}
		/* Excel Floating Icon */
.fixed-action-btn          	    {position:fixed;top:85px;right:5px;padding-top:15px;margin-bottom:0;z-index:998;}
.fixed-action-btn:hover ul li a.btn-floating{transform: scaleY(1) scaleX(1) translateX(0px);opacity: 1;}
.btn-floating.btn-large         {width:45px;height:45px;}
.fixed-action-btn ul 			{left:-142px;right:0;text-align:center;position:absolute;margin:0;top:22px;}
.fixed-action-btn ul li 		{margin-left:8px;list-style-type:none;float:left;}
.fixed-action-btn ul li a.btn-floating {transform: scaleY(0.4) scaleX(0.4) translateX(40px);opacity: 0;}
.fixed-action-btn ul a.btn-floating i  {font-size: 17px;line-height: 37px;}
.btn-floating                   {display:inline-block;color:#fff;position:relative;overflow:hidden;z-index:1;width:37px;height:37px;line-height:37px;padding: 0;
                                 background-color: #26a69a;border-radius:50%;cursor:pointer;vertical-align: middle;
								 box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);text-decoration: none;transition: all .3s ease;
                                 -webkit-transition: all .3s ease; -moz-transition: all .3s ease; -o-transition: all .3s ease;}
.btn-floating i                 {width: inherit;display: inline-block;text-align: center;color: #fff;font-size:20px;line-height: 45px; font-weight:normal; color:#fff;}
.next-bt                        {text-align:center;}
.next-bt a:hover                {border:1px solid #3580C4 !important; background:#fff !important; color:#3580C4 !important;}
.next-bt a                      {background:#3580C4!important;border:1px solid #3580C4; border-radius: 4px;
                                 color:#fff!important; font-size:14px; padding: 5px 10px; text-align: center; transition: all 0.4s ease 0s;}
                      
/* Excel Floating Icon end*/
/*--------------Jqx Grid jqx All-------------------*/
#treeGrid									{min-height:200px !important;}
.jqx-widget .jqx-grid-columngroup-header	{border-top:0px !important;}
.jqx-widget .jqx-grid-columngroup-header > div	{ margin-top:7px !important;}
.jqx-dropdownlist-state-normal  			{margin:2px 4px !important;}
.jqx-grid-pager .jqx-dropdownlist-state-normal  			{margin-top: 0 !important;}
.jqx-widget-header							{border-bottom: 1px solid #5d9bb6 !important;border-top: 1px solid #ddd !important;}
.jqx-grid-pager-input						{margin-top: 2px !important; padding: 2px;text-align: center !important; width: 35px;}
.jqx-dropdownlist-state-normal				{display: block;  float: right;height: 16px;margin-right: 7px;margin-top: 0;  padding-bottom: 2px;padding-top: 2px; width: 40px;}
.jqx-button									{cursor: pointer;float: right;margin-right: 3px !important;margin-top: 0 !important;padding: 0 !important;width: 20px !important;}
.jqx-button > .jqx-icon-arrow-left,
.jqx-button >.jqx-icon-arrow-right			{height: 21px !important;margin-left: 0 !important;width: 20px !important;}
.jqx-listitem-element						{height: 25px !important;}
 .proname_btn .select2-container{ background-color:#efefef;color:#244996;}
 .proname_btn .select2-container .select2-selection--single .select2-selection__rendered{padding-top:0px; padding-bottom:5px;}
 .proname_btn .select2-container--default .select2-selection--single{font-size:26px; line-height:28px;}
</style>
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/library/jqwidgets/jqx-all.js"></script>
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/library/jqwidgets/jqxgrid.grouping.js"></script>
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/library/jqwidgets/jqxgrid.aggregates.js"></script>

<div class="content_wrapper  padlr0">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12">
				<div class="col-lg-12 padlr0">
					<h1 class="col-lg-6"><div class="btn-group proname_btn">
                            <select name="project_filter"  id="project_filter"  class="form-control single_dropdown" onchange="reportSearch($(this).val());" style="width:auto; min-width:260px !important;max-width:360px !important;">
                                <option <?php if(isset($reportId) && $reportId==1) { echo 'selected'; } ?> value="1">Project Wise Sales</option>
                                <option <?php if(isset($reportId) && $reportId==2) { echo 'selected'; } ?> value="2">Stage Wise Receivable Statement</option>
                                <option <?php if(isset($reportId) && $reportId==3) { echo 'selected'; } ?> value="3">Executive Analysis</option>
                                <option <?php if(isset($reportId) && $reportId==4) { echo 'selected'; } ?> value="4">Rent Receivable</option>
                                <option <?php if(isset($reportId) && $reportId==5) { echo 'selected'; } ?> value="5">Unit Transfer History</option>
                                <option <?php if(isset($reportId) && $reportId==6) { echo 'selected'; } ?> value="6">Receivable Statement</option>
                                <option <?php if(isset($reportId) && $reportId==7) { echo 'selected'; } ?> value="7">Ageing Report</option>
                                <option <?php if(isset($reportId) && $reportId==8) { echo 'selected'; } ?> value="8">Marketing Analysis</option>
                                <option <?php if(isset($reportId) && $reportId==9) { echo 'selected'; } ?> value="9">Maintenance Receivable</option>
                                <option <?php if(isset($reportId) && $reportId==10) { echo 'selected'; } ?> value="10">Unit Cancel History</option>
                                <option <?php if(isset($reportId) && $reportId==11) { echo 'selected'; } ?> value="11">Project Wise Receivable</option>
                                <option <?php if(isset($reportId) && $reportId==12) { echo 'selected'; } ?> value="12">Buyer Wise Receivable</option>
                                <option <?php if(isset($reportId) && $reportId==13) { echo 'selected'; } ?> value="13">Customer Info Report</option>
                                <option <?php if(isset($reportId) && $reportId==14) { echo 'selected'; } ?> value="14">Payable to Broker</option>
                                <option <?php if(isset($reportId) && $reportId==15) { echo 'selected'; } ?> value="15">Unit Block History</option>
                                <option <?php if(isset($reportId) && $reportId==16) { echo 'selected'; } ?> value="16">Project Status</option>
                                <option <?php if(isset($reportId) && $reportId==17) { echo 'selected'; } ?> value="17">Sales Team Performance</option>
                                <option <?php if(isset($reportId) && $reportId==18) { echo 'selected'; } ?> value="18">Customer Classification Report</option>
                                <option <?php if(isset($reportId) && $reportId==19) { echo 'selected'; } ?> value="19">Campaign Budget vs Expense</option>
                                <option <?php if(isset($reportId) && $reportId==20) { echo 'selected'; } ?> value="20">Unit PreBook History</option>
                                <option <?php if(isset($reportId) && $reportId==21) { echo 'selected'; } ?> value="21">Executive Wise Next Followup Analysis</option>
								<option <?php if(isset($reportId) && $reportId==22) { echo 'selected'; } ?> value="22">Cost Impact</option>

                            </select>
                        </div></h1>
					<div class="col-lg-6">
						<div class="fixed-action-btn active">
							<a class="btn-floating btn-large">
							<i class="fa fa-print"></i>
							</a>
							<ul>
							  <li>
								  <a class="btn-floating hide-input-file" id="print" href="javascript:void(0);" data-toggle="tooltip" data-placement="top" data-original-title="Print Report">
									  <i class="fa fa-print"></i>
									 
								  </a>
							  </li>
							  <li>
								  <a class="btn-floating" id="excelExport" href="javascript:void(0);" data-toggle="tooltip" data-placement="top" data-original-title="Download Excel">
									  <i class="fa fa-download"></i>
								  </a>
							  </li>
							  <li>
								  <a class="btn-floating" id="csvExport" href="javascript:void(0);" data-toggle="tooltip" data-placement="top" data-original-title="Export CSV">
									<i class="fa fa-file-archive-o"></i>
								  </a>
							  </li>
							</ul>
						</div>
					</div>				
                </div>
				<div class="col-lg-6 col-lg-offset-6 commargin_ttop_20 commargin_bottom">
                    <div class="col-lg-6 commargin_top">
					</div>
					<div class="col-lg-6 commargin_top">
					</div>
				</div>		
			</div>
            <div class="col-lg-12 clear">
                <div class="table-responsive clear">
					<div id="treeGrid">
					</div>
				</div>
             </div>
        </div>
    </div>
</div>
<!--<div class="col-lg-12 savebtn_area">
    <ul>
        <li class="float_r"><a href="#" class="ripple crmcmnbtn crmcmnbtn1 "  id="print"><i class="fa fa-print"></i> Print</a></li>
        <li class="float_r"><a href="#" class="crmcmnbtn crmcmnbtn2  ripple" id="excelExport">Export to Excel</a></li>
        <li class="float_r"><a href="#" class="crmcmnbtn crmcmnbtn3 ripple" id="csvExport">Export to CSV</a></li>
		<li class="float_r"><a href="#" class="crmcmnbtn crmcmnbtn4  ripple" id="htmlExport">Export to HTML</a></li>
    </ul>
</div>-->
<?php 
	echo $this->inlineScript()->appendFile($this->basePath('/js/warehouse.js'));
?>
<script type="text/javascript">
    function reportSearch(rId) {

        switch (parseInt($.trim(rId))) {
            case 1:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/projectwisesalesrpt");
                break;
            case 2:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/stagewisereceivablerpt/0/0");
                break;

            case 3:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/executiveanalysisrpt");
                break;
            case 4:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/rentreceivablerpt");
                break;
            case 5:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/unittransferhistory");
                break;
            case 6:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/receivablestatementrpt");
                break;
            case 7:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/ageingrpt");
                break;
            case 8:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/marketinganalysisrpt");
                break;
            case 9:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/maintenancereceivablerpt");
                break;
            case 10:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/unitcancelhistory");
                break;
            case 11:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/projectwisereceivablerpt");
                break;
            case 12:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/buyerwisereceivablerpt");
                break;
            case 13:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/customerinforpt");
                break;
            case 14:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/payabletobrokerrpt");
                break;
            case 15:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/block-history");
                break;
            case 16:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/projectstatus");
                break;
            case 17:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/salesteamperformancerpt");
                break;
            case 18:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/customerclasificationrpt");
                break;
            case 19:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/campaignbudgetvsexpenserpt");
                break;
            case 20:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/prebook-history");
                break;
            case 21:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/executive-next-followup");
                break;
            default :
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/reportlist");
                break;
        }

    }

    var arr_Lists = <?php echo (isset($arrUnitLists)) ? json_encode($arrUnitLists) : '[]';?>;
	// prepare the data
	if(arr_Lists == "[]"){
		$("#treeGrid").jqxTreeGrid('clear');
	} else {
		var source =
		{
			dataType: "json",  //"json",
			dataFields: [
				{ name: "Id", type: "number" },
				{ name: "Description", type: "string" },		
				{ name: "ParentId", type: "number" },
				{ name: "Amount", type: "number" },
				{ name: "PaidAmount", type: "number" },
				{ name: "DueAmount", type: "number" },
				{ name: "expanded", type: "bool" }
			],
			hierarchy:
			{
				keyDataField: { name: 'Id' },
				parentDataField: { name: 'ParentId' }
			},
			id: 'Id',
			localData: arr_Lists
		 };
		var dataAdapter = new $.jqx.dataAdapter(source, {
			loadComplete: function () {
				// data is loaded.
			}
		});

		$("#treeGrid").jqxTreeGrid({
			width: "100%",
			source: dataAdapter, 
			pageable: true,
			pagerMode: 'advanced',
    		pagerHeight: 40,
			filterable: true,
			editable: false,
			showAggregates: true,
			aggregatesHeight: 35,
			altRows: true,
			ready: function()
			{
				$("#treeGrid").jqxTreeGrid('hideColumn', 'Id');
				$("#treeGrid").jqxTreeGrid('hideColumn', 'ParentId');
			},
			toolbarHeight: 35,
			columns: [
				{ text: 'Description', dataField: "Description", align: 'left', cellsAlign: 'left' , width: '40%' },
				{ text: 'Id', dataField: "Id", align: 'right', cellsAlign: 'right' , cellsFormat: 'd', hidden:true, filterable: false },
				{ text: 'ParentId', dataField: "ParentId", align: 'right', cellsAlign: 'right' , cellsFormat: 'd', hidden:true, filterable: false },	
				{ text: 'Payable', dataField: "Amount", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', width: '20%', aggregates: ['sum'],
					aggregatesRenderer: function (aggregatesText, column, element, aggregates, type) {
						if (type == "aggregates") {
							var renderString = "<div style='margin: 8px; float: right;  height: 100%;'>";
						} else {
							var renderString = "<div style='float: right;  height: 100%;'>";
						}
						//var euro = dataAdapter.formatNumber(0.74 * aggregates.Total, "f2");;
						var usd = 0;						
						if(aggregates != null){
							usd = dataAdapter.formatNumber(aggregates.sum, "f2");
						}
						renderString += "<table><tr><td rowspan='2'></td><td align='right'><strong>" + usd + "</strong></td></table>";
						return renderString;
					}
				},
				{ text: 'Paid', dataField: "PaidAmount", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', width: '20%', aggregates: ['sum'],
					aggregatesRenderer: function (aggregatesText, column, element, aggregates, type) {
						if (type == "aggregates") {
							var renderString = "<div style='margin: 8px; float: right;  height: 100%;'>";
						} else {
							var renderString = "<div style='float: right;  height: 100%;'>";
						}
						//var euro = dataAdapter.formatNumber(0.74 * aggregates.Total, "f2");;
						var usd = 0;
						if(aggregates != null){
							usd = dataAdapter.formatNumber(aggregates.sum, "f2");
						}
						renderString += "<table><tr><td rowspan='2'></td><td align='right'><strong>" + usd + "</strong></td></table>";
						return renderString;
					}
				},
				{ text: 'Balance Due', dataField: "DueAmount", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', width: '20%', aggregates: ['sum'],
					aggregatesRenderer: function (aggregatesText, column, element, aggregates, type) {
						  if (type == "aggregates") {
							  var renderString = "<div style='margin: 8px; float: right;  height: 100%;'>";
						  } else {
							  var renderString = "<div style='float: right;  height: 100%;'>";
						  }
						  //var euro = dataAdapter.formatNumber(0.74 * aggregates.Total, "f2");;
							var usd = 0;
							if(aggregates != null){
								usd = dataAdapter.formatNumber(aggregates.sum, "f2");
							}
						  renderString += "<table><tr><td rowspan='2'></td><td align='right'><strong>" + usd + "</strong></td></table>";
						  return renderString;
					}
				}			  
			]
		});
	}  
	//Print option
	$("#excelExport").click(function () {
		$("#treeGrid").jqxTreeGrid('exportData', 'xls');
	});
	$("#csvExport").click(function () {
		$("#treeGrid").jqxTreeGrid('exportData', 'csv');
	});
	$("#htmlExport").click(function () {
		$("#treeGrid").jqxTreeGrid('exportData', 'html');
	});

	$("#print").click(function () {
		$("#treeGrid").jqxTreeGrid('exportData', 'html');
	});
	//bindJqxGridAutoResize();
	
</script>