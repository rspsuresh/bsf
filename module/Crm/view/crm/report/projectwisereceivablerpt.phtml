<script type="text/javascript" src="<?php echo $this->basePath(); ?>/library/amcharts/amcharts.js"></script>
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/library/amcharts/pie.js"></script>
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/library/amcharts/serial.js"></script>
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/library/amcharts/funnel.js"></script>
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/library/amcharts/themes/light.js"></script>
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/library/amcharts/themes/dark.js"></script>
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/library/Highcharts-4.2.3/js/highcharts.js"></script>
<script type="text/javascript" src="<?php echo $this->basepath(); ?>/library/Highcharts-4.2.3/js/modules/exporting.js"></script>
<script type="text/javascript" src="<?php echo $this->basepath(); ?>/library/Highcharts-4.2.3/js/modules/data.js"></script>
<style type="text/css">
 #dataTable tbody tr.mainTr td{
	text-align: center;
}
#treeGrid_chart		{min-width: 310px; height: 400px; margin: 0 auto;}
    #total_cost_chartdiv {
        width		: 100%;
        height		: 350px;
        font-size	: 11px;
    }
/*--------------Jqx Grid jqx All-------------------*/
#treeGrid									{min-height:200px !important;}
.jqx-widget .jqx-grid-columngroup-header	{border-top:0px !important;}
.jqx-widget .jqx-grid-columngroup-header > div	{ margin-top:7px !important;}
.jqx-dropdownlist-state-normal  			{margin:2px 4px !important;}
.jqx-grid-pager .jqx-dropdownlist-state-normal  			{margin-top: 0 !important;}
.jqx-widget-header							{border-bottom: 1px solid #5d9bb6 !important;border-top: 1px solid #ddd !important;}
.jqx-grid-pager-input						{margin-top:2px !important; padding: 2px;text-align: center !important; width: 35px;}
.jqx-dropdownlist-state-normal				{display: block;  float: right;height: 16px;margin-right: 7px;margin-top: 0;  padding-bottom: 2px;padding-top: 2px; width: 40px;}
.jqx-button									{cursor: pointer;float: right;margin-right: 3px !important;margin-top: 0 !important;padding: 0 !important;width: 20px !important;}
.jqx-button > .jqx-icon-arrow-left,
.jqx-button >.jqx-icon-arrow-right			{height: 21px !important;margin-left: 0 !important;width: 20px !important;}
.jqx-listitem-element						{height: 25px !important;}
 .proname_btn .select2-container{ background-color:#efefef;color:#244996;}
 .proname_btn .select2-container .select2-selection--single .select2-selection__rendered{padding-top:0px; padding-bottom:5px;}
 .proname_btn .select2-container--default .select2-selection--single{font-size:26px; line-height:28px;}
</style>
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/library/jqwidgets/jqx-all.js"></script>
<div class="content_wrapper  padlr0">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12">
				<div class="col-lg-12 padlr0">
					<h1 class="col-lg-6 col-md-6 col-sm-6 padlr0"><div class="btn-group proname_btn">
                            <select name="project_filter"  id="project_filter"  class="form-control single_dropdown" onchange="reportSearch($(this).val());" style="width:auto; min-width:340px !important;max-width:360px !important;">
                                <option <?php if(isset($reportId) && $reportId==1) { echo 'selected'; } ?> value="1">Project Wise Sales</option>
                                <option <?php if(isset($reportId) && $reportId==2) { echo 'selected'; } ?> value="2">Stage Wise Receivable Statement</option>
                                <option <?php if(isset($reportId) && $reportId==3) { echo 'selected'; } ?> value="3">Executive Analysis</option>
                                <option <?php if(isset($reportId) && $reportId==4) { echo 'selected'; } ?> value="4">Rent Receivable</option>
                                <option <?php if(isset($reportId) && $reportId==5) { echo 'selected'; } ?> value="5">Unit Transfer History</option>
                                <option <?php if(isset($reportId) && $reportId==6) { echo 'selected'; } ?> value="6">Receivable Statement</option>
                                <option <?php if(isset($reportId) && $reportId==7) { echo 'selected'; } ?> value="7">Ageing Report</option>
                                <option <?php if(isset($reportId) && $reportId==8) { echo 'selected'; } ?> value="8">Marketing Analysis</option>
                                <option <?php if(isset($reportId) && $reportId==9) { echo 'selected'; } ?> value="9">Maintenance Receivable</option>
                                <option <?php if(isset($reportId) && $reportId==10) { echo 'selected'; } ?> value="10">Unit Cancel History</option>
                                <option <?php if(isset($reportId) && $reportId==11) { echo 'selected'; } ?> value="11">Project Wise Receivable</option>
                                <option <?php if(isset($reportId) && $reportId==12) { echo 'selected'; } ?> value="12">Buyer Wise Receivable</option>
                                <option <?php if(isset($reportId) && $reportId==13) { echo 'selected'; } ?> value="13">Customer Info Report</option>
                                <option <?php if(isset($reportId) && $reportId==14) { echo 'selected'; } ?> value="14">Payable to Broker</option>
                                <option <?php if(isset($reportId) && $reportId==15) { echo 'selected'; } ?> value="15">Unit Block History</option>
                                <option <?php if(isset($reportId) && $reportId==16) { echo 'selected'; } ?> value="16">Project Status</option>
                                <option <?php if(isset($reportId) && $reportId==17) { echo 'selected'; } ?> value="17">Sales Team Performance</option>
                                <option <?php if(isset($reportId) && $reportId==18) { echo 'selected'; } ?> value="18">Customer Classification Report</option>
                                <option <?php if(isset($reportId) && $reportId==19) { echo 'selected'; } ?> value="19">Campaign Budget vs Expense</option>
                                <option <?php if(isset($reportId) && $reportId==20) { echo 'selected'; } ?> value="20">Unit PreBook History</option>
                                <option <?php if(isset($reportId) && $reportId==21) { echo 'selected'; } ?> value="21">Executive Wise Next Followup Analysis</option>
								<option <?php if(isset($reportId) && $reportId==22) { echo 'selected'; } ?> value="22">Cost Impact</option>		
								
                            </select>
                        </div></h1>
					<div class="col-lg-6 col-md-6 col-sm-6">
						<ul>
							<li class="float_r" style="padding: 0px 5px;"><a href="javascript:void(0);" class="ripple"  id="print" data-original-title="ExportPrint" data-placement="left" data-toggle="tooltip"><img src="<?php echo $this->basePath(); ?>/images/icons-394.png" /></a></li>
							<li class="float_r" style="padding: 0px 5px;"><a href="javascript:void(0);" class="ripple" id="excelExport" data-original-title="ExportExcel" data-placement="left" data-toggle="tooltip"><img src="<?php echo $this->basePath(); ?>/images/icons-393.png" /></a></li>
							<li class="float_r" style="padding: 0px 5px;"><a href="javascript:void(0);" class="ripple" id="csvExport" data-original-title="ExportCSV" data-placement="left" data-toggle="tooltip"><img src="<?php echo $this->basePath(); ?>/images/icons-392.png" /></a></li>
							<!--<li class="float_r"><a href="#" class="crmcmnbtn crmcmnbtn4  ripple" id="htmlExport">Export to HTML</a></li>-->
						</ul>
					</div>
                </div>
				<div class="col-lg-6 col-lg-offset-6 col-md-8 col-md-offset-4 col-sm-8 col-sm-offset-4 clear commargin_ttop_20 commargin_bottom">
					<div class="col-lg-6 col-lg-push-6 col-md-6 col-md-push-6 col-sm-6 col-sm-push-6 commargin_top">
						<span class="date_icon"><i class="fa fa-calendar"></i></span>
						<input type="text" name="asonDate" id="asonDate" class="form-control date_picker lbl_move" readonly="readonly" label="As on Date" onchange="PopulateData(this.value)"  value="<?php echo Date('d-m-Y'); ?>" />					
					</div>
				</div>		
			</div>
            <div class="col-lg-12 clear">
                <div class="table-responsive clear">
					<div id="treeGrid">
					</div>
				</div>
             </div>
             <div class="col-lg-12 clear m_tb40">
                <section class="pnnal">
                    <header class="pnnal-heading"><i class="fa fa-bar-chart"></i><span id="charttitle"> Project Wise Receivable</span></header>
                    <div class="pnnal-body">
                        <div id="total_cost_chartdiv"></div>
                    </div>
                </section>
            </div>
        </div>
    </div>
</div>
<!--<div class="col-lg-12 savebtn_area">
    <ul>
        <li class="float_r"><a href="#" class="ripple crmcmnbtn crmcmnbtn1 "  id="print"><i class="fa fa-print"></i> Print</a></li>
        <li class="float_r"><a href="#" class="crmcmnbtn crmcmnbtn2  ripple" id="excelExport">Export to Excel</a></li>
        <li class="float_r"><a href="#" class="crmcmnbtn crmcmnbtn3 ripple" id="csvExport">Export to CSV</a></li>
		<li class="float_r"><a href="#" class="crmcmnbtn crmcmnbtn4  ripple" id="htmlExport">Export to HTML</a></li>
    </ul>
</div>-->
<?php 
	echo $this->inlineScript()->appendFile($this->basePath('/js/warehouse.js'));
?>
<script type="text/javascript">
    function reportSearch(rId) {

        switch (parseInt($.trim(rId))) {
            case 1:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/projectwisesalesrpt");
                break;
            case 2:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/stagewisereceivablerpt/0/0");
                break;

            case 3:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/executiveanalysisrpt");
                break;
            case 4:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/rentreceivablerpt");
                break;
            case 5:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/unittransferhistory");
                break;
            case 6:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/receivablestatementrpt");
                break;
            case 7:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/ageingrpt");
                break;
            case 8:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/marketinganalysisrpt");
                break;
            case 9:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/maintenancereceivablerpt");
                break;
            case 10:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/unitcancelhistory");
                break;
            case 11:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/projectwisereceivablerpt");
                break;
            case 12:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/buyerwisereceivablerpt");
                break;
            case 13:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/customerinforpt");
                break;
            case 14:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/payabletobrokerrpt");
                break;
            case 15:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/block-history");
                break;
            case 16:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/projectstatus");
                break;
            case 17:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/salesteamperformancerpt");
                break;
            case 18:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/customerclasificationrpt");
                break;
            case 19:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/campaignbudgetvsexpenserpt");
                break;
            case 20:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/prebook-history");
                break;
            case 21:
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/executive-next-followup");
                break;
            default :
                $(location).attr('href',"<?php echo $this->basePath(); ?>/crm/report/reportlist");
                break;
        }

    }
	var arr_Lists = <?php echo (isset($arrUnitLists)) ? json_encode($arrUnitLists) : '[]';?>;
    var chart = null;
	// prepare the data
	if(arr_Lists == "[]"){
		$("#treeGrid").jqxTreeGrid('clear');
	} else {
		var source =
		{
			dataType: "json",  //"json",
			dataFields: [
				{ name: "Id", type: "number" },
				{ name: "Description", type: "string" },		
				{ name: "ParentId", type: "number" },
				{ name: "ProjectId", type: "number" },
				{ name: "BlockId", type: "number" },
				{ name: "FloorId", type: "number" },
				{ name: "UnittypeId", type: "number" },
				{ name: "UnitId", type: "number" },
				{ name: "Amount", type: "number" },
				{ name: "RecvAmount", type: "number" },
				{ name: "RecdAmount", type: "number" },
				{ name: "Due", type: "number" },
				{ name: "Total", type: "number" },
				{ name: "ReceivablePer", type: "number" },
				{ name: "Receivable", type: "number" },
				{ name: "expanded", type: "bool" }
			],
			hierarchy:
			{
				keyDataField: { name: 'Id' },
				parentDataField: { name: 'ParentId' }
			},
			id: 'Id',
			localData: arr_Lists
		 };
		var dataAdapter = new $.jqx.dataAdapter(source, {
			loadComplete: function () {
				// data is loaded.
			}
		});

		$("#treeGrid").jqxTreeGrid({
			width: "100%",
			source: dataAdapter, 
			pageable: true,
			pagerMode: 'advanced',
    		pagerHeight: 40,
			filterable: true,
			columnsResize: true,
			editable: false,
			showAggregates: true,
			aggregatesHeight: 35,
			altRows: true,
			ready: function()
			{
				$("#treeGrid").jqxTreeGrid('hideColumn', 'Id');
				$("#treeGrid").jqxTreeGrid('hideColumn', 'ParentId');
			},
			toolbarHeight: 35,
			columns: [
				{ text: 'Description', dataField: "Description", align: 'center', width: '20%',pinned:true },
				{ text: 'Id', dataField: "Id", align: 'right', cellsAlign: 'right' , cellsFormat: 'd', hidden:true, filterable: false },
				{ text: 'ProjectId', dataField: "ProjectId", align: 'right', cellsAlign: 'right' , cellsFormat: 'd', hidden:true, filterable: false },
				{ text: 'BlockId', dataField: "BlockId", align: 'right', cellsAlign: 'right' , cellsFormat: 'd', hidden:true, filterable: false },
				{ text: 'FloorId', dataField: "FloorId", align: 'right', cellsAlign: 'right' , cellsFormat: 'd', hidden:true, filterable: false },
				{ text: 'UnittypeId', dataField: "UnittypeId", align: 'right', cellsAlign: 'right' , cellsFormat: 'd', hidden:true, filterable: false },
				{ text: 'UnitId', dataField: "UnitId", align: 'right', cellsAlign: 'right' , cellsFormat: 'd', hidden:true, filterable: false },
				{ text: 'ParentId', dataField: "ParentId", align: 'right', cellsAlign: 'right' , cellsFormat: 'd', hidden:true, filterable: false },	
				{ text: 'Net Amount', dataField: "Amount", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', width: '14%', aggregates: ['sum'],
					aggregatesRenderer: function (aggregatesText, column, element, aggregates, type) {
						if (type == "aggregates") {
							var renderString = "<div style='margin: 8px; float: right;  height: 100%;'>";
						} else {
							var renderString = "<div style='float: right;  height: 100%;'>";
						}
						//var euro = dataAdapter.formatNumber(0.74 * aggregates.Total, "f2");;
						var usd = 0;						
						if(aggregates != null){
							usd = dataAdapter.formatNumber(aggregates.sum, "f2");
						}
						renderString += "<table><tr><td rowspan='2'></td><td align='right'><strong>" + usd + "</strong></td></table>";
						return renderString;
					}
				},
				{ text: 'Billed', dataField: "RecvAmount", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', width: '11%', aggregates: ['sum'],
					aggregatesRenderer: function (aggregatesText, column, element, aggregates, type) {
						if (type == "aggregates") {
							var renderString = "<div style='margin: 8px; float: right;  height: 100%;'>";
						} else {
							var renderString = "<div style='float: right;  height: 100%;'>";
						}
						//var euro = dataAdapter.formatNumber(0.74 * aggregates.Total, "f2");;
						var usd = 0;
						if(aggregates != null){
							usd = dataAdapter.formatNumber(aggregates.sum, "f2");
						}
						renderString += "<table><tr><td rowspan='2'></td><td align='right'><strong>" + usd + "</strong></td></table>";
						return renderString;
					}
				},
				{ text: 'Received', dataField: "RecdAmount", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', width: '11%', aggregates: ['sum'],
					aggregatesRenderer: function (aggregatesText, column, element, aggregates, type) {
						  if (type == "aggregates") {
							  var renderString = "<div style='margin: 8px; float: right;  height: 100%;'>";
						  } else {
							  var renderString = "<div style='float: right;  height: 100%;'>";
						  }
						  //var euro = dataAdapter.formatNumber(0.74 * aggregates.Total, "f2");;
							var usd = 0;
							if(aggregates != null){
								usd = dataAdapter.formatNumber(aggregates.sum, "f2");
							}
						  renderString += "<table><tr><td rowspan='2'></td><td align='right'><strong>" + usd + "</strong></td></table>";
						  return renderString;
					}
				},			
				{ text: 'Due As On', dataField: "Due", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', width: '11%', aggregates: ['sum'],
					aggregatesRenderer: function (aggregatesText, column, element, aggregates, type) {
						  if (type == "aggregates") {
							  var renderString = "<div style='margin: 8px; float: right;  height: 100%;'>";
						  } else {
							  var renderString = "<div style='float: right;  height: 100%;'>";
						  }
						  //var euro = dataAdapter.formatNumber(0.74 * aggregates.Total, "f2");;
							var usd = 0;
							if(aggregates != null){
								usd = dataAdapter.formatNumber(aggregates.sum, "f2");
							}
						  renderString += "<table><tr><td rowspan='2'></td><td align='right'><strong>" + usd + "</strong></td></table>";
						  return renderString;
					} 
				},
				{ text: 'Total Receivable', dataField: "Total", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', width: '11%', aggregates: ['sum'],
					aggregatesRenderer: function (aggregatesText, column, element, aggregates, type) {
						  if (type == "aggregates") {
							  var renderString = "<div style='margin: 8px; float: right;  height: 100%;'>";
						  } else {
							  var renderString = "<div style='float: right;  height: 100%;'>";
						  }
						  //var euro = dataAdapter.formatNumber(0.74 * aggregates.Total, "f2");;
							var usd = 0;
							if(aggregates != null){
								usd = dataAdapter.formatNumber(aggregates.sum, "f2");
							}
						  renderString += "<table><tr><td rowspan='2'></td><td align='right'><strong>" + usd + "</strong></td></table>";
						  return renderString;
					} 
				},
				{ text: 'Received %', dataField: "ReceivablePer", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', width: '11%'},	
				{ text: 'Receivable %', dataField: "Receivable", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', width: '11%'}	
			]
		});
	}  
	//Print option
	$("#excelExport").click(function () {
		$("#treeGrid").jqxTreeGrid('exportData', 'xls');
	});
	$("#csvExport").click(function () {
		$("#treeGrid").jqxTreeGrid('exportData', 'csv');
	});
	$("#htmlExport").click(function () {
		$("#treeGrid").jqxTreeGrid('exportData', 'html');
	});
	
	$("#print").click(function () {
		$("#treeGrid").jqxTreeGrid('exportData', 'html');
	});
	
	$('#treeGrid').on('rowClick', function (event) {
		// event args.
		var args = event.args;
		// row data.
		var row = args.row;
		// row key.
		var key = args.key;
		// data field
		var dataField = args.dataField;
		// original click event.
		var clickEvent = args.originalEvent;
		
		var Id=row.Id;
		var levelId=row.level;
		var value1 =$("#asonDate").val();
		var projectId=row.ProjectId;
		var blockId=row.BlockId;
		var description=row.Description;
		var floorId=row.FloorId;
		var unittypeId=row.UnittypeId;
		var unitId=row.UnitId;
		//console.log(projectId + " --" + blockId + " --" + floorId + " --" + unittypeId + " --" + unitId + "--"+ levelId);	
		bindLoadGraph(value1, projectId, blockId, floorId, unittypeId, unitId, levelId, description);
		
	});
	//bindJqxGridAutoResize();
	
	function PopulateData(value) {
		//console.log(value);
		bindLoadGrid(value);
	}
	function bindLoadGraph(value, projectId, blockId, floorId, unittypeId, unitId, level, description) {
		var rtype1="";
		var headerText="";
		if(level == 0){
			rtype1="getBlock";
			headerText ="Block detail in - " + description;
		} else if(level == 1) {
			rtype1="getFloor";
			headerText ="Floor detail in - "  + description;
		} else if(level == 2) {
			rtype1="getUnitType";
			headerText ="UnitType detail in - "  + description;
		} else if(level == 3) {
			rtype1="getUnit";
			headerText ="Unit detail in - "  + description;
		} else if(level == 4) {
			return;
		}

		$.ajax({
			url: getBaseURL() + "crm/report/projectwisereceivablerpt",
			data: {rtype: rtype1, data: value, projectId: projectId, blockId: blockId, floorId: floorId, unittypeId: unittypeId, unitId: unitId, csrf: "<?php echo (isset($csrf)) ? $csrf : '' ?>"},
			async: false,
			type: 'post',
			success: function(data,status, xhr) {
                data = JSON.parse(data);
                if(chart != null) {
                    chart.dataProvider = data;
                    chart.validateData();
					console.log(headerText);
					$("#charttitle").text(headerText);
                }
			}
		});
	}
	
	function bindLoadGrid(value) {
		$.ajax({
			url: getBaseURL() + "crm/report/projectwisereceivablerpt",
			data: {rtype:'getLoad', data: value, csrf: "<?php echo isset($csrf)?$csrf:''; ?>"},
			async: false,
			type: 'post',
			success: function(data,status, xhr) {
			
				if(data == "[]"){
					$("#treeGrid").jqxTreeGrid('clear');
				} else {
					var source =
					{
						dataType: "json",
						dataFields: [
							{ name: "Id", type: "number" },
							{ name: "Description", type: "string" },		
							{ name: "ParentId", type: "number" },
							{ name: "ProjectId", type: "number" },
							{ name: "BlockId", type: "number" },
							{ name: "FloorId", type: "number" },
							{ name: "UnittypeId", type: "number" },
							{ name: "UnitId", type: "number" },
							{ name: "Amount", type: "number" },
							{ name: "RecvAmount", type: "number" },
							{ name: "RecdAmount", type: "number" },
							{ name: "Due", type: "number" },
							{ name: "Total", type: "number" },
							{ name: "ReceivablePer", type: "number" },	
							{ name: "Receivable", type: "number" },
							{ name: "expanded", type: "bool" }
						],
						hierarchy:
						{
							keyDataField: { name: 'Id' },
							parentDataField: { name: 'ParentId' }
						},
						id: 'Id',
						localData: data
					 };

					var dataAdapter = new $.jqx.dataAdapter(source, {
						loadComplete: function () {
							// data is loaded.
						}
					});

					$("#treeGrid").jqxTreeGrid({
						width: '100%',
						source: dataAdapter, 
						pageable: true,
						editable: false,
						altRows: true,
						ready: function()
						{
							// called when the DatatreeGrid is loaded.
							$("#treeGrid").jqxTreeGrid('hideColumn', 'Id');
							$("#treeGrid").jqxTreeGrid('hideColumn', 'ParentId');
						},
						pagerButtonsCount: 8,
						toolbarHeight: 35,
						columns: [
							{ text: 'Description', dataField: "Description", align: 'center', width: '40%',pinned:true },
							{ text: 'Id', dataField: "Id", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', hidden:true, filterable: false },
							{ text: 'ProjectId', dataField: "ProjectId", align: 'right', cellsAlign: 'right' , cellsFormat: 'd', hidden:true, filterable: false },
							{ text: 'BlockId', dataField: "BlockId", align: 'right', cellsAlign: 'right' , cellsFormat: 'd', hidden:true, filterable: false },
							{ text: 'FloorId', dataField: "FloorId", align: 'right', cellsAlign: 'right' , cellsFormat: 'd', hidden:true, filterable: false },
							{ text: 'UnittypeId', dataField: "UnittypeId", align: 'right', cellsAlign: 'right' , cellsFormat: 'd', hidden:true, filterable: false },
							{ text: 'UnitId', dataField: "UnitId", align: 'right', cellsAlign: 'right' , cellsFormat: 'd', hidden:true, filterable: false },
							{ text: 'ParentId', dataField: "ParentId", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', hidden:true, filterable: false },
							{ text: 'Net Amount', dataField: "Amount", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', width: '12%', aggregates: ['sum'],
								aggregatesRenderer: function (aggregatesText, column, element, aggregates, type) {
									if (type == "aggregates") {
										var renderString = "<div style='margin: 4px; float: right;  height: 100%;'>";
									} else {
										var renderString = "<div style='float: right;  height: 100%;'>";
									}
									//var euro = dataAdapter.formatNumber(0.74 * aggregates.Total, "f2");;
									var usd = 0;
									if(aggregates != null){
										usd = dataAdapter.formatNumber(aggregates.sum, "f2");
									}
									renderString += "<table><tr><td rowspan='2'><strong>Tot:</strong></td><td align='right'>" + usd + "</td></table>";
									return renderString;
								}
							},
							{ text: 'Receivable As On', dataField: "RecvAmount", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', width: '12%', aggregates: ['sum'],
								aggregatesRenderer: function (aggregatesText, column, element, aggregates, type) {
									if (type == "aggregates") {
										var renderString = "<div style='margin: 4px; float: right;  height: 100%;'>";
									} else {
										var renderString = "<div style='float: right;  height: 100%;'>";
									}
									//var euro = dataAdapter.formatNumber(0.74 * aggregates.Total, "f2");;
									var usd = dataAdapter.formatNumber(aggregates.sum, "f2");;
									renderString += "<table><tr><td rowspan='2'><strong>Tot:</strong></td><td align='right'>" + usd + "</td></table>";
									return renderString;
								}
							},
							{ text: 'Received', dataField: "RecdAmount", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', width: '12%', aggregates: ['sum'],
								aggregatesRenderer: function (aggregatesText, column, element, aggregates, type) {
									  if (type == "aggregates") {
										  var renderString = "<div style='margin: 4px; float: right;  height: 100%;'>";
									  } else {
										  var renderString = "<div style='float: right;  height: 100%;'>";
									  }
										var usd = 0;
										if(aggregates != null){
											usd = dataAdapter.formatNumber(aggregates.sum, "f2");
										}
									  renderString += "<table><tr><td rowspan='2'><strong>Tot:</strong></td><td align='right'>" + usd + "</td></table>";
									  return renderString;
								}
							},			
							{ text: 'Due As On', dataField: "Due", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', width: '12%', aggregates: ['sum'],
								aggregatesRenderer: function (aggregatesText, column, element, aggregates, type) {
									  if (type == "aggregates") {
										  var renderString = "<div style='margin: 4px; float: right;  height: 100%;'>";
									  } else {
										  var renderString = "<div style='float: right;  height: 100%;'>";
									  }
									  //var euro = dataAdapter.formatNumber(0.74 * aggregates.Total, "f2");;
									  var usd = 0;
										if(aggregates != null){
											usd = dataAdapter.formatNumber(aggregates.sum, "f2");
										}
									  renderString += "<table><tr><td rowspan='2'><strong>Tot:</strong></td><td align='right'>" + usd + "</td></table>";
									  return renderString;
								} 
							},
							{ text: 'Total Receivable', dataField: "Total", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', width: '12%', aggregates: ['sum'],
								aggregatesRenderer: function (aggregatesText, column, element, aggregates, type) {
									  if (type == "aggregates") {
										  var renderString = "<div style='margin: 4px; float: right;  height: 100%;'>";
									  } else {
										  var renderString = "<div style='float: right;  height: 100%;'>";
									  }
									  var usd = 0;
										if(aggregates != null){
											usd = dataAdapter.formatNumber(aggregates.sum, "f2");
										}
									  renderString += "<table><tr><td rowspan='2'><strong>Tot:</strong></td><td align='right'>" + usd + "</td></table>";
									  return renderString;
								} 
							},
							{ text: 'Received %', dataField: "ReceivablePer", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', width: '10%'},
							{ text: 'Receivable %', dataField: "Receivable", align: 'right', cellsAlign: 'right' , cellsFormat: 'd2', width: '10%'}
						]
					});
				}
			}
		});
	}
	
	chart = AmCharts.makeChart("total_cost_chartdiv", {
            "theme": "light",
            "type": "serial",
            "startDuration": 1,
            "dataProvider": <?php echo (isset($arrUnitLists1)) ? json_encode($arrUnitLists1) : '[]';?>,
            "valueAxes": [{
                "position": "left",
                "title": "Amount"
            }],
            "graphs": [{
                "balloonText": "Billed [[category]]: <b>[[value]]</b>",
                "fillColorsField": "color",
                "fillAlphas": 1,
                "lineAlpha": 0.1,
                "type": "column",
                "valueField": "Billed"
            },{
                "balloonText": "Received [[category]]: <b>[[value]]</b>",
                "fillColorsField": "color",
                "fillAlphas": 1,
                "lineAlpha": 0.1,
                "type": "column",
                "valueField": "Received"
            }],
            "plotAreaFillAlphas": 0.1,
			"depth3D": 60,
			"angle": 30,
            "chartCursor": {
                "categoryBalloonEnabled": false,
                "cursorAlpha": 0,
                "zoomable": true
            },
            "categoryField": "Description",
            "categoryAxis": {
                "gridPosition": "start",
                "labelRotation": 90
            },
            "export": {
                "enabled": true
            },
            "mouseWheelZoomEnabled": true

        });
	
</script>