<link rel="stylesheet" href="<?php echo $this->basePath() . '/css/mms.css'; ?>" />
	
<style type="text/css">
	.mar_20{margin-top:20px!important;}
	.jqx-widget-content {z-index:999 !important;}
	.highlight{background-color: #bfefd6;}
    .highlight1{background-color: #efe7ad;}
    .highlight2{background-color: #efd2b9;}
    .highlight3{background-color:  #e6bfcb;}
    .table-responsive table.table tr td { padding: 10px !important;}
	.card {margin-bottom: 0px!important; margin-top: 0px !important;}
	.top-10 {padding-top: 10px !important;}
	.blubg{background : #B0C3EB !important;}
	.subDiv {background-color: #fff !important;border: 0px solid #ddd !important;margin-top:8px !important;}
	.sub_tab {background-color: #e7e9ec;border: 1px solid #ddd;float: left;margin-top: 2px;margin-bottom: 10px;padding: 8px;width: 100%;}
	.tab_pane{padding:0px 0px!important;}
	.btnPrev:disabled {background-color:#ffffff;}
	.sub_tbl3{color: #424141;font-weight: 600; background: #ceefe5 !important;border-bottom: 2px solid #18abc4 !important;border-top: 1px solid #ddd !important;white-space: nowrap;}
</style>

<div class="container-fluid">
	<div class="row">
		<div class="col-lg-12 mar_20">
			<h1 style="margin-left:10px;">MinConversion Detail</h1> 
		</div>
		<div class="col-lg-12">
			<div class="col-lg-12 col-lg-offset-0 col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0 clear padlr0">
				<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres" id="CostCentreName">
					<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status3">
						<div class="padding-none">
							<div class="row">
								<div class="col-xs-3">
									<i class="fa fa-bandcamp fa-5x cbpln-status-icon"></i>
								</div>
								<div class="col-xs-9 text-right">
									<div class="cbhuge comnelips fntwt600"><?php echo $CostCentreName; ?></div>
									<div class="cbhuge comnelips">CostCentre Name</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres" id="SupplierName">
					<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status4">
						<div class="padding-none">
							<div class="row">
								<div class="col-xs-3">
									<i class="fa fa-certificate fa-5x cbpln-status-icon"></i>
								</div>
								<div class="col-xs-9 text-right">
									<div class="cbhuge comnelips fntwt600"><?php echo $SupplierName; ?></div>
									<div class="cbhuge comnelips">Vendor Name</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres" id="PurchaseTypeName">
					<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status1">
						<div class="padding-none">
							<div class="row">
								<div class="col-xs-3">
									<i class="fa fa-retweet fa-5x cbpln-status-icon"></i>
								</div>
								<div class="col-xs-9 text-right">
									<div class="cbhuge comnelips fntwt600"><?php echo $PurchaseTypeName; ?></div>
									<div class="cbhuge comnelips">Purchase Type</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres" id="PurchaseAccount">
					<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status1">
						<div class="padding-none">
							<div class="row">
								<div class="col-xs-3">
									<i class="fa fa-retweet fa-5x cbpln-status-icon"></i>
								</div>
								<div class="col-xs-9 text-right">
									<div class="cbhuge comnelips fntwt600"><?php echo $PurchaseAccount; ?></div>
									<div class="cbhuge comnelips">Account Type</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres" id="PVDate">
					<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status1">
						<div class="padding-none">
							<div class="row">
								<div class="col-xs-3">
									<i class="fa fa-retweet fa-5x cbpln-status-icon"></i>
								</div>
								<div class="col-xs-9 text-right">
									<div class="cbhuge comnelips fntwt600"><?php echo $PVDate; ?></div>
									<div class="cbhuge comnelips">PV Date</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres" id="BillNo">
					<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status2">
						<div class="padding-none">
							<div class="row">
								<div class="col-xs-3">
									<i class="fa fa-calendar fa-5x cbpln-status-icon"></i>
								</div>
								<div class="col-xs-9 text-right">
									<div class="cbhuge comnelips fntwt600"><?php echo $BillNo; ?></div>
									<div class="cbhuge comnelips">Bill No</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres " id="BillDate" >
					<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status5">
						<div class="padding-none">
							<div class="row">
								<div class="col-xs-3">
									<i class="fa fa-registered fa-5x cbpln-status-icon"></i>
								</div>
								<div class="col-xs-9 text-right">
									<div class="cbhuge comnelips fntwt600"><?php echo $BillDate; ?></div>
									<div class="cbhuge comnelips">Bill Date</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres " id="CurrencyName">
					<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status6">
						<div class="padding-none">
							<div class="row">
								<div class="col-xs-3">
									<i class="fa fa-money fa-5x cbpln-status-icon"></i>
								</div>
								<div class="col-xs-9 text-right">
									<div class="cbhuge comnelips fntwt600"><?php echo $CurrencyName; ?></div>
									<div class="cbhuge comnelips">Currency</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres " id="PVNo" >
					<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status7">
						<div class="padding-none">
							<div class="row">
								<div class="col-xs-3">
									<i class="fa fa-cube fa-5x cbpln-status-icon"></i>
								</div>
								<div class="col-xs-9 text-right">
									<div class="cbhuge comnelips fntwt600"><?php echo $PVNo; ?></div>
									<div class="cbhuge comnelips">PV No</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres " id="CCPVNo">
					<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status8">
						<div class="padding-none">
							<div class="row">
								<div class="col-xs-2">
									<i class="fa fa-share fa-5x cbpln-status-icon"></i>
								</div>
								<div class="col-xs-10 text-right">
									<div class="cbhuge comnelips fntwt600"><?php echo $CCPVNo; ?></div>
									<div class="cbhuge comnelips">CCPV No</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres " id="CPVNo">
					<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status3">
						<div class="padding-none">
							<div class="row">
								<div class="col-xs-2">
									<i class="fa fa-star-half-o fa-5x cbpln-status-icon"></i>
								</div>
								<div class="col-xs-10 text-right">
									<div class="cbhuge comnelips fntwt600"><?php echo $CPVNo; ?></div>
									<div class="cbhuge comnelips">CPV No </div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres " id="Approve">
					<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status4">
						<div class="padding-none">
							<div class="row">
								<div class="col-xs-2">
									<i class="fa fa-ticket fa-5x cbpln-status-icon"></i>
								</div>
								<div class="col-xs-10 text-right">
									<div class="cbhuge comnelips fntwt600"><?php echo $Approve; ?></div>
									<div class="cbhuge comnelips">Approve</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div id="accordion" class="panel-group">
	<!-------------------------------Bill of Quantities------------------------------->
		<div class="panel panel-info">
			<div data-target="#collapseOne" data-parent="#accordion" data-toggle="collapse" class="panel-heading collapsed panel_heads" id="panelheading-1">
				<h4 class="panel-title accordion-toggle defa_panels">BILL Quantity</h4>
			</div>
			<div class="panel-collapse collapse" id="collapseOne" style="height: 0px;">
				<div class="panel-body bgcolr">
					<div class="col-lg-12">
						<div class="table-responsive top-10 ">
							<table class="table table-bordered" style=" margin-bottom:10px;" id="workorderTable">
								<thead>
								<tr>
									<th class="blubg">Description</th>
									<th class="blubg">Unit</th>
									<th class="blubg" style="text-align:center">Bill Qty</th>
									<th class="blubg" style="text-align:center">Actual Qty</th>
									<th class="blubg" style="text-align:center">Rate</th>
									<th class="blubg" style="text-align:center">QRate</th>
									<th class="blubg" style="text-align:center">Base Amount</th>
									<th class="blubg" style="text-align:center">Amount</th>
									<th class="blubg">&nbsp;</th>

								</tr>
								</thead>
								<tbody class="main"></tbody>
							</table>
							<input type="hidden" name="rowid" id="rowid" value="0"/>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-------------------------------Bill of Quantities end------------------------------->
		<!-------------------------------Advance Adjustment Tab ------------------------------->
		<div class="panel panel-info uniAdv" style="display:none;">
			<div data-target="#collapseTwo" data-parent="#accordion" data-toggle="collapse" class="panel-heading collapsed panel_heads" id="panelheading-2">
				<h4 class="panel-title accordion-toggle defa_panels">Advance Adjustment</h4>
			</div>
			<div class="panel-collapse collapse" id="collapseTwo" style="height: 0px;">
				<div class="panel-body bgcolr">
					<div class="col-lg-12">
						<div class="table-responsive top-30">
							<table class="table table-hover table-bordered clear" id="AdvanceTable">
								<thead>
								<tr>
									<th class="blubg">PO NO</th>
									<th class="blubg">PO Date</th>
									<th class="blubg">Title</th>
									<th class="blubg">Amount</th>
									<th class="blubg">Paid Amount</th>
									<th class="blubg">Balance</th>
									<th style='text-align:right'class="blubg">Deduction Balance</th>
									<th style='text-align:right' class="blubg">Current Amount</th>
								</tr>
								</thead>
								<tbody class="main"></tbody>
								<tbody class="total">
								<tr>
									<td colspan="6"></td>
									<td class="rate_pri">Total Amount</td>
									<td width="25%" ><input class="parent_text border-none" type="text" name="advtotal" id="advtotal" style="text-align:right;" onkeypress="return isNumberKey(event,this);" disabled /></td>

								</tr>
								</tbody>
							</table>
							<input type="hidden" name="Arowid" id="Arowid" value="0"/>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-------------------------------End of Advance --------------------------------------->
		<!-------------------------------QualifierTab----------------------------------------->
		<div class="panel panel-info uniQual" style="display:none;">
			<div data-target="#collapseThree" data-parent="#accordion" data-toggle="collapse" class="panel-heading collapsed panel_heads" id="panelheading-3">
				<h4 class="panel-title accordion-toggle defa_panels">Qualifier Details</h4>
			</div>
			<div class="panel-collapse collapse" id="collapseThree" style="height: 0px;">
				<div class="panel-body bgcolr">
					<div class="col-lg-12">
						<div class="table-responsive top-10">
							<table class="table table-hover table-bordered" >
								<thead>
								<tr>
									<th class="blubg">Qualifier Name</th>
									<th class="blubg">Account Name</th>
									<th style="text-align:center" class="blubg">Sign</th>
									<th style="text-align:center" class="blubg">%</th>
									<th style='text-align:right' class="blubg">Amount</th>
								</tr>
								</thead>
								<tbody class="main" id="QualifierAccTable"></tbody>
								<tbody class="total">
								<tr>
									<td colspan="3"></td>
									<td class="rate_pri">Total Amount</td>
									<td width="30%" ><input class="parent_text border-none " type="text" name="qutotal" id="qutotal" style="text-align:right;" onkeypress="return isNumberKey(event,this);" readonly/></td>
								</tr>
								</tbody>
							</table>
							<input type="hidden" name="Qrowid" id="Qrowid" value="0"/>

						</div>				
					</div>
				</div>
			</div>
		</div>
		<!-------------------------------end of qualifierTab---------------------------------->
		<!-------------------------------Terms and Condition------------------------------->
		<div class="panel panel-info uniTrms" style="display: none;">
			<div data-target="#collapseFour" data-parent="#accordion" data-toggle="collapse" class="panel-heading collapsed panel_heads" id="panelheading-4">
				<h4 class="panel-title accordion-toggle defa_panels">Terms And Conditions</h4>
			</div>
			<div class="panel-collapse collapse" id="collapseFour" style="height: 0px;">
				<div class="panel-body bgcolr">
					<div class="col-lg-12">
						<div class="table-responsive top-10">
							<table class="table table-bordered" style=" margin-bottom:0px;" id="termsTable">
								<thead>
								<tr>
									<th>Terms</th>
									<th>Value</th>
									<th>Account</th>
								</tr>
								</thead>
								<tbody class="main"></tbody>
							</table>
							<input type="hidden" name="trowid" id="trowid" value="0"/>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!------------------------------- END OF Terms and Condition------------------------------->
		<!-------------------------------Others Details------------------------------->
		<div class="panel panel-info uniNar" style="display:none;">
			<div data-target="#collapseFive" data-parent="#accordion" data-toggle="collapse" class="panel-heading collapsed panel_heads" id="panelheading-5">
				<h4 class="panel-title accordion-toggle defa_panels">Other Details</h4>
			</div>
			<div class="panel-collapse collapse" id="collapseFive" style="height: 0px;">
				<div class="panel-body bgcolr">
					<div class="clearfix"></div>
					<div class="col-lg-12">
						<div class="card">
							<ul class="nav nav-tabs">
								<li class="active"><a href="#nar" id="narrationTabLink" onclick="showotherstabs('narration')" aria-controls="naration" role="tab" data-toggle="tab">Narration</a></li>
							</ul>
							<div class="tab-content" id="narration">
								<div class="tab-pane active" id="nar">
									<p>
									<div class="sub_tab">
										<textarea class="exp-tex btnPrev" name="narration" id="narration" disabled ><?php echo (isset($Narration)) ? $Narration : '';?></textarea>
									</div>
									</p>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!------------------------------- end of Others Details------------------------------->
	</div>
</div>
<div id="jqxgrid"></div>
<div class="col-lg-12 savebtn_area">
    <ul>
        <li class="dropdown save_btn float_r">
            <a href="<?php echo $this->basePath("/mms/minconversion/conversionregister");?>" class="ripple">Close</a>
        </li>
    </ul>
</div>

<script id="Qual-template"  type="text/template" class="hide">
    <tr>
        <td width="15%"><input class="parent_text red-non qualmainTrInput qualpop" type="text" name="qualifiername__7" id="qualifiername__8" value="" disabled />
            <input type="hidden" name="QualifierExist___qu__0_per__9" id="QualifierExist___qu__0_per__9" value=""/>
            <input type="hidden" name="QualifierId__7" id="QualifierId__8" value=""/>
        </td>
        <td width="30%">
			<select data-placeholder="" class="form-control single_dropdown lbl_move sortoption qchk " tabindex="7" name="accountname__7" id="accountname__8" disabled ></select>
		</td>
        <td width="15%"><input class="parent_text red-non qualmainTrInput qualpop" type="text" name="sign__7" id="sign__8" style="text-align:center" disabled /></td>
        <td width="15%"><input class="parent_text red-non qualmainTrInput qualpop" type="text" name="percentage__7" style="text-align:center" id="percentage__8" value="" disabled /></td>
        <td width="30%"><input class="parent_text red-non qualmainTrInput qualpop qualamount" type="text" style='text-align:right' name="qualamount__7" id="qualamount__8" value="" disabled /></td>
    </tr>
</script>

<script id="Advance-template"  type="text/template" class="hide">
    <tr>
        <td width="5%"><input class="parent_text red-non qualmainTrInput" type="text" name="pono__" id="pono__" readonly/></td>
        <td width="20%">
            <div class="col-lg-12 padlr0">
                <input class="tbl_input date_picker red-non qualmainTrInput" type="text" name="podate__" id="podate__" readonly />
                <span class="date_icon"><i class="fa fa-calendar"></i></span>
            </div>
        </td>
        <td width="15%"><input class="parent_text red-non qualmainTrInput" type="text" name="title__" id="title__" readonly/></td>
        <td width="10%"><input class="parent_text red-non qualmainTrInput" type="text"  name="aamount__" id="aamount__" readonly /></td>
        <td width="10%"><input class="parent_text red-non qualmainTrInput" type="text"  name="paidamount__" id="paidamount__" readonly /></td>
        <td width="10%"><input class="parent_text red-non qualmainTrInput" type="text"  name="balance__" id="balance__" readonly /></td>
        <td width="10%"><input class="parent_text red-non qualmainTrInput" type="text"  style='text-align:right' name="deductbal__" id="deductbal__" readonly /></td>
        <td width="10%"><input class="parent_text red-non qualmainTrInput" type="text"  style='text-align:right' name="currentamount__" id="currentamount__" />
            <input class="parent_text red-non qualmainTrInput" type="hidden" name="poregisterid__" id="poregisterid__" />
            <input class="parent_text red-non qualmainTrInput" type="hidden" name="advtermsid__" id="advtermsid__" />
            <input class="parent_text red-non qualmainTrInput" type="hidden" name="hiddenamt__" id="hiddenamt__" />
		</td>
    </tr>
</script>

<script id="resource-template"  type="text/template" class="hide">
    <tr class="count-tr">
        <td width="25%" name="desc__" id="desc__">
            <input type="hidden" name="resourceid__" id="resourceid__"/>
        </td>
        <td width="8%" name="unitname__" id="unitname__">
            <input type="hidden" name="unitid__" id="unitid__"/>
            <input type="hidden" name="itemid__" id="itemid__"/>
        </td>
        <td width="11%" name="bqty__" id="bqty__" style="text-align:right">
            <input type="hidden" name="hiddenqty__" id="hiddenqty__" >
        </td>
        <td width="11%" name="aqty__" id="aqty__" style="text-align:right">
            <input type="hidden" name="hiddenqty__" id="hiddenqty__">
        </td>
        <td width="11%" name="rate__" id="rate__" style="text-align:right;"></td>
        <td width="11%" name="qrate__" id="qrate__" style="text-align:right;"></td>
        <td width="12%" name="baseamount__" style="text-align:right;" id="baseamount__"></td>
        <td width="12%" name="amount__" style="text-align:right;" id="amount__"></td>

        <td width="2%" align="center" class="action_btns_td">
            <ul class="action_btns">
                <li> <a href="#" class="mainTr" id="expandTr__" style="display:none;"> <i class="fa fa-chevron-circle-down" data-toggle="tooltip" data-placement="left" data-original-title="Add lines" ></i></a> </li>
            </ul>
        </td>
    </tr>
    <tr style="display:none" class="subTr count-tr">
        <td colspan="9" style="padding:0px !important; ">
			<div class="subDiv" style="">
				<div class="col-lg-12 col-lg-offset-0 rdbt" style="margin-top:0px;">
					<div class="card">
						<ul class="nav nav-tabs">
							 <li class="active"><a class="ripple has-ripple" id="decisionTabLink__" onclick="showtabs('decision',this.id,event)" style="position: relative; overflow: hidden;cursor:pointer;">Min<span class="ripple-wrapper animated" style="width: 89px; height: 89px; top: -41.5px; left: 22.9531px;"></span></a></li>
							<li class=""><a class="ripple has-ripple" id="qualifierTabLink__" onclick="showtabs('qualifier',this.id,event)" style="position: relative; overflow: hidden; cursor:pointer;"> Qualifier<span class="ripple-wrapper animated" style="width: 105px; height: 105px; top: -29.5px; left: 16.9531px;"></span></a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-12">
					<div class="tab-content">
						<div class="tab-pane active">
							<div class="table-responsive sub_tab">
								<table class="table table-bordered" style="margin-bottom:0px;" id="decisionTable__">
									<thead>
									<tr>
										<th class="worktype-activity sub_tbl3">MIN No</th>
										<th class="worktype-activity sub_tbl3">MIN Date</th>
										<th class="worktype-activity sub_tbl3">Site Min No</th>
										<th class="worktype-activity sub_tbl3">Site Min Date</th>
										<th class="worktype-activity sub_tbl3" style="text-align:center">Bal Qty</th>
										<th class="worktype-activity sub_tbl3" style="text-align:center">Qty</th>
										<th class="iow___requestfields" style="display: none;">&nbsp;</th>
									</tr>
									</thead>
									<tbody class="main"></tbody>
									<tbody class="total">
									</tbody>
									<input type="hidden" name="iow___rowid" id="iow___rowid" value="0"/>
								</table>

								<table class="table" style="margin-bottom:0px; display: none;" id="qualifierTable__">
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
        </td>
    </tr>
</script>

<script id="iow-template"  type="text/template" class="hide">
   
    <tr class="dont-hide">
        <td width="15%" class="worktype-activity" name="iow___minno_0" id="iow___minno_0">
            <input type="hidden" name="iow___dcregisterid_0" id="iow___dcregisterid_0"/>
            <input type="hidden" name="iow___dcgroupid_0" id="iow___dcgroupid_0"/>
            <input type="hidden" name="iow___resourceid_0" id="iow___resourceid_0"/>
            <input type="hidden" name="iow___itemid_0" id="iow___itemid_0"/>
            <input type="hidden" name="iow___unitid_0" id="iow___unitid_0"/>
        </td>
        <td width="20%" name="iow___mindate_0" id="iow___mindate_0"></td>

        <td width="20%"  name="iow___siteminno_0" id="iow___siteminno_0"></td>
        <td width="20%"  name="iow___sitemindate_0" id="iow___sitemindate_0"></td>
        <td width="13%"  name="iow___balqty_0" id="iow___balqty_0" style="text-align:right"></td>
        <td width="12%"  name="iow___qty_0" id="iow___qty_0" style="text-align:right">
            <input type="hidden" name="iow___hiddenqty_0" id="iow___hiddenqty_0" value="0"/>
        </td>
    </tr>

</script>

<script id="terms-template"  type="text/template" class="hide">
    <tr class="dont-hide">
        <td width="33%">
            <input class="parent_text resourceSuggest" type="text" name="terms__" id="terms__" onfocus="checkTermsUsed(this);" disabled />
            <input type="hidden" name="termsid__" id="termsid__"  value=""/>
            <input type="hidden"  name="isvalue__" id="isvalue__" value=""/>
            <input type="hidden"  name="isaccount__" id="isaccount__" value=""/>
        </td>
        <td width="33%"><input class="parent_text border-none cal" type="text" name="value__" id="value__" style="text-align:right;"  disabled /></td>

        <td width="33%"><select data-placeholder="" class="form-control single_dropdown lbl_box sortoption tbl_input changeVal" name="account__" id="account__" disabled ></select></td>
    </tr>
</script>
<script>
$(document).ready(function(){

	var arr_requestResources = <?php echo (isset($arr_requestResources)) ? json_encode($arr_requestResources) : '[]';?>;
	var arr_advance = <?php echo (isset($arr_advance)) ? json_encode($arr_advance) : '[]';?>;

	var arr_resource_iows = <?php echo (isset($arr_resource_iows)) ? json_encode($arr_resource_iows) : '[]';?>;
	var arr_resource_iow_requests = <?php echo (isset($arr_resource_iow_requests)) ? json_encode($arr_resource_iow_requests) : '[]';?>;

	var terms_ent = <?php echo (isset($terms_ent)) ? json_encode($terms_ent) : '[]';?>;
	var Account = <?php echo (isset($Account)) ? json_encode($Account) : '[]';?>;
	var qualList = <?php echo (isset($qualList)) ? json_encode($qualList) : '[]';?>;
	var qual_Acc = <?php echo (isset($Qual_Acc)) ? json_encode($Qual_Acc) : '[]';?>;
	var qualAccList = <?php echo (isset($qualAccList)) ? json_encode($qualAccList) : '[]';?>;
	var qualiferHTML = '<?php echo (isset($qualHtml)) ? preg_replace('~>\s+<~', '><',$qualHtml) : '';?>';
	var sampleQual = [];

	$.each(qualAccList, function (k, j) {
		var sign = 0;
		if(j.Sign == '+'){
			sign = 1;
		} else{
			sign = 2;
		}
		var aId = j.AccountId;
		var qId = j.QualifierId;
		var arrKey = qId +'AA'+ sign ;
		sampleQual[arrKey] = aId;
	});

	$(function () {
		var $rowid = $('#rowid');
		var template = $('#resource-template').html();
		var iowtemplate = $('#iow-template').html();
		var termstemplate = $('#terms-template').html();
		var rowid = 0;
		var $tbody = $('#workorderTable').find('> tbody.main');

		if(arr_requestResources.length != 0) {
			$.each(arr_requestResources, function(i, o) {
				rowid += 1;
				$tbody.append(template.replace(/__/g, '_' + rowid));
				$('#desc_' + rowid).html(o.Desc).addClass('border-none').prop('disabled', true);
				$('#resourceid_' + rowid).val(o.ResourceId);
				$('#itemid_' + rowid).val(o.ItemId);
				$('#unitname_' + rowid).html(o.UnitName).addClass('border-none').prop('disabled', true);
				$('#unitid_' + rowid).val(o.UnitId);
				$('#bqty_' + rowid).html(sanitizeNumber(o.BillQty,3,true)).addClass('border-none').prop('disabled', true);
				$('#aqty_' + rowid).html(sanitizeNumber(o.ActualQty,3,true)).addClass('border-none').prop('disabled', true);
				$('#rate_' + rowid).html(sanitizeNumber(o.Rate,2,true)).addClass('border-none').prop('disabled', true);
				$('#qrate_' + rowid).html(sanitizeNumber(o.QRate,2,true)).addClass('border-none').prop('disabled', true);
				$('#baseamount_' + rowid).html(sanitizeNumber(o.Amount,2,true)).addClass('border-none').prop('disabled', true);
				$('#amount_' + rowid).html(sanitizeNumber(o.QAmount,2,true)).addClass('border-none').prop('disabled', true);
				$('#hiddenqty_' + rowid).val(o.HiddenQty);
				$('#total').html(o.BillAmount).addClass('border-none').prop('disabled', true);
				$('#expandTr_' + rowid).show();
				$('#deleteTr_' + rowid).show();
				$('#expandSt_' + rowid).show();

				var findRes = arr_resource_iows.filter(function(obj) {
					return (obj.ResourceId === o.ResourceId) && (obj.ItemId === o.ItemId && (obj.BalQty > 0 || obj.Qty > 0));
				});
				if(findRes.length > 0) {
					$.each(arr_resource_iows, function (j, l) {
						if ((l.ResourceId != o.ResourceId || l.ItemId != o.ItemId)) {
							return;
						}

						var iowrowid = parseInt($('#iow_' + rowid + '_rowid').val()) + 1;
						$('#decisionTable_' + rowid).find('> tbody.main').append(iowtemplate
							.replace(/__/g, '_' + rowid)
							.replace(/_0/g, '_' + iowrowid));
						$('#iow_' + rowid + '_rowid').val(iowrowid);
						$('#decisionTable_' + rowid).show();
						//$('#decisionTabLink_' + rowid).show();

						$('#iow_' + rowid + '_dcregisterid_' + iowrowid).val(l.DCRegisterId);
						$('#iow_' + rowid + '_dcgroupid_' + iowrowid).val(l.DCGroupId);
						$('#iow_' + rowid + '_resourceid_' + iowrowid).val(l.ResourceId);
						$('#iow_' + rowid + '_itemid_' + iowrowid).val(l.ItemId);
						$('#iow_' + rowid + '_minno_' + iowrowid).html(l.MINNo).addClass('border-none').prop('disabled', true);
						$('#iow_' + rowid + '_mindate_' + iowrowid).html(l.MINDate).addClass('border-none').prop('disabled', true);
						$('#iow_' + rowid + '_siteminno_' + iowrowid).html(l.SiteMINNo).addClass('border-none').prop('disabled', true);
						$('#iow_' + rowid + '_sitemindate_' + iowrowid).html(l.SiteMINDate).addClass('border-none').prop('disabled', true);
						$('#iow_' + rowid + '_balqty_' + iowrowid).html(sanitizeNumber(l.BalQty,3,true)).addClass('border-none').prop('disabled', true);
						$('#iow_' + rowid + '_qty_' + iowrowid).html(sanitizeNumber(l.Qty,3,true)).addClass('border-none').prop('disabled', true);
						$('#iow_' + rowid + '_hiddenqty_' + iowrowid).val(l.HiddenQty);
						if (<?php echo (isset($PVRegisterId)) ? $PVRegisterId : 0;?> > 0) {
							var RId = o.ResourceId;
							var ItId = o.ItemId;
							var pvId =<?php echo (isset($PVRegisterId)) ? $PVRegisterId : 0;?>;
							$.ajax({
								url: getBaseURL() + 'mms/minconversion/detailedconversion',
								type: "post",
								data: "ResourceId=" + RId + "&Type=getqualdetails&ItemId=" + ItId + "&pvId=" + pvId + "",
								async: false,
								success: function (data, textStatus, jqXHR) {
									if (jqXHR.status == 200) {
										data = JSON.parse(data);
                                            $('#qualifierTable_' + rowid).html(data.replace(/__1/g, '_' + rowid));
                                        if($('input[type="checkbox"]')){
                                            $('.qualChange').attr('disabled',true);
									     }
                                        else{
                                            $('.qualChange').attr('readonly',true);
                                        }
                                    }
									$('.loading_area').hide();
								}, error: function (jqXHR, textStatus, errorThrown) {
									$('.loading_area').hide();
								}
							});
						}
					});
				}
			});
		}
		$rowid.val(rowid);
		//Advance Adjustments
		var $arowid = $('#Arowid');
		var atemplate = $('#Advance-template').html();
		var arowid = 0;
		var $tbody = $('#AdvanceTable').find('> tbody.main');
		var advtot=0;

		if(arr_advance.length > 0){
            $('.uniAdv').show();
			$.each(arr_advance, function (j, p) {
				arowid += 1;
				$tbody.append(atemplate.replace(/__/g, '_' + arowid));
				$('#pono_' + arowid).val(p.PONo).addClass('border-none').prop('disabled', true);
				$('#poregisterid_' + arowid).val(p.PORegisterId);
				$('#advtermsid_' + arowid).val(p.TermsId);
				$('#podate_' + arowid).val(p.PODate).addClass('border-none').prop('disabled', true);
				$('#title_' + arowid).val(p.Title).addClass('border-none').prop('disabled', true);
				$('#aamount_' + arowid).val(sanitizeNumber(p.Amount,2,true)).addClass('border-none').prop('disabled', true);
				$('#paidamount_' + arowid).val(sanitizeNumber(p.PaidAmount,2,true)).addClass('border-none').prop('disabled', true);
				$('#currentamount_' + arowid).val(sanitizeNumber(p.CurrentAmount,2,true)).addClass('border-none').prop('disabled', true);
				$('#balance_' + arowid).val(sanitizeNumber(p.Balance,2,true)).addClass('border-none').prop('disabled', true);
				$('#deductbal_' + arowid).val(sanitizeNumber(p.DeductionBalance,2,true)).addClass('border-none').prop('disabled', true);
				$('#hiddenamt_' + arowid).val(p.HiddenAmount).addClass('border-none').prop('disabled', true);
				$arowid.val(arr_advance.length);
				advtot=parseFloatVal(advtot)+parseFloatVal($('#currentamount_' + arowid).val());
			});
		}
		$('#advtotal').val(advtot);

		//terms &condition end
		var $trowid = $('#trowid');
		var template = $('#terms-template').html();
		var trowid = 0;
		var $tbody = $('#termsTable').find('> tbody');
		if(terms_ent.length > 0){
            $('.uniTrms').show();
			$.each(terms_ent, function (j, p) {
				trowid += 1;
				$tbody.append(template.replace(/__/g, '_' + trowid));
				var opt = '<option></option>';
				if (Account.length > 0) {
					$.each(Account, function (m, n) {
						opt += '<option value="' + n.AccountId + '">' + n.AccountName + '</option>';
					});
				}
				$('#account_' + trowid).html(opt);

				$('#terms_' + trowid).val(p.Terms);
				$('#value_' + trowid).val(sanitizeNumber(p.Value,2,true));
				$('#termsid_' + trowid).val(p.TermsId);
				$trowid.val(terms_ent.length);
				$('#account_' + trowid).val(p.AccountId);
			});
		}
		
		//Qualifier
        if(qualAccList.length != '') {
            $('.uniQual').show();
            var qual1 = 0;
            $('#qualClick').attr("disabled", false);
            $('#QualifierAccTable').html('');
            var totalQualRows = $('#rowid').val();
            var Qtemplate = $('#Qual-template').html();
            var qualCheck = 0;

            for (var i = 1; i <= totalQualRows; i++) {
                $.each(qualList, function (m, o) {
                    var qualRowCount = m + 1;

                    if ($('#Qual_' + i + '_YesNo_' + qualRowCount).is(':checked') == true) {
                        var vatAmt = parseFloatVal($('#Qual_' + i + '_Amount_' + qualRowCount).val());
                        var QualName = $('#Qual_' + i + '_Desc_' + qualRowCount).val();
                        var qId = $('#Qual_' + i + '_Id_' + qualRowCount).val();
                        var percent = $('#Qual_' + i + '_ExpPer_' + qualRowCount).val();
                        var dot = sanitizeNumber(percent, 2, true).replace('.', '_');
                        var sSign = isNullCheck($('#Qual_' + i + '_Sign_' + qualRowCount).val(), 'string');
                        if (sSign == '+') {
                            aSign = 1;
                        } else {
                            aSign = 2;
                        }
                        var commonVar = 'QualifierExist_' + qId + '_qu_' + aSign + '_per_' + dot;
                        abc = $('#QualifierExist_' + qId + '_qu_' + aSign + '_per_' + dot);
                        if (abc.length) {
                            var prevAmt = parseFloatVal($('#qualamount_' + commonVar).val());
                            var newAmt = parseFloatVal(prevAmt) + parseFloatVal(vatAmt);
                            $('#qualamount_' + commonVar).val(sanitizeNumber(newAmt, 3, true));
                        }
                        else {
                            $('#QualifierAccTable').append(Qtemplate
                                    .replace(/__8/g, '_' + commonVar)
                                    .replace(/__7/g, '_' + qualCheck)
                                    .replace(/__9/g, '_' + dot)
                                    .replace(/__0/g, '_' + aSign)
                                    .replace(/__/g, '_' + qId)
                            );
                            $(".single_dropdown1").select2({});
                            abc.val('QualifierExist_' + qId + '_qu_' + aSign);
                            $('#qualifiername_' + commonVar).val(QualName);
                            $('#QualifierId_' + commonVar).val(qId);
                            $('#percentage_' + commonVar).val(sanitizeNumber(percent, 2, true));
                            $('#sign_' + commonVar).val(sSign);
                            $('#qualamount_' + commonVar).val(sanitizeNumber(vatAmt, 3, true));
                            var arrkey = qId + 'AA' + aSign;
                            var opt = '<option value=""></option>';
                            if (qual_Acc.length > 0) {
                                $.each(qual_Acc, function (j, p) {
                                    if (sampleQual[arrkey] == p.AccountId) {
                                        opt += '<option selected value="' + p.AccountId + '">' + p.AccountName + '</option>';
                                    } else {
                                        opt += '<option value="' + p.AccountId + '">' + p.AccountName + '</option>';
                                    }
                                });
                            }
                            $('#accountname_' + commonVar).html(opt).trigger('change');
                            qualCheck++;
                            $('#Qrowid').val(qualCheck);
                        }
                    }
                });
            }
            $('.qualamount').each(function (i, o) {
                var curId = $(this).attr('id');
                var signId = curId.replace('qualamount', 'sign');
                var aSignVal = $('#' + signId).val();
                if (aSignVal == '-') {
                    qual1 -= parseFloat($(this).val());
                }
                else {
                    qual1 += parseFloat($(this).val());
                }
            });
            $('#qutotal').val(sanitizeNumber(qual1, 2));
        }

		$('.container-fluid').on('click','.mainTr',function(e){
			e.preventDefault();
			if(!$(this).closest("tr").next(".subTr").is(":visible")){
				$(this).closest("tr").next(".subTr").show();
				$(this).closest("tr").next(".subTr").find(".subDiv").slideDown("slow");
				$(this).find("i").addClass("tform");
			}
			else{
				$(this).closest("tr").next(".subTr").find(".subDiv").slideUp("slow");
				$(this).closest("tr").next(".subTr").slideUp("slow");
				$(this).find("i").removeClass("tform");
			}
		});
		nextAccordian(1);
        var checkNar = "<?php echo (isset($Narration)) ? $Narration : 0;?>";
        if (checkNar != ''){
            $('.uniNar').show();
        }
	});

});
function nextAccordian(id) {
	$('#panelheading-1').trigger('click');
}
function showtabs(type,id,event) {
    event.preventDefault();
    $('#' + id).parent('li').addClass('active').siblings('li').removeClass('active');
    var rowid = id.split('_')[1];

    if (type=="decision") {
        $('#decisionTable_'+rowid).show();
        $('#qualifierTable_'+rowid).hide();

    } else if (type=="qualifier") {
        $('#qualifierTable_'+rowid).show();
        $('#decisionTable_'+rowid).hide();
    }
    return false;
}
var CostCentreName= <?php echo json_encode ($CostCentreName);?>;
var SupplierName= <?php echo json_encode ($SupplierName);?>;
var PurchaseTypeName= <?php echo json_encode ($PurchaseTypeName);?>;
var PurchaseAccount= <?php echo json_encode ($PurchaseAccount);?>;
var PVDate= <?php echo json_encode ($PVDate);?>;
var BillNo= <?php echo json_encode ($BillNo);?>;
var BillDate= <?php echo json_encode ($BillDate);?>;
var CurrencyName= <?php echo json_encode ($CurrencyName);?>;
var PVNo= <?php echo json_encode ($PVNo);?>;
var CCPVNo= <?php echo json_encode ($CCPVNo);?>;
var CPVNo= <?php echo json_encode ($CPVNo);?>;
var Approve= <?php echo json_encode ($Approve);?>;

if(CostCentreName == ''|| CostCentreName == null) {
	$('#CostCentreName').hide();
} 
if(SupplierName == ''|| SupplierName == null){
	$('#SupplierName').hide();
} 
if(PurchaseTypeName == ''|| PurchaseTypeName == null){
	$('#PurchaseTypeName').hide();
} 
if(PurchaseAccount == ''|| PurchaseAccount == null){
	$('#PurchaseAccount').hide();
} 
if(PVDate == ''|| PVDate == null){
	$('#PVDate').hide();
} 
if(BillNo == ''|| BillNo == null){
	$('#BillNo').hide();
} 
if(BillDate == ''|| BillDate == null){
	$('#BillDate').hide();
} 
if(CurrencyName == ''|| CurrencyName == null){
	$('#CurrencyName').hide();
} 
if(PVNo == ''|| PVNo == null){
	$('#PVNo').hide();
} 
if(CCPVNo == ''|| CCPVNo == null){
	$('#CCPVNo').hide();
} 
if(CPVNo == ''|| CPVNo == null){
	$('#CCPVNo').hide();
} 
if(Approve == ''|| Approve == null){
	$('#Approve').hide();
}
</script>