<style>
   #vendorServiceListWrapper {
        display: none;
    }
    .pagination-lg > li > a, .pagination-lg > li > span {
        font-size:15px !important;
        padding:5px 15px !important;
    }
    /* Excel Floating Icon */
    .fixed-action-btn          	    {position:fixed;top:85px;right:5px;padding-top:15px;margin-bottom:0;z-index:998;}
    .fixed-action-btn:hover ul li a.btn-floating{transform: scaleY(1) scaleX(1) translateX(0px);opacity: 1;}
    .btn-floating.btn-large         {width:45px;height:45px;}
    .fixed-action-btn ul 			{left:-142px;right:0;text-align:center;position:absolute;margin:0;top:22px;}
    .fixed-action-btn ul li 		{margin-left:8px;list-style-type:none;float:left;}
    .fixed-action-btn ul li a.btn-floating {transform: scaleY(0.4) scaleX(0.4) translateX(40px);opacity: 0;}
    .fixed-action-btn ul a.btn-floating i  {font-size: 17px;line-height: 37px;}
    .btn-floating                   {display:inline-block;color:#fff;position:relative;overflow:hidden;z-index:1;width:37px;height:37px;line-height:37px;padding: 0;
        background-color: #26a69a;border-radius:50%;cursor:pointer;vertical-align: middle;
        box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);text-decoration: none;transition: all .3s ease;
        -webkit-transition: all .3s ease; -moz-transition: all .3s ease; -o-transition: all .3s ease;}
    .btn-floating i                 {width: inherit;display: inline-block;text-align: center;color: #fff;font-size:20px;line-height: 45px; font-weight:normal; color:#fff;}
    .next-bt                        {text-align:center;}
    .next-bt a:hover                {border:1px solid #3580C4 !important; background:#fff !important; color:#3580C4 !important;}
    .next-bt a                      {background:#3580C4!important;border:1px solid #3580C4; border-radius: 4px;
    color:#fff!important; font-size:14px; padding: 5px 10px; text-align: center; transition: all 0.4s ease 0s;}
	.commargin_top 					{margin-top: 30px;}

    /* Excel Floating Icon end*/
/*--------------Jqx Grid jqx All-------------------*/
#jqxgrid									{min-height:200px !important;}
#jqxgrid .jqx-grid-header 					{height:40px !important;}
.jqx-grid-groups-row						{padding-left:5px !important;}
.jqx-grid-pager-input						{padding: 2px; text-align: center !important; width: 35px;}
.jqx-dropdownlist-state-normal				{display: block;  float: right;height: 16px !important;margin-right: 7px;margin-top: 0;  padding-bottom: 2px !important;padding-top: 2px !important; width: 40px;}
.jqx-button									{cursor: pointer;float: right;margin-right: 3px !important;margin-top: 0 !important;padding: 0 !important;width: 20px !important;}
.jqx-button > .jqx-icon-arrow-left,
.jqx-button >.jqx-icon-arrow-right			{height: 21px !important;margin-left: 0 !important;width: 20px !important;}
.jqx-listitem-element						{height: 25px !important;}
.jqx-input									{height: 25px !important; margin:2px 4px !important;}
.jqx-grid-pager .jqx-grid-pager-input		{height:20px !important; margin:0px 4px !important;}
#jqxgrid .jqx-grid-cell-right-align 		{text-align:right !important; padding-right:8px;}
#jqxgrid .jqx-grid-cell-left-align 			{padding-left:8px;}
.jqx-grid-column-menubutton::after			{left:4px;top:10px;}
.jqx-widget-content{z-index:999 !important;}
</style>
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/library/jqwidgets/jqxgrid.grouping.js"></script>
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/library/jqwidgets/jqxgrid.aggregates.js"></script>
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/library/jqwidgets/jqx-all.js"></script>
<div class="content_wrapper  padlr0">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12 padlr0">
                <div class="col-lg-6 col-md-6 col-sm-6 padlr0">
                    <h1 class="col-lg-6 col-md-6 col-sm-6">Material Wise Warehouse</h1>
                    <div class="col-lg-6">
                        <div class="fixed-action-btn active">
                            <a class="btn-floating btn-large">
                                <i class="fa fa-print"></i>
                            </a>
                            <ul>
                                <li>
                                    <a class="btn-floating hide-input-file" id="print" href="javascript:void(0);" data-toggle="tooltip" data-placement="top" data-original-title="Print Report">
                                        <i class="fa fa-print"></i>

                                    </a>
                                </li>
                                <li>
                                    <a class="btn-floating" id="excelExport" href="javascript:void(0);" data-toggle="tooltip" data-placement="top" data-original-title="Download Excel">
                                        <i class="fa fa-download"></i>
                                    </a>
                                </li>
                                <li>
                                    <a class="btn-floating" id="csvExport" href="javascript:void(0);" data-toggle="tooltip" data-placement="top" data-original-title="Export CSV">
                                        <i class="fa fa-file-archive-o"></i>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-12 clear">
                <div class="table-responsive clear">
                    <div id="jqxgrid"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="col-lg-12 savebtn_area">
    <ul>
        <li class="dropdown save_btn float_r">
            <a href="<?php echo $this->basePath();?>/mms/report/reportlist" class="ripple">Close</a>
        </li>
    </ul>
</div>

<script type="text/javascript"> 
  var source =
	{
		dataFields: [
			{name: 'Id', type: 'string'},
			{name: 'ResourceId', type: 'string'},
			{name: 'ItemId', type: 'string'},
			{name: 'Code', type: 'string'},
			{name: 'Resource', type: 'string'},
			{name: 'ClosingStock', type: 'string'}
		],
		localdata:<?php echo json_encode($materialdetails); ?>,
		id: "Id",
		datatype: "json",
		async: false
	};
   var dcAdapter = new $.jqx.dataAdapter(source);
   var source1 =
	{
		dataFields: [
			{name: 'Id', type: 'string'},
			{name: 'ResourceId', type: 'string'},
			{name: 'ItemId', type: 'string'},
			{name: 'WareHouseId', type: 'string'},
			{name: 'WareHouse', type: 'string'},
			{name: 'ClosingStock', type: 'string'}

		],
		localdata:<?php echo json_encode($materialdetails2); ?>,
		datatype: "json",
		async: false
	};

	var transAdapter = new $.jqx.dataAdapter(source1, { autoBind: true });
	orders = transAdapter.records;

	var nestedGrids1 = new Array();

	//create nested grid.
	var initrowdetails1 = function (index, parentElement, gridElement, record) {

		var id = record.uid.toString();
		var grid = $($(parentElement).children()[0]);
		$(grid).attr('id', 'nestedGrid_' + id);
		nestedGrids1[index] = grid;
		var filtergroup = new $.jqx.filter();
		var filter_or_operator = 1;
		var filtervalue = id;
		var filtercondition = 'equal';
		var filter = filtergroup.createfilter('stringfilter', filtervalue, filtercondition);
		//fill the orders1 depending on the id.
		var ordersbyid = [];
		for (var m = 0; m < orders.length; m++) {
			var result = filter.evaluate(orders[m]['Id']);
			if (result)
				ordersbyid.push(orders[m]);
		}

		var  source1 = {
			dataFields: [

				{name: 'Id', type: 'string'},
				{name: 'ResourceId', type: 'string'},
				{name: 'ItemId', type: 'string'},
				{name: 'WareHouseId', type: 'string'},
				{name: 'WareHouse', type: 'string'},
				{name: 'ClosingStock', type: 'string'}
			],
			//id: 'OrderID'
			localdata: ordersbyid
		}
	  // alert(JSON.stringify(source1));

	   var nestedtransAdapter1 = new $.jqx.dataAdapter(source1); 

		if (grid != null) {
			grid.jqxGrid({
				source: nestedtransAdapter1,
				width: '90%',
				height: 300,
				sortable: true,
				pageable: true,
				rowdetails: true,
				rowsheight: 35,
				columnsresize: true,
				columnsreorder: true,
				ready: function () {
				},

				columns: [
					{ text: 'Id', dataField: 'Id', align: 'left', cellsalign: 'left',hidden:true},
					{ text: 'ResourceId', dataField: 'ResourceId', align: 'left', cellsalign: 'left',hidden:true},
					{ text: 'ItemId', dataField: 'ItemId', align: 'left', cellsalign: 'left',hidden:true},
					{ text: 'WareHouseId', dataField: 'WareHouseId', align: 'left', cellsalign: 'left',hidden:true},
					{ text: 'WareHouse', dataField: 'WareHouse', align: 'left', cellsalign: 'left'},
					{ text: 'ClosingStock', dataField: 'ClosingStock', align: 'left', cellsalign: 'left'},
				]
			});

		}
	}
	
	$("#jqxgrid").jqxGrid(
		{
			width: '100%',
			source: dcAdapter,
			autoheight: true,
			sortable: true,
			pageable: true,
			pageSize: 10,
			rowsheight: 35,
			rowdetails: true,
			columnsresize: true,
			columnsreorder: true,
			initRowDetails: initrowdetails1,
			rowdetailstemplate: {
				rowdetails: "<div id='grid' style='margin: 10px;'></div>",
				rowdetailsheight: 200,
				rowdetailshidden: true
			},
			
			columns: [
				{text: 'Id', dataField: 'Id', align: 'left', cellsalign: 'left',hidden:true},
				{text: 'ResourceId', dataField: 'ResourceId', align: 'left', cellsalign: 'left',hidden:true},
				{text: 'ItemId', dataField: 'ItemId', align: 'left', cellsalign: 'left',hidden:true},
				{text: 'Code', dataField: 'Code', align: 'left', cellsalign: 'left'},
				{text: 'Resource', dataField: 'Resource', align: 'left', cellsalign: 'left'},
				{text: 'ClosingStock', dataField: 'ClosingStock', align: 'left', cellsalign: 'left'},
			]
		});

	$("#jqxgrid").jqxGrid('showgroupsheader', false);
	//Print option
	$("#excelExport").click(function () {
		$("#jqxgrid").jqxGrid('exportdata', 'xls', 'jqxGrid');
	});
	$("#csvExport").click(function () {
		$("#jqxgrid").jqxGrid('exportdata', 'csv', 'jqxGrid');
	});
	$("#htmlExport").click(function () {
		$("#jqxgrid").jqxGrid('exportdata', 'html', 'jqxGrid');
	});

	$("#print").click(function () {
		var gridContent = $("#jqxgrid").jqxGrid('exportdata', 'html');
		//var gridContent = $("#jqxgrid").jqxGrid('exportdata', 'html', 'jqxGrid', true, null, false);
		var newWindow = window.open('', '', 'width=800, height=500'),
			document = newWindow.document.open(),
			pageContent =
				'<!DOCTYPE html>\n' +
				'<html>\n' +
				'<head>\n' +
				'<meta charset="utf-8" />\n' +
				'<title>Material Wise Warehouse</title>\n' +
				'<h1>Material Wise Warehouse</h1>\n' +
				'</head>\n' +
				'<body>\n' + gridContent + '\n</body>\n</html>';
		document.write(pageContent);
		document.close();
		newWindow.print();

		/*$("#jqxgrid").jqxGrid('exportdata', 'html', 'jqxGrid', true, null, false);*/
	});

	$("#jqxgrid").bind('rowselect', function (event) {
		var row = event.args.rowindex;
		var datarow = $("#jqxgrid").jqxGrid('getrowdata', row);

	});

 
</script>