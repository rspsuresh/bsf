<style>
    .jqx-widget-content{z-index:999 !important;}
</style>
<link rel="stylesheet" href="<?php echo $this->basePath() . '/css/mms.css'; ?>" />

<style type="text/css">
    .mar_20{margin-top:20px!important;}
    .jqx-widget-content {z-index:999 !important;}
    .pan_box ul li label {width: 50%!important;}
    .bar1, .bar2, .bar3 {width: 18px;height: 3px;background-color: #009688;margin: 3px 0;transition: 0.4s;}
    .change .bar1 {-webkit-transform: rotate(-45deg) translate(-6px, 5px);transform: rotate(-45deg) translate(-6px,5px);}
    .change .bar2 {opacity: 0;}
    .change .bar3 {-webkit-transform: rotate(45deg) translate(-3px, -3px);transform: rotate(45deg) translate(-3px, -3px);}
    .flip0{float:right;margin-top:5px;cursor:pointer;}
    .flip0{float:right;margin-top:5px;cursor:pointer;}
    .lbl_ptb {padding-top: 3px!important;padding-bottom:3px !important;}
    .selected-xs{width:50%!important;border:0px solid #babdb8!important;}
    .selected-xs select{height:20px;color: #266aa8; padding-left:0px !important; font-size:13px !important;cursor:pointer;}
    .select-style {float: left;width: 100%;padding: 0;margin: 0;border: 1px solid #c2c2c2;overflow: hidden;background-color: #fff;border-radius: 0px;}
    .margn_8{margin-bottom:8px;}
    .pan_box{height:135px !important;}
    .lbl_mtb {margin-top: 3px!important;margin-bottom:3px !important;}
	.btnPrev:disabled {background-color:#ffffff;}
	.sub_tab {background-color: #e7e9ec !important;border: 1px solid #ddd !important;float: left;margin-top: 0px;margin-bottom:5px;padding:8px;width:100%;}
	.subDiv {background-color: #fff !important;border: 0px solid #ddd !important;}
	.blubg{background : #B0C3EB !important;}
	.highlight{background : #e6bfcb !important;}
	.highlight1{background : #bfefd6 !important;}
	.card{margin-top:0% !important; margin-bottom:0px !important;}
	.sub_tbl3{color: #424141;font-weight: 600; background: #ceefe5 !important;border-bottom: 2px solid #18abc4 !important;border-top: 1px solid #ddd !important;white-space: nowrap;}
	.top-10{margin-top:10px;}
	</style>
<div class="content_wrapper">
	<div class="container-fluid">
		<div class="row">
			<input type="hidden" id="gridtype" name="gridtype" value="<?php echo (isset($gridtype)) ? $gridtype : 0;?>">
			<div class="col-lg-12 mar_20">
				<h1 style="margin-left:10px;">Transfer Detail<span class="edit_symbl">_<?php echo $vNo; ?></span></h1>
			</div>
			<div class="col-lg-12">
				<div class="col-lg-12 col-lg-offset-0 col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0 clear padlr0">
					<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres" id="FCompanyName">
						<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status3">
							<div class="padding-none">
								<div class="row">
									<div class="col-xs-3">
										<i class="fa fa-bandcamp fa-5x cbpln-status-icon"></i>
									</div>
									<div class="col-xs-9 text-right">
										<div class="cbhuge comnelips fntwt600"><?php echo $FCompanyName; ?></div>
										<div class="cbhuge comnelips">From Company</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres" id="FCostCentreName">
						<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status4">
							<div class="padding-none">
								<div class="row">
									<div class="col-xs-3">
										<i class="fa fa-certificate fa-5x cbpln-status-icon"></i>
									</div>
									<div class="col-xs-9 text-right">
										<div class="cbhuge comnelips fntwt600"><?php echo $FCostCentreName; ?></div>
										<div class="cbhuge comnelips">From Project</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres" id="TCompanyName">
						<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status1">
							<div class="padding-none">
								<div class="row">
									<div class="col-xs-3">
										<i class="fa fa-retweet fa-5x cbpln-status-icon"></i>
									</div>
									<div class="col-xs-9 text-right">
										<div class="cbhuge comnelips fntwt600"><?php echo $TCompanyName; ?></div>
										<div class="cbhuge comnelips">To Company</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres" id="TCostCentreName">
						<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status1">
							<div class="padding-none">
								<div class="row">
									<div class="col-xs-3">
										<i class="fa fa-retweet fa-5x cbpln-status-icon"></i>
									</div>
									<div class="col-xs-9 text-right">
										<div class="cbhuge comnelips fntwt600"><?php echo $TCostCentreName; ?></div>
										<div class="cbhuge comnelips">To Project</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres" id="vNo">
						<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status1">
							<div class="padding-none">
								<div class="row">
									<div class="col-xs-3">
										<i class="fa fa-retweet fa-5x cbpln-status-icon"></i>
									</div>
									<div class="col-xs-9 text-right">
										<div class="cbhuge comnelips fntwt600"><?php echo $vNo; ?></div>
										<div class="cbhuge comnelips">Transfer No</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres" id="TVDate">
						<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status2">
							<div class="padding-none">
								<div class="row">
									<div class="col-xs-3">
										<i class="fa fa-calendar fa-5x cbpln-status-icon"></i>
									</div>
									<div class="col-xs-9 text-right">
										<div class="cbhuge comnelips fntwt600"><?php echo $TVDate; ?></div>
										<div class="cbhuge comnelips">Date</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres " id="GPNo">
						<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status5">
							<div class="padding-none">
								<div class="row">
									<div class="col-xs-3">
										<i class="fa fa-registered fa-5x cbpln-status-icon"></i>
									</div>
									<div class="col-xs-9 text-right">
										<div class="cbhuge comnelips fntwt600"><?php echo $GPNo; ?></div>
										<div class="cbhuge comnelips">GP No</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres " id="gpdate">
						<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status6">
							<div class="padding-none">
								<div class="row">
									<div class="col-xs-3">
										<i class="fa fa-money fa-5x cbpln-status-icon"></i>
									</div>
									<div class="col-xs-9 text-right">
										<div class="cbhuge comnelips fntwt600"><?php echo $gpdate; ?></div>
										<div class="cbhuge comnelips">GP Date</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres " id="CTVNo">
						<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status7">
							<div class="padding-none">
								<div class="row">
									<div class="col-xs-3">
										<i class="fa fa-cube fa-5x cbpln-status-icon"></i>
									</div>
									<div class="col-xs-9 text-right">
										<div class="cbhuge comnelips fntwt600"><?php echo $CTVNo; ?></div>
										<div class="cbhuge comnelips">CTransfer No</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres " id="CCTVNo" >
						<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status8">
							<div class="padding-none">
								<div class="row">
									<div class="col-xs-2">
										<i class="fa fa-share fa-5x cbpln-status-icon"></i>
									</div>
									<div class="col-xs-10 text-right">
										<div class="cbhuge comnelips fntwt600"><?php echo $CCTVNo; ?></div>
										<div class="cbhuge comnelips">CCTransfer No</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres " id="PurchaseTypeName">
						<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status3">
							<div class="padding-none">
								<div class="row">
									<div class="col-xs-2">
										<i class="fa fa-star-half-o fa-5x cbpln-status-icon"></i>
									</div>
									<div class="col-xs-10 text-right">
										<div class="cbhuge comnelips fntwt600"><?php echo $PurchaseTypeName; ?></div>
										<div class="cbhuge comnelips">Purchase Type</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres " id="accType" >
						<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status4">
							<div class="padding-none">
								<div class="row">
									<div class="col-xs-2">
										<i class="fa fa-ticket fa-5x cbpln-status-icon"></i>
									</div>
									<div class="col-xs-10 text-right">
										<div class="cbhuge comnelips fntwt600"><?php echo $accType; ?></div>
										<div class="cbhuge comnelips">Account Type</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-lg-12 clear top-20">
				<div id="accordion" class="panel-group">
					<!-------------------------------Bill of Quantities------------------------------->
					<div class="panel panel-info">
						<div data-target="#collapseOne" data-parent="#accordion" data-toggle="collapse" class="panel-heading collapsed panel_heads" id="panelheading-1">
							<h4 class="panel-title accordion-toggle defa_panels">Transfer Quantity</h4>
						</div>
						<div class="panel-collapse collapse" id="collapseOne" style="height: 0px;">
							<div class="panel-body bgcolr">
								<div class="col-lg-12">
									<div class="table-responsive top-10">
										<table class="table table-bordered" style=" margin-bottom:0px;" id="workorderTable">
											<thead>
											<tr>
												<th class="blubg">Description</th>
												<th class="blubg">Unit</th>
												<th class="blubg" style="text-align:center">Qty</th>
												<th class="blubg" style="text-align:center">Rate</th>
												<th class="blubg" style="text-align:center">QRate</th>
												<th class="blubg" style="text-align:center">BaseAmount</th>
												<th class="blubg" style="text-align:center">Amount</th>
												<th class="blubg">&nbsp;</th>

											</tr>
											</thead>
											<tbody class="main"></tbody>
										</table>
										<input type="hidden" name="rowid" id="rowid" value="0"/>
									</div>
									<!----- sequantial view total --------->
									<div class="col-lg-12 padlr0">
										<table class="table" style=" margin-bottom:0px;display:none;" id="seqTotal">
											<tbody class="total" id="listTotal">
											<tr>
												<td colspan="5">&nbsp;</td>
												<td align="right" class="rate_pri">Total Amount</td>
												<td width="10%" >
													<input class="parent_text border-none" type="text" name="total" id="total" readonly/>
													<input type="hidden" name="basetotal" id="basetotal"/>
												</td>
												<td>&nbsp;</td>
											</tr>
											</tbody>
										</table>
									</div>
									<!--------- end --------------->
								</div>
							</div>
						</div>
					</div>
					<!-------------------------------Bill of Quantities end------------------------------->
					<!-------------------------------Others Details------------------------------->
					<div class="panel panel-info">
						<div data-target="#collapseThree" data-parent="#accordion" data-toggle="collapse" class="panel-heading collapsed panel_heads" id="panelheading-3">
							<h4 class="panel-title accordion-toggle defa_panels">Other Details</h4>
						</div>
						<div class="panel-collapse collapse" id="collapseThree" style="height: 0px;">
							<div class="panel-body bgcolr">
								<div class="clearfix"></div>
								<div class="col-lg-12">
									<div class="card" style="margin-top:5px!important;margin-bottom:5px !important;">
										<ul class="nav nav-tabs">
											<li class="active"><a href="#nar" id="narrationTabLink" onclick="showotherstabs('narration')" aria-controls="naration" role="tab" data-toggle="tab">Narration</a></li>
										</ul>
										<div class="tab-content" id="narration">
											<div class="tab-pane active" id="nar">
												<p>
												<div class="col-lg-12 sub_tab">
													<?php
														if(isset($narration)){
													?>
														   <textarea class="exp-tex" name="Narration" id="Narration"> <?php echo (isset($narration)) ? $narration : 'Enter your Notes...';?> </textarea>
													<?php }else{ ?>
															<textarea class="exp-tex" name="Narration" id="Narration" placeholder="Enter your Notes..."></textarea>
														<?php } ?>
												</div>
												</p>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!-------------------------------Others Details------------------------------->
				</div>
			</div>
		</div>
	</div>
</div>

<div class="col-lg-12 savebtn_area">
    <ul>
        <li class="dropdown save_btn float_r">
            <a href="<?php echo $this->basePath();?>/mms/transfer/display-register" class="ripple">Close</a>
        </li>
    </ul>
</div>
<script id="resource-template"  type="text/template" class="hide">
    <?php
        $displayscreen="display:none";
        $displaymaintr="parent_text mainTr";
        if($gridtype==1) {
            $displayscreen="display:none";
            $displaymaintr="parent_text mainTr";
        }
    ?>
    <tr id="click__" class="count-tr">
        <td width="25%" name="desc__" id="desc__" class="border-none">
            <input type="hidden" name="resourceid__" id="resourceid__"/>
        </td>
        <td width="10%" name="unitname__" id="unitname__" class="border-none">
            <input type="hidden" name="unitid__" id="unitid__"/>
            <input type="hidden" name="itemid__" id="itemid__"/>
        </td>
        <td width="12%" name="qty__" id="qty__"  class="border-none" style="text-align:right"></td>
        <td width="15%" name="rate__" id="rate__" class="border-none" style="text-align:right"></td>
        <td width="10%" name="qrate__" id="qrate__" class="border-none" style="text-align:right"></td>
        <td width="15%" name="baseamount__" id="baseamount__" class="border-none" style="text-align:right"></td>
        <td width="15%"  name="amount__" id="amount__" class="border-none" style="text-align:right"></td>
        <td width="10%" align="center" class="action_btns_td">
            <ul class="action_btns">
                <li> <a href="#" class="mainTr" id="expandTr__" style="display:none;"> <i class="fa fa-chevron-circle-down" data-toggle="tooltip" data-placement="left" data-original-title="Add lines" ></i></a> </li>
            </ul>
        </td>
    </tr>

    <tr style="<?php echo $displayscreen; ?>;" class="subTr count-tr">
        <td colspan="9" style="padding:0px !important; ">
            <div class="subDiv" style="<?php echo $displayscreen; ?>;">
                <div class="col-lg-12 col-lg-offset-0 rdbt" style="">
                    <div class="card">
                        <ul class="nav nav-tabs">
                            <li class="active"><a class="ripple has-ripple" id="decisionTabLink__" onclick="showtabs('decision',this.id,event)" style="position: relative; overflow: hidden;cursor:pointer;"> Decision<span class="ripple-wrapper animated" style="width: 89px; height: 89px; top: -41.5px; left: 22.9531px;"></span></a></li>
                            <li class=""><a class="ripple has-ripple" id="qualifierTabLink__" onclick="showtabs('qualifier',this.id,event)" style="position: relative; overflow: hidden;cursor:pointer;"> Qualifier<span class="ripple-wrapper animated" style="width: 105px; height: 105px; top: -29.5px; left: 16.9531px;"></span></a></li>
                            <li class=""><a class="ripple has-ripple" id="whTableLink__" onclick="showtabs('wh',this.id,event)" style="position: relative; overflow: hidden;cursor:pointer;"> Warehouse<span class="ripple-wrapper animated"></span></a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="tab-content">
                        <div class="table-responsive topsp sub_tab">
                            <table class="table table-bordered" style="margin-bottom:0px;" id="decisionTable__">
                                <thead>
                                <tr>
                                    <th class="worktype-activity highlight1">Decision No</th>
                                    <th class="worktype-activity highlight1" style="text-align:center">BalQty</th>
                                    <th class="worktype-activity highlight1" style="text-align:center">Qty</th>
                                    <th class="iow___requestfields worktype-activity highlight1"></th>
                                </tr>
                                </thead>
                                <tbody class="main"></tbody>
                                <tbody class="total">
                                </tbody>
                                <input type="hidden" name="iow___rowid" id="iow___rowid" value="0"/>
                            </table>
                            <table class="table " style="margin-bottom:0px; display: none;" id="qualifierTable__" onchange="CalculateRate(this.id)">
                            </table>                           
                            <div class="tab-content">
                                <div class="table-responsive topsp">
                                    <table class="table" style="margin-bottom:0px; display: none;" id="reqspeTable__">
                                        <tbody class="main"></tbody>
                                        <tbody class="total">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </td>
    </tr>
</script>

<script id="iow-template"  type="text/template" class="hide">
    <tr class="dont-hide">
        <td width="38%" class="worktype-activity" name="iow___decisionno_0" id="iow___decisionno_0" >
            <input type="hidden" name="iow___decisionid_0" id="iow___decisionid_0"/>
            <input type="hidden" name="iow___dectransid_0" id="iow___dectransid_0"/>
            <input type="hidden" name="iow___reqtransid_0" id="iow___reqtransid_0"/>
            <input type="hidden" name="iow___resourceid_0" id="iow___resourceid_0"/>
            <input type="hidden" name="iow___itemid_0" id="iow___itemid_0"/>
        </td>
        <td width="30%" name="iow___balqty_0" id="iow___balqty_0" style="text-align:center"></td>
        <td width="30%" name="iow___qty_0" id="iow___qty_0" style="text-align:center">
            <input type="hidden" name="iow__hiddenqty_0" id="iow__hiddenqty_0"/>
        </td>
        <td width="2%" align="center" class="action_btns_td iow___requestfields" style="display:none">
            <ul class="action_btns">
                <li><a href="#" class="mainTr"> <i class="fa fa-chevron-circle-down" data-toggle="tooltip" data-placement="left" data-original-title="Add lines" ></i></a> </li>
            </ul>
        </td>
    </tr>
    <tr style="<?php echo $displayscreen; ?>" class="subTr dont-hide">
        <td colspan="9" style="padding:5px !important;">
            <div class="subDiv" style="<?php echo $displayscreen; ?>">
                <div class="table-responsive topsp sub_tab" style="margin-bottom:5px;">
                    <table class="table table-bordered" style="margin-bottom:5px;" id="whTable___wbs_0_whreqno">
                        <thead>
                        <tr>
                            <th class="worktype-activity highlight">Warehouse Name </th>
                            <th class="worktype-activity highlight">Description </th>
                            <th class="worktype-activity highlight" style="text-align:center">ClosingStock </th>
                            <th class="worktype-activity highlight" style="text-align:center">Qty </th>
                            <th class="highlight" style="display: none;">&nbsp;</th>
                        </tr>
                        </thead>
                        <tbody class="ware"></tbody>
                        <tbody class="total">
                        </tbody>

                    </table>
                    <input type="hidden" name="wh___wbs_0_wrowid" id="wh___wbs_0_wrowid" value="0"/>
                </div>
            </div>
        </td>
    </tr>
</script>
<script id="issue-warehouse"  type="text/template" class="hide">
    <tr class="subTr dont-hide er">
        <td width="20%" name="wh___wbs_0_warehousename__7" id="wh___wbs_0_warehousename__7">
            <input type="hidden" name="wh___wbs_0_warehouseid__7" id="wh___wbs_0_warehouseid__7"/>
            <input  type="hidden" name="wh___wbs_0_stockid__7" id="wh___wbs_0_stockid__7" />
        </td>
        <td width="20%" name="wh___wbs_0_desc__7" id="wh___wbs_0_desc__7"></td>
        <td width="20%" name="wh___wbs_0_closingstock__7" id="wh___wbs_0_closingstock__7" style="text-align:center"></td>
        <td width="20%" name="wh___wbs_0_qty__7" id="wh___wbs_0_qty__7" style="text-align:center">
            <input type="hidden" name="wh___wbs_0_hiddenqty__7" id="wh___wbs_0_hiddenqty__7" value="0"/>
        </td>
    </tr>
</script>
<script type="text/javascript">
var arr_resources = <?php echo (isset($arr_resources)) ? json_encode($arr_resources) : '[]';?>;
var tmp_arr_resources = arr_resources;
var arr_requestResources = <?php echo (isset($arr_requestResources)) ? json_encode($arr_requestResources) : '[]';?>;
var arr_resource_iows = <?php echo (isset($arr_resource_iows)) ? json_encode($arr_resource_iows) : '[]';?>;
var arr_resource_iow_requests = <?php echo (isset($arr_resource_iow_requests)) ? json_encode($arr_resource_iow_requests) : '[]';?>;
var arr_sel_warehouse = <?php echo (isset($arr_sel_warehouse)) ? json_encode($arr_sel_warehouse) : '[]';?>;
var arr_sel_tvwarehouse = <?php echo (isset($arr_sel_tvwarehouse)) ? json_encode($arr_sel_tvwarehouse) : '[]';?>;
var mode = <?php echo $tranRegId; ?>;
var qualiferHTML = '<?php echo (isset($qualHtml)) ? preg_replace('~>\s+<~', '><',$qualHtml) : '';?>';
$(function () {
    var $rowid = $('#rowid');
    var template = $('#resource-template').html();
    var iowtemplate = $('#iow-template').html();
    var waretemplate = $('#iow-warehouse').html();
    var requesttemplate = $('#issue-warehouse').html();

    var rowid = 0;
    var $tbody = $('#workorderTable').find('> tbody.main');
    if(arr_requestResources.length != 0) {

        $.each(arr_requestResources, function(i, o) {
            rowid += 1;
            $tbody.append(template.replace(/__/g, '_' + rowid));
            $('#desc_' + rowid).html(o.Desc);
            $('#resourceid_' + rowid).val(o.ResourceId);
            $('#itemid_' + rowid).val(o.ItemId);
            $('#unitname_' + rowid).html(o.UnitName);
            $('#unitid_' + rowid).val(o.UnitId);
            $('#qty_' + rowid).html(o.Qty);
            $('#rate_' + rowid).html(o.Rate);
            $('#qrate_' + rowid).html(o.QRate);
            $('#baseamount_' + rowid).html(o.BaseAmount);
            $('#amount_' + rowid).html(o.Amount);
            $('#hiddenqty_' + rowid).val(o.HiddenQty);
            $('#expandTr_' + rowid).show();
            $('#deleteTr_' + rowid).show();
            $('#expandSt_' + rowid).show();
            $('#expandRt_' + rowid).show();

            var whsCount = 0;
            var wbsCount = 0;

            $.each(arr_resource_iows, function (j, l) {
                if ((l.ResourceId != o.ResourceId || l.ItemId != o.ItemId)) {
                    return;
                }
                if(mode != 0) {
                    var iowrowid = parseInt($('#iow_' + rowid + '_rowid').val()) + 1;
                    $('#decisionTable_' + rowid).find('> tbody.main').append(iowtemplate.replace(/__/g, '_' + rowid).replace(/_0/g, '_' + iowrowid));
                    $('#iow_' + rowid + '_rowid').val(iowrowid);
                    wbsCount = wbsCount + 1;

                    /////////////////////////////////////
                    if (<?php echo (isset($tranRegId)) ? $tranRegId : 0;?> > 0 ) {
                        var RId = o.ResourceId;
                        var ItId = o.ItemId;
                        var tRegId = <?php echo (isset($tranRegId)) ? $tranRegId : 0;?>;
                        $.ajax({
                            url: getBaseURL() + 'mms/transfer/detailed',
                            type: "post",
                            data: "ResourceId=" + RId + "&tRId=" + tRegId + "&ItemId=" + ItId + "&Type=getqualdetails",
                            async: false,
                            success: function (data, textStatus, jqXHR) {
                                if (jqXHR.status == 200) {
                                    data = JSON.parse(data);
                                    $('#qualifierTable_' + rowid).html(data.replace(/__1/g, '_' + rowid));
									$('.qualChange').attr('disabled',true);
                                }
                                $('.loading_area').hide();
                            }, error: function (jqXHR, textStatus, errorThrown) {
                                $('.loading_area').hide();
                            }
                        });
                    }else{
						$('#qualifierTable_' + rowid).html(qualiferHTML.replace(/__1/g, '_' + rowid));
					}

                    $('#iow_' + rowid + '_decisionid_' + iowrowid).val(l.DecisionId);
                    $('#iow_' + rowid + '_dectransid_' + iowrowid).val(l.DecTransId);
                    $('#iow_' + rowid + '_reqtransid_' + iowrowid).val(l.ReqTransId);
                    $('#iow_' + rowid + '_resourceid_' + iowrowid).val(l.ResourceId);
                    $('#iow_' + rowid + '_itemid_' + iowrowid).val(l.ItemId);
                    $('#iow_' + rowid + '_decisionno_' + iowrowid).html(l.DecisionNo);
                    $('#iow_' + rowid + '_balqty_' + iowrowid).html(l.BalQty);
                    $('#iow_' + rowid + '_qty_' + iowrowid).html(l.Qty);
                    $('#iow_' + rowid + '_hiddenqty_' + iowrowid).val(l.HiddenQty);
                    //start warehouse
  
                    if (arr_sel_tvwarehouse.length != 0) {
                        var findReturnWH = arr_sel_tvwarehouse.filter(function (obj) {
                            return (obj.ResourceId === o.ResourceId && obj.ItemId === o.ItemId);
                        });
                        if (findReturnWH.length > 0) {
                            $.each(arr_sel_tvwarehouse, function (m, n) {
                                if (o.ResourceId != n.ResourceId || o.ItemId != n.ItemId) {
                                    return;
                                }
                                whsCount = whsCount+1;
                                var whrowid = parseInt($('#wh_' + rowid + '_wbs_' + iowrowid + '_wrowid').val()) + 1;
                                $('.iow_' + rowid + '_requestfields').show();
                                $('#whTable_' + rowid + '_wbs_' + iowrowid + '_whreqno').find('> tbody.ware').append(requesttemplate
                                    .replace(/__7/g, '_' + whrowid)
                                    .replace(/_0/g, '_' + iowrowid)
                                    .replace(/__/g, '_' + rowid));

                                $('#wh_' + rowid + '_wbs_' + iowrowid + '_wrowid').val(whrowid);
                                $('#wh_' + rowid + '_wbs_' + iowrowid + '_warehouseid_' + whrowid).val(n.WareHouseId);
                                $('#wh_' + rowid + '_wbs_' + iowrowid + '_warehousename_' + whrowid).html(n.WareHouseName);
                                $('#wh_' + rowid + '_wbs_' + iowrowid + '_stockid_' + whrowid).val(n.StockId);
                                $('#wh_' + rowid + '_wbs_' + iowrowid + '_desc_' + whrowid).html(n.Description);
                                $('#wh_' + rowid + '_wbs_' + iowrowid + '_qty_' + whrowid).html(n.Qty);
                                $('#wh_' + rowid + '_wbs_' + iowrowid + '_closingstock_' + whrowid).html(n.ClosingStock);
                                $('#wh_' + rowid + '_wbs_' + iowrowid + '_hiddenqty_' + whrowid).html(n.Qty);
                            });
                        }
                    }
                    if (whsCount == 0) {
                        $('#whTable_' + rowid + '_wbs_' + iowrowid + '_whreqno').hide();
                        $('#iow_' + rowid + '_qty_' + iowrowid).removeClass('mainTr');
                        $('#iow_' + rowid + '_qty_' + iowrowid).attr('onchange', 'calcDecQuantity(this)');
                        $('#iow_' + rowid + '_qty_' + iowrowid).prop("readonly", false);
                    }
                    //end of warehouse
                } else{

                    var iowrowid = parseInt($('#iow_' + rowid + '_rowid').val()) + 1;
                    $('#decisionTable_' + rowid).find('> tbody.main').append(iowtemplate.replace(/__/g, '_' + rowid).replace(/_0/g, '_' + iowrowid));
                    $('#iow_' + rowid + '_rowid').val(iowrowid);
                    wbsCount = wbsCount + 1;
                    $('#iow_' + rowid + '_decisionid_' + iowrowid).val(l.DecisionId);
                    $('#iow_' + rowid + '_dectransid_' + iowrowid).val(l.DecTransId);
                    $('#iow_' + rowid + '_reqtransid_' + iowrowid).val(l.ReqTransId);
                    $('#iow_' + rowid + '_resourceid_' + iowrowid).val(l.ResourceId);
                    $('#iow_' + rowid + '_itemid_' + iowrowid).val(l.ItemId);
                    $('#iow_' + rowid + '_decisionno_' + iowrowid).html(l.DecisionNo);
                    $('#iow_' + rowid + '_balqty_' + iowrowid).html(l.BalQty);
                    $('#iow_' + rowid + '_qty_' + iowrowid).html(l.Qty);
                    $('#iow_' + rowid + '_hiddenqty_' + iowrowid).val(l.HiddenQty);
                    $('#qualifierTable_' + rowid).html(qualiferHTML.replace(/__1/g, '_' + rowid));
                    //start warehouse
                    if (arr_sel_warehouse.length != 0) {
                        var findReturnWH = arr_sel_warehouse.filter(function (obj) {
                            return (obj.ResourceId === o.ResourceId && obj.ItemId === o.ItemId);
                        });
                        if (findReturnWH.length > 0) {
                            $.each(arr_sel_warehouse, function (m, n) {
                                if (o.ResourceId != n.ResourceId || o.ItemId != n.ItemId) {
                                    return;
                                }
                                whsCount = whsCount+1;
                                var whrowid = parseInt($('#wh_' + rowid + '_wbs_' + iowrowid + '_wrowid').val()) + 1;
                                $('#whTable_' + rowid + '_wbs_' + iowrowid + '_whreqno').find('> tbody.ware').append(requesttemplate
                                    .replace(/__7/g, '_' + whrowid)
                                    .replace(/_0/g, '_' + iowrowid)
                                    .replace(/__/g, '_' + rowid));

                                $('#wh_' + rowid + '_wbs_' + iowrowid + '_wrowid').val(whrowid);
                                $('#wh_' + rowid + '_wbs_' + iowrowid + '_warehouseid_' + whrowid).val(n.WareHouseId);
                                $('#wh_' + rowid + '_wbs_' + iowrowid + '_warehousename_' + whrowid).html(n.WareHouseName);
                                $('#wh_' + rowid + '_wbs_' + iowrowid + '_stockid_' + whrowid).val(n.StockId);
                                $('#wh_' + rowid + '_wbs_' + iowrowid + '_desc_' + whrowid).html(n.Description);
                                $('#wh_' + rowid + '_wbs_' + iowrowid + '_qty_' + whrowid).html(n.Qty);
                                $('#wh_' + rowid + '_wbs_' + iowrowid + '_closingstock_' + whrowid).html(n.ClosingStock);
                                $('#wh_' + rowid + '_wbs_' + iowrowid + '_hiddenqty_' + whrowid).val(n.Qty);
                            });
                        } else {
                            $('.er').hide();
                        }
                    }
                    if(whsCount == 0){
                        $('#whTable_' + rowid + '_wbs_' + iowrowid + '_whreqno').hide();
                        $('#iow_' + rowid + '_qty_' + iowrowid).removeClass('mainTr');
                        $('#iow_' + rowid + '_qty_' + iowrowid).attr('onchange', 'calcDecQuantity(this)');
                        $('#iow_' + rowid + '_qty_' + iowrowid).prop("readonly", false);
                    }
                    //end of warehouse
                }
                $('#whTableLink_' + rowid).hide();
            });
            if(wbsCount == 0){
                $('#qty_' + rowid).attr('onfocus', 'calcQty(this)');
                $('#qty_' + rowid).prop("readonly", false);
            }
        });
    }
    rowid += 1;
    $rowid.val(rowid);
    $('#seqTotal').show();

    $('.content_wrapper').on('click','.mainTr',function(e){
        e.preventDefault();
        if(!$(this).closest("tr").next(".subTr").is(":visible")){
            $(this).closest("tr").next(".subTr").show();
            $(this).closest("tr").next(".subTr").find(".subDiv").slideDown("slow");
            $(this).find("i").addClass("tform");
        }
        else{
            $(this).closest("tr").next(".subTr").find(".subDiv").slideUp("slow");
            $(this).closest("tr").next(".subTr").slideUp("slow");
            $(this).find("i").removeClass("tform");
        }
    });
    nextAccordian(1);
});
function checkWarehouse(x){
    var $x = $(x);
    var ids = $x[0].id.split('_');
    var rowid = ids[1];
    var iowrowid = ids[3];

    $('#whTable_' + rowid + '_wbs_' + iowrowid + '_whreqno').show();
}
function showtabs(type,id,event) {
    event.preventDefault();
    $('#' + id).parent('li').addClass('active').siblings('li').removeClass('active');
    var rowid = id.split('_')[1];
    if (type=="decision") {
        $('#decisionTable_'+rowid).show();
        $('#qualifierTable_'+rowid).hide();
        $('#whTable_'+rowid).hide();

    } else if (type=="qualifier") {
        $('#qualifierTable_'+rowid).show();
        $('#decisionTable_'+rowid).hide();
        $('#whTable_'+rowid).hide();
    }
    else
    {
        $('#whTable_'+rowid).show();
        $('#decisionTable_'+rowid).hide();
        $('#qualifierTable_'+rowid).hide();

    }
    return false;
}
function nextAccordian(id) {
    $('#panelheading-' + id).trigger('click');
}
var FCompanyName= <?php echo json_encode ($FCompanyName);?>;
var FCostCentreName= <?php echo json_encode ($FCostCentreName);?>;
var TCompanyName= <?php echo json_encode ($TCompanyName);?>;
var TCostCentreName= <?php echo json_encode ($TCostCentreName);?>;
var vNo= <?php echo json_encode ($vNo);?>;
var TVDate= <?php echo json_encode ($TVDate);?>;
var GPNo= <?php echo json_encode ($GPNo);?>;
var gpdate= <?php echo json_encode ($gpdate);?>;
var CTVNo= <?php echo json_encode ($CTVNo);?>;
var CCTVNo= <?php echo json_encode ($CCTVNo);?>;
var PurchaseTypeName= <?php echo json_encode ($PurchaseTypeName);?>;
var accType= <?php echo json_encode ($accType);?>;
if(FCompanyName == ''|| FCompanyName == null) {
	$('#FCompanyName').hide();
} 
if(FCostCentreName == ''|| FCostCentreName == null){
	$('#FCostCentreName').hide();
} 
if(TCompanyName == ''|| TCompanyName == null){
	$('#TCompanyName').hide();
} 
if(TCostCentreName == ''|| TCostCentreName == null){
	$('#TCostCentreName').hide();
} 
if(vNo == ''|| vNo == null){
	$('#vNo').hide();
} 
if(TVDate == ''|| TVDate == null){
	$('#TVDate').hide();
} 
if(GPNo == ''|| GPNo == null){
	$('#GPNo').hide();
} 
if(gpdate == ''|| gpdate == null){
	$('#gpdate').hide();
}
if(CTVNo == ''|| CTVNo == null){
	$('#CTVNo').hide();
}
if(CCTVNo == ''|| CCTVNo == null){
	$('#CCTVNo').hide();
}
if(PurchaseTypeName == ''|| PurchaseTypeName == null){
	$('#PurchaseTypeName').hide();
}
if(accType == ''|| accType == null){
	$('#accType').hide();
}
</script>	