<link rel="stylesheet" href="<?php echo $this->basePath() . '/css/mms.css'; ?>" />
	
<style type="text/css">
	.mar_20{margin-top:20px!important;}
	.jqx-widget-content {z-index:999 !important;}
	.top-10 {padding-top: 10px !important;}
	.blubg{background : #B0C3EB !important;}
	.card{margin-top:0% !important; margin-bottom:0px !important;}
	.btnPrev:disabled {background-color:#ffffff;}
	.sub_tab {background-color: #e7e9ec;border: 1px solid #ddd;float: left;margin-top: 2px;padding:8px;width:100%;}
	.subDiv {background-color: #fff!important;border: 0px solid #ddd !important;float: left;margin-left: 2%;margin-top: 2px;position: relative;width: 98%;}
	.highlight{background : #bfefd6 !important;}
	.highlight1{background : #e6bfcb !important;}
	.topsp{margin-bottom:5px !important;}
</style>
	<div class="container-fluid">
		<div class="row">
			<div class="col-lg-12 mar_20">
				<h1 style="margin-left:10px;">Transfer Detail<span class="edit_symbl">_<?php echo $TVNo; ?></span>&nbsp;&nbsp;</h1>
			</div>
			<div class="col-lg-12">
				<div class="col-lg-12 col-lg-offset-0 col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0 clear padlr0">
					<div class="col-lg-12 clear padlr0">
						<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres">
							<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status3">
								<div class="padding-none">
									<div class="row">
										<div class="col-xs-3">
											<i class="fa fa-bandcamp fa-5x cbpln-status-icon"></i>
										</div>
										<div class="col-xs-9 text-right">
											<div class="cbhuge comnelips fntwt600"><?php echo $fcompanyName; ?></div>
											<div class="cbhuge comnelips">From Company</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres">
							<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status4">
								<div class="padding-none">
									<div class="row">
										<div class="col-xs-3">
											<i class="fa fa-certificate fa-5x cbpln-status-icon"></i>
										</div>
										<div class="col-xs-9 text-right">
											<div class="cbhuge comnelips fntwt600"><?php echo $fcostcentre; ?></div>
											<div class="cbhuge comnelips">From Project</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres">
							<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status1">
								<div class="padding-none">
									<div class="row">
										<div class="col-xs-3">
											<i class="fa fa-retweet fa-5x cbpln-status-icon"></i>
										</div>
										<div class="col-xs-9 text-right">
											<div class="cbhuge comnelips fntwt600"><?php echo $tcompanyName; ?></div>
											<div class="cbhuge comnelips">To Company</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres">
							<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status1">
								<div class="padding-none">
									<div class="row">
										<div class="col-xs-3">
											<i class="fa fa-retweet fa-5x cbpln-status-icon"></i>
										</div>
										<div class="col-xs-9 text-right">
											<div class="cbhuge comnelips fntwt600"><?php echo $tcostcentre; ?></div>
											<div class="cbhuge comnelips">To Project</div>
										</div>
									</div>
								</div>
							</div>
						</div>

					</div>
					<div class="col-lg-12 clear padlr0">
						<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres">
							<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status1">
								<div class="padding-none">
									<div class="row">
										<div class="col-xs-3">
											<i class="fa fa-retweet fa-5x cbpln-status-icon"></i>
										</div>
										<div class="col-xs-9 text-right">
											<div class="cbhuge comnelips fntwt600"><?php echo $TVNo; ?></div>
											<div class="cbhuge comnelips">Transfer No</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres">
							<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status2">
								<div class="padding-none">
									<div class="row">
										<div class="col-xs-3">
											<i class="fa fa-calendar fa-5x cbpln-status-icon"></i>
										</div>
										<div class="col-xs-9 text-right">
											<div class="cbhuge comnelips fntwt600"><?php echo $TVDate; ?></div>
											<div class="cbhuge comnelips">Date</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres ">
							<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status5">
								<div class="padding-none">
									<div class="row">
										<div class="col-xs-3">
											<i class="fa fa-registered fa-5x cbpln-status-icon"></i>
										</div>
										<div class="col-xs-9 text-right">
											<div class="cbhuge comnelips fntwt600"><?php echo $GPNo; ?></div>
											<div class="cbhuge comnelips">GP No</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres ">
							<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status6">
								<div class="padding-none">
									<div class="row">
										<div class="col-xs-3">
											<i class="fa fa-money fa-5x cbpln-status-icon"></i>
										</div>
										<div class="col-xs-9 text-right">
											<div class="cbhuge comnelips fntwt600"><?php echo $GPDate; ?></div>
											<div class="cbhuge comnelips">GP Date</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-lg-12 clear padlr0">
						<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres ">
							<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status7">
								<div class="padding-none">
									<div class="row">
										<div class="col-xs-3">
											<i class="fa fa-cube fa-5x cbpln-status-icon"></i>
										</div>
										<div class="col-xs-9 text-right">
											<div class="cbhuge comnelips fntwt600"><?php echo $CTVNo; ?></div>
											<div class="cbhuge comnelips">CTransfer No</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres ">
							<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status8">
								<div class="padding-none">
									<div class="row">
										<div class="col-xs-2">
											<i class="fa fa-share fa-5x cbpln-status-icon"></i>
										</div>
										<div class="col-xs-10 text-right">
											<div class="cbhuge comnelips fntwt600"><?php echo $CCTVNo; ?></div>
											<div class="cbhuge comnelips">CCTransfer No</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres ">
							<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status3">
								<div class="padding-none">
									<div class="row">
										<div class="col-xs-2">
											<i class="fa fa-star-half-o fa-5x cbpln-status-icon"></i>
										</div>
										<div class="col-xs-10 text-right">
											<div class="cbhuge comnelips fntwt600"><?php echo $PurchaseTypeName; ?></div>
											<div class="cbhuge comnelips">Purchase Type</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres ">
							<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status4">
								<div class="padding-none">
									<div class="row">
										<div class="col-xs-2">
											<i class="fa fa-ticket fa-5x cbpln-status-icon"></i>
										</div>
										<div class="col-xs-10 text-right">
											<div class="cbhuge comnelips fntwt600"><?php echo $accType; ?></div>
											<div class="cbhuge comnelips">Account Type</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					
					<div class="col-lg-12 clear padlr0">
						<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres">
							<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status3">
								<div class="padding-none">
									<div class="row">
										<div class="col-xs-3">
											<i class="fa fa-bandcamp fa-5x cbpln-status-icon"></i>
										</div>
										<div class="col-xs-9 text-right">
											<div class="cbhuge comnelips fntwt600"><?php echo $ReceiptDate; ?></div>
											<div class="cbhuge comnelips">Receipt Date</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres">
							<div class="cbpln cbpln-default bx-wte cbpln-status cbpln-status4">
								<div class="padding-none">
									<div class="row">
										<div class="col-xs-3">
											<i class="fa fa-certificate fa-5x cbpln-status-icon"></i>
										</div>
										<div class="col-xs-9 text-right">
											<div class="cbhuge comnelips fntwt600"><?php echo $DespatchDate; ?></div>
											<div class="cbhuge comnelips">Dispatch Date</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 mnimumwidthres">
							<div class="cbpln cbpln-default  bx-wte cbpln-status cbpln-status1">
								<div class="padding-none">
									<div class="row">
										<div class="col-xs-3">
											<i class="fa fa-retweet fa-5x cbpln-status-icon"></i>
										</div>
										<div class="col-xs-9 text-right">
											<div class="cbhuge comnelips fntwt600"><?php echo $Approve; ?></div>
											<div class="cbhuge comnelips">Approve</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div id="accordion" class="panel-group">
			<!-------------------------------Bill of Quantities------------------------------->
			<div class="panel panel-info">
				<div data-target="#collapseOne" data-parent="#accordion" data-toggle="collapse" class="panel-heading collapsed panel_heads" id="panelheading-1">
					<h4 class="panel-title accordion-toggle defa_panels">Transfer Quantity</h4>
				</div>
				<div class="panel-collapse collapse" id="collapseOne" style="height: 0px;">
					<div class="panel-body bgcolr">
						<div class="col-lg-12">
							<div class="table-responsive top-10">
								<table class="table table-bordered" style=" margin-bottom:10px;" id="workorderTable">
									<thead>
									<tr>
										<th class="blubg" >Description</th>
										<th class="blubg" >Unit</th>
										<th class="blubg" style="text-align:center" >TransferQty</th>
										<th class="blubg" style="text-align:center" >RecdQty</th>
										<th class="blubg" style="text-align:center" >AdjustmentQty</th>
										<th class="blubg" style="text-align:center" >Rate</th>
										<th class="blubg" style="text-align:center" >Amount</th>
										<th class="blubg" >&nbsp;</th>
									</tr>
									</thead>
									<tbody class="main"></tbody>
									<tbody class="total">
									<tr>
										<td colspan="5"></td>
										<td align="right" class="rate_pri">Total Amount</td>
										<td width="20%" >
											<input class="parent_text border-none" style="text-align:right" type="text" name="total" id="total" value="<?php echo $amount; ?>" data-tot="0" readonly/>
											<input type="hidden" name="basetotal" id="basetotal"/>
										</td>
										<td>&nbsp;</td>
									</tr>
									</tbody>
								</table>
								<input type="hidden" name="rowid" id="rowid" value="0"/>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-------------------------------Bill of Quantities end------------------------------->

			<!-------------------------------Others Details------------------------------->
			<div class="panel panel-info">
				<div data-target="#collapseThree" data-parent="#accordion" data-toggle="collapse" class="panel-heading collapsed panel_heads" id="panelheading-3">
					<h4 class="panel-title accordion-toggle defa_panels">Other Details</h4>
				</div>
				<div class="panel-collapse collapse" id="collapseThree" style="height: 0px;">
					<div class="panel-body bgcolr">
						<div class="clearfix"></div>
						<div class="col-lg-12">
							<div class="card" style="margin-top:5px!important;margin-bottom:5px !important;">
								<ul class="nav nav-tabs">
									<li class="active"><a href="#nar" id="narrationTabLink" onclick="showotherstabs('narration')" aria-controls="naration" role="tab" data-toggle="tab">Narration</a></li>
								</ul>
								<div class="tab-content" id="narration">
									<div class="tab-pane active" id="nar">
										<p>
										<div class="col-lg-12 sub_tab">
											<?php
											if(isset($narration)){
												?>
												<textarea class="exp-tex btnPrev" name="narration" id="narration" disabled > <?php echo (isset($narration)) ? $narration : 'Enter your Notes';?> </textarea>
											<?php }else{ ?>
												<textarea class="exp-tex btnPrev" name="narration" id="narration" placeholder="Enter your Notes..." disabled></textarea>
											<?php } ?>
										</div>
										</p>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-------------------------------Others Details------------------------------->
		</div>
	</div>
	<div class="col-lg-12 savebtn_area">
		<ul>
			<li class="dropdown save_btn float_r">
				<a href="<?php echo $this->basePath();?>/mms/transfer/tvreceipt-register" class="ripple">Close</a>
			</li>
		</ul>
	</div>
<script id="resource-template"  type="text/template" class="hide">
    <tr class="count-tr">
        <td width="35%" name="desc__" id="desc__" class="border-none">
            <input type="hidden" name="resourceid__" id="resourceid__"/>
        </td>
        <td width="8%" name="unitname__" id="unitname__" class="border-none">
            <input type="hidden" name="unitid__" id="unitid__"/>
            <input type="hidden" name="itemid__" id="itemid__"/>
            <input type="hidden" name="transfertransId__" id="transfertransId__"/>
        </td>
        <td width="10%" name="tqty__" id="tqty__" class="border-none" style="text-align:right"></td>
        <td width="10%" name="rqty__" id="rqty__" class="border-none" style="text-align:right"></td>
        <td width="12%" name="aqty__" id="aqty__" class="border-none" style="text-align:right"></td>
        <td width="10%" name="rate__" id="rate__" class="border-none" style="text-align:right"></td>
        <td width="12%" name="amount__" id="amount__" class="border-none" style="text-align:right"></td>
        <td width="3%" align="center" class="action_btns_td">
            <ul class="action_btns">
                <li><a href="#" class="mainTr" id="expandTr__" style="display:none;"> <i class="fa fa-chevron-circle-down" data-toggle="tooltip" data-placement="left" data-original-title="Add lines" ></i></a></li>
            </ul>
        </td>
    </tr>
    <tr style="display:none"  class="subTr count-tr">
        <td colspan="9" style="padding:1px !important;">
            <div class="subDiv" style="">
                <div class="col-lg-12 col-lg-offset-0 rdbt" style="">
                    <div class="card">
                        <ul class="nav nav-tabs">
                            <li class="active"><a class="ripple has-ripple" id="decisionTabLink__" onclick="showtabs('decision',this.id,event)" style="position: relative; overflow: hidden;cursor:pointer;"> Decision<span class="ripple-wrapper animated" style="width: 89px; height: 89px; top: -41.5px; left: 22.9531px;"></span></a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="tab-content">
                        <div class="table-responsive topsp sub_tab">
                            <table class="table" style="margin-bottom:5px;" id="decisionTable__">
                                <thead>
                                <tr>
                                    <th class="highlight">Decision No</th>
                                    <th class="highlight">Request No</th>
                                    <th class="highlight" style="text-align:center">TransferQty</th>
                                    <th class="highlight" style="text-align:center">ReceiptQty</th>
                                    <th class="iow___requestfields highlight" style="display: none;">&nbsp;</th>
                                </tr>
                                </thead>
                                <tbody class="main"></tbody>
                                <tbody class="total">
                                </tbody>
                                <input type="hidden" name="iow___rowid" id="iow___rowid" value="0"/>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </td>
    </tr>
</script>
<script id="iow-po-warehouse"  type="text/template" class="hide">
    <tr class="subTr dont-hide">
        <td width="40%" name="wh___po_0_warehousename_4" id="wh___po_0_warehousename_4">
            <input type="hidden" name="wh___po_0_warehouseid_4" id="wh___po_0_warehouseid_4"/>
            <input  type="hidden" name="wh___po_0_costcentreid_4" id="wh___po_0_costcentreid_4" />
        </td>
        <td width="40%" name="wh___po_0_desc_4" id="wh___po_0_desc_4"></td>
        <td width="20%" name="wh___po_0_qty_4" id="wh___po_0_qty_4" style="text-align:center">
            <input type="hidden" name="wh___po_0_hdqty_4" id="wh___po_0_hdqty_4" value="0"/>
        </td>
    </tr>
</script>

<script id="iow-template"  type="text/template" class="hide">
    <tr class="dont-hide">
        <td width="23%" class="worktype-activity" name="iow___decisionno_0" id="iow___decisionno_0" >
            <input type="hidden" name="iow___dectransid_0" id="iow___dectransid_0"/>
            <input type="hidden" name="iow___ipdprojtransid_0" id="iow___ipdprojtransid_0"/>
            <input type="hidden" name="iow___ipdtransid_0" id="iow___ipdtransid_0"/>
            <input type="hidden" name="iow___reqtransid_0" id="iow___reqtransid_0"/>
            <input type="hidden" name="iow___resourceid_0" id="iow___resourceid_0"/>
            <input type="hidden" name="iow___itemid_0" id="iow___itemid_0"/>
            <input type="hidden" name="iow___unitid_0" id="iow___unitid_0"/>
        </td>
        <td width="23%" name="iow___reno_0" id="iow___reno_0"></td>
        <td width="25%" name="iow___trqty_0" id="iow___trqty_0" style="text-align:right"></td>
        <td width="25%" name="iow___reqty_0" id="iow___reqty_0" style="text-align:right">
            <input type="hidden" name="iow__hiddenqty_0" id="iow__hiddenqty_0"/>
        </td>
        <td width="4%" align="center" class="action_btns_td iow___requestfields">
            <ul class="action_btns">
                <li><a href="#" class="mainTr"> <i class="fa fa-chevron-circle-down" data-toggle="tooltip" data-placement="left" data-original-title="Add lines" ></i></a> </li>
            </ul>
        </td>
    </tr>
    <tr style="display:none" class="subTr dont-hide">
        <td colspan="9" style="padding:0px !important; ">
			<div class="subDiv" style="">
				<div class="col-lg-12 col-lg-offset-0 rdbt" style="margin-top:0px;">
					<div class="table-responsive topsp sub_tab">
						<table class="table" style="margin-bottom:5px;" id="sec___po_0_whreqno">

						</table>
						<input type="hidden" name="iow___request_0_rowid" id="iow___request_0_rowid" value="0"/>
						<input type="hidden" name="wh___po_0_wrowid" id="wh___po_0_wrowid" value="0"/>
					</div>
				</div>
            </div>
        </td>
    </tr>
</script>
<script id="request-template"  type="text/template" class="hide dont-hide">
    <tr>
        <td width="25%" name="iow___request_0_wbsname__9" id="iow___request_0_wbsname__9">
            <input type="hidden" name="iow___request_0_dectransid__9" id="iow___request_0_dectransid__9"/>
            <input type="hidden" name="iow___request_0_decatransid__9" id="iow___request_0_decatransid__9"/>
            <input type="hidden" name="iow___request_0_analysisid__9" id="iow___request_0_analysisid__9"/>
            <input type="hidden" name="iow___request_0_unitid__9" id="iow___request_0_unitid__9"/>
            <input type="hidden" name="iow___request_0_itemid__9" id="iow___request_0_itemid__9"/>
            <input type="hidden" name="iow___request_0_resourceid__9" id="iow___request_0_resourceid__9"/>
            <input type="hidden" name="iow___request_0_ipdptid__9" id="iow___request_0_ipdptid__9"/>
            <input type="hidden" name="iow___request_0_reqtransid__9" id="iow___request_0_reqtransid__9"/>
            <input type="hidden" name="iow___request_0_reqahtransid__9" id="iow___request_0_reqahtransid__9"/>
        </td>

        <td width="25%" name="iow___request_0_plevel__9" id="iow___request_0_plevel__9"></td>
        <td width="25%" name="iow___request_0_balqty__9" id="iow___request_0_balqty__9" style="text-align:right"></td>
        <td width="25%" name="iow___request_0_rqty__9" id="iow___request_0_rqty__9" style="text-align:right"></td>
		<td width="2%" align="center" class="action_btns_td border-none iow___requestfields_0_wbs" style="display:none">
            <ul class="action_btns">
                <li> <a href="#" class="mainTr"> <i class="fa fa-chevron-circle-down" data-toggle="tooltip" data-placement="left" data-original-title="Add lines" ></i></a> </li>
            </ul>
        </td>
    </tr>
    <tr style="display:none" class="subTr dont-hide">
        <td colspan="9" style="padding:0px !important; ">
			<div class="subDiv" style="">
                <div class="col-lg-12" style="margin-top:0px;">
                    <div class="table-responsive topsp sub_tab">
                        <table class="table" style="margin-bottom:5px;" id="thr___request_0_wbs__9_whreqno"></table>
                        <input type="hidden" name="wh___po_0_wbs_45_wrowid" id="wh___po_0_wbs_45_wrowid" value="0"/>
                    </div>
                </div>
            </div>
        </td>
    </tr>
</script>

<script type="text/javascript">
var arr_requestResources = <?php echo (isset($arr_requestResources)) ? json_encode($arr_requestResources) : '[]';?>;
var arr_resource_iows = <?php echo (isset($arr_resource_iows)) ? json_encode($arr_resource_iows) : '[]';?>;
var arr_resource_iow_requests = <?php echo (isset($arr_resource_iow_requests)) ? json_encode($arr_resource_iow_requests) : '[]';?>;
var arr_sel_warehouse = <?php echo (isset($arr_sel_warehouse)) ? json_encode($arr_sel_warehouse) : '[]';?>;
var arr_tvWareHouse = <?php echo (isset($arr_tvWareHouse)) ? json_encode($arr_tvWareHouse) : '[]';?>;
var arr_tvwbsWareHouse = <?php echo (isset($arr_tvwbsWareHouse)) ? json_encode($arr_tvwbsWareHouse) : '[]';?>;

$(function () {
    var $rowid = $('#rowid');
    var template = $('#resource-template').html();
    var iowtemplate = $('#iow-template').html();
    var requesttemplate = $('#request-template').html();
    var waretemplate = $('#iow-po-warehouse').html();
    var rowid = 0;
    var $tbody = $('#workorderTable').find('> tbody.main');


    if(arr_requestResources.length != 0) {
        $.each(arr_requestResources, function(i, o) {
            rowid += 1;
            $tbody.append(template.replace(/__/g, '_' + rowid));
            $('#desc_' + rowid).html(o.Desc);
            $('#resourceid_' + rowid).val(o.ResourceId);
            $('#itemid_' + rowid).val(o.ItemId);
            $('#unitname_' + rowid).html(o.UnitName);
            $('#unitid_' + rowid).val(o.UnitId);
            $('#transfertransId_' + rowid).val(o.TransferTransId);
            $('#tqty_' + rowid).html(o.TransferQty);
            $('#rqty_' + rowid).html(o.RecdQty);
            $('#aqty_' + rowid).html(o.AdjustmentQty);
            $('#rate_' + rowid).html(o.Rate);
            $('#amount_' + rowid).html(o.Amount);
            $('#hiddenqty_' + rowid).val(o.HiddenQty);

            if(arr_resource_iows.length > 0) {

                $.each(arr_resource_iows, function (j, l) {
                    if ((l.ResourceId != o.ResourceId || l.ItemId != o.ItemId)) {
                        return;
                    }
                    var iowrowid = parseInt($('#iow_' + rowid + '_rowid').val()) + 1;
                    $('#decisionTable_' + rowid).find('> tbody.main').append(iowtemplate.replace(/__/g, '_' + rowid).replace(/_0/g, '_' + iowrowid));
                    $('#iow_' + rowid + '_rowid').val(iowrowid);
                    $('#expandTr_' + rowid).show();
                    $('#iow_' + rowid + '_ipdprojtransid_' + iowrowid).val(l.IPDProjTransId);
                    $('#iow_' + rowid + '_dectransid_' + iowrowid).val(l.DecTransId);
                    $('#iow_' + rowid + '_reqtransid_' + iowrowid).val(l.RequestTransId);
                    $('#iow_' + rowid + '_reno_' + iowrowid).html(l.RequestNo);
                    $('#iow_' + rowid + '_resourceid_' + iowrowid).val(l.ResourceId);
                    $('#iow_' + rowid + '_itemid_' + iowrowid).val(l.ItemId);
                    $('#iow_' + rowid + '_unitid_' + iowrowid).val(l.UnitId);
                    $('#iow_' + rowid + '_decisionno_' + iowrowid).html(l.DecisionNo);
                    $('#iow_' + rowid + '_trqty_' + iowrowid).html(l.TransferQty);
                    $('#iow_' + rowid + '_reqty_' + iowrowid).html(l.ReceiptQty);
                    $('#iow_' + rowid + '_hiddenqty_' + iowrowid).val(l.HiddenQty);


                    requestrowid = 0;
                    var wbsRequest = arr_resource_iow_requests.filter(function (obj) {
                        return (obj.ResourceId === o.ResourceId) && (obj.DecTransId === l.DecTransId) && (obj.ItemId === o.ItemId && (obj.BalQty > 0 || obj.Qty > 0));
                    });
                    if (wbsRequest.length > 0) {
                        $('#sec_' + rowid + '_po_' + iowrowid + '_whreqno').html('<thead> <tr> <th class="highlight1">WBS Name</th> <th class="highlight1">PLevel</th> <th class="highlight1" style="text-align:center">BalQty</th> <th class="highlight1" style="text-align:center">ReceiptQty</th> <th class="highlight1"></th> </tr> </thead> <tbody class="main"></tbody> <tbody class="total"> </tbody>');
                        $.each(arr_resource_iow_requests, function (k, r) {
                            if (l.DecTransId != r.DecTransId || l.ResourceId != r.ResourceId || l.ItemId != r.ItemId) {
                                return;
                            }
                            
                            requestrowid = parseInt($('#iow_' + rowid + '_request_' + iowrowid + '_rowid').val()) + 1;
                            // $('#wh_' + rowid + '_po_' +  iowrowid + '_whreqno').hide();
                            $('#sec_' + rowid + '_po_' + iowrowid + '_whreqno').find('> tbody.main').append(requesttemplate
                                .replace(/__9/g, '_' + requestrowid)
                                .replace(/_0/g, '_' + iowrowid)
                                .replace(/__/g, '_' + rowid)
                                .replace(/_45/g, '_' + requestrowid));

                            $('#iow_' + rowid + '_request_' + iowrowid + '_rowid').val(requestrowid);
                            $('#iow_' + rowid + '_request_' + iowrowid + '_wbsname_' + requestrowid).html(r.WbsName);
                            $('#iow_' + rowid + '_request_' + iowrowid + '_dectransid_' + requestrowid).val(r.DecTransId);
                            $('#iow_' + rowid + '_request_' + iowrowid + '_ipdptid_' + requestrowid).val(r.IPDProjTransId);
                            $('#iow_' + rowid + '_request_' + iowrowid + '_reqtransid_' + requestrowid).val(r.RequestTransId);
                            $('#iow_' + rowid + '_request_' + iowrowid + '_analysisid_' + requestrowid).val(r.AnalysisId);
                            $('#iow_' + rowid + '_request_' + iowrowid + '_reqahtransid_' + requestrowid).val(r.RequestAHTransId);
                            $('#iow_' + rowid + '_request_' + iowrowid + '_decatransid_' + requestrowid).val(r.DecATransId);
                            $('#iow_' + rowid + '_request_' + iowrowid + '_resourceid_' + requestrowid).val(r.ResourceId);
                            $('#iow_' + rowid + '_request_' + iowrowid + '_itemid_' + requestrowid).val(r.ItemId);
                            $('#iow_' + rowid + '_request_' + iowrowid + '_unitid_' + requestrowid).val(r.UnitId);
                            $('#iow_' + rowid + '_request_' + iowrowid + '_plevel_' + requestrowid).html(r.PLevel);
                            $('#iow_' + rowid + '_request_' + iowrowid + '_balqty_' + requestrowid).html(sanitizeNumber((r.BalQty)));
                            $('#iow_' + rowid + '_request_' + iowrowid + '_rqty_' + requestrowid).html(sanitizeNumber(r.ReceiptQty));
							$('.iow_' + rowid + '_requestfields').show();

                            //start wbs warehouse
                            if (arr_tvwbsWareHouse.length != 0) {
                                $('#thr_' + rowid + '_request_' + iowrowid + '_wbs_' + requestrowid + '_whreqno').html('<thead> <tr> <th class="worktype-activity">Warehouse Name </th> <th class="worktype-activity">Description </th> <th class="worktype-activity" style="text-align:center">Qty </th> <th class="" style="display: none;">&nbsp;</th> </tr> </thead> <tbody class="main"></tbody> <tbody class="total"> </tbody>');
                                $.each(arr_tvwbsWareHouse, function (u, n) {
                                    if (n.RequestAHTransId == r.RequestAHTransId && o.ResourceId == n.ResourceId && o.ItemId == n.ItemId && n.Qty > 0) {
                                        var whrowid = parseInt($('#wh_' + rowid + '_po_' + iowrowid + '_wbs_' + requestrowid + '_wrowid').val()) + 1;

                                        $('#thr_' + rowid + '_request_' + iowrowid + '_wbs_' + requestrowid + '_whreqno').find('> tbody.main').append(waretemplate
                                            .replace(/_4/g, '_' + whrowid)
                                            .replace(/_0/g, '_' + iowrowid + '_wbs_' + requestrowid)
                                            .replace(/__/g, '_' + rowid));

                                        $('#wh_' + rowid + '_po_' + iowrowid + '_wbs_' + requestrowid + '_wrowid').val(whrowid);
                                        $('#wh_' + rowid + '_po_' + iowrowid + '_wbs_' + requestrowid + '_warehouseid_' + whrowid).val(n.WareHouseId);
                                        $('#wh_' + rowid + '_po_' + iowrowid + '_wbs_' + requestrowid + '_warehousename_' + whrowid).html(n.WareHouseName);
                                        $('#wh_' + rowid + '_po_' + iowrowid + '_wbs_' + requestrowid + '_costcentreid_' + whrowid).val(n.CostCentreId);
                                        $('#wh_' + rowid + '_po_' + iowrowid + '_wbs_' + requestrowid + '_desc_' + whrowid).html(n.Description);
                                        $('#wh_' + rowid + '_po_' + iowrowid + '_wbs_' + requestrowid + '_qty_' + whrowid).html(n.Qty);
										$('.iow_' + rowid + '_requestfields_'+iowrowid+'_wbs').show();
                                    }
                                });
                            }else{
								$('#iow_' + rowid + '_request_' + iowrowid + '_decWbs_' + requestrowid + '_wbs').hide();
							}
                            //end of wbs warehouse
                        });
                    } else {
                        $('.iow_' + rowid + '_requestfields').hide();
                        $('#sec_' + rowid + '_po_' + iowrowid + '_whreqno').html('<thead> <tr> <th class="worktype-activity">Warehouse Name </th> <th class="worktype-activity">Description </th> <th class="worktype-activity">Qty </th> <th class="" style="display: none;">&nbsp;</th> </tr> </thead> <tbody class="main"></tbody> <tbody class="total"> </tbody>');

                        //start PO warehouse
                        if (arr_tvWareHouse.length != 0) {
                            $.each(arr_tvWareHouse, function (u, n) {
                                if (o.ResourceId == n.ResourceId && o.ItemId == n.ItemId && n.Qty > 0) {
                                    var whrowid1 = parseInt($('#wh_' + rowid + '_po_' + iowrowid + '_wrowid').val()) + 1;
                                    $('#sec_' + rowid + '_po_' + iowrowid + '_whreqno').find('> tbody.main').append(waretemplate
                                        .replace(/_4/g, '_' + whrowid1)
                                        .replace(/_0/g, '_' + iowrowid)
                                        .replace(/__/g, '_' + rowid));

                                    $('#wh_' + rowid + '_po_' + iowrowid + '_wrowid').val(whrowid1);
                                    $('#wh_' + rowid + '_po_' + iowrowid + '_warehouseid_' + whrowid1).val(n.WareHouseId);
                                    $('#wh_' + rowid + '_po_' + iowrowid + '_warehousename_' + whrowid1).html(n.WareHouseName);
                                    $('#wh_' + rowid + '_po_' + iowrowid + '_costcentreid_' + whrowid1).val(n.CostCentreId);
                                    $('#wh_' + rowid + '_po_' + iowrowid + '_desc_' + whrowid1).html(n.Description);
                                    $('#wh_' + rowid + '_po_' + iowrowid + '_qty_' + whrowid1).html(n.Qty);
									$('.iow_' + rowid + '_requestfields').show();
                                }
                            });
                        } else {
                            $('#sec_' + rowid + '_po_' + iowrowid + '_whreqno').hide();
                            $('#iow_' + rowid + '_reqty_' + iowrowid).attr('onchange', 'calcpoQuantity(this)');
                            $('#iow_' + rowid + '_reqty_' + iowrowid).prop("readonly", false);
                        }
                        //end of PO-warehouse

                    }
                });
            } else {
                $('#decisionTable_' + rowid).hide();
            }
        });
    }
    $rowid.val(rowid);

    $('.container-fluid').on('click','.mainTr',function(e){
        e.preventDefault();
        if(!$(this).closest("tr").next(".subTr").is(":visible")){
            $(this).closest("tr").next(".subTr").show();
            $(this).closest("tr").next(".subTr").find(".subDiv").slideDown("slow");
            $(this).find("i").addClass("tform");
        }
        else{
            $(this).closest("tr").next(".subTr").find(".subDiv").slideUp("slow");
            $(this).closest("tr").next(".subTr").slideUp("slow");
            $(this).find("i").removeClass("tform");
        }
    });
    nextAccordian(1);
});
function nextAccordian(id) {
    $('#panelheading-' + id).trigger('click');
}
</script>
