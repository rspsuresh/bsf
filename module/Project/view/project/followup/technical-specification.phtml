<!--style-->
<link rel="stylesheet" href="<?php echo $this->basePath() . '/css/project.css';?>" />
<style>
.panel {
	border-radius:0px !important;
}
.panel-info {
	border:none;
	border-top:none;
}
.chat_content {
	float:left;
	width:100%;
}
</style>
<!--style-->
<!--content-->
<div class="content_wrapper padlr0">
	<div class="container-fluid">
		<div class="row">
			<div class="col-lg-12">
				<h1>Technical Specification <?php echo isset($NameOfWork) ? '- ' .$NameOfWork['NameOfWork']:'';?></h1>
			</div>
			<!--form start-->
			<form method="post" role="form" enctype="multipart/form-data" id="mainForm">
<!--			<div class="col-lg-12 top_ct" >-->
<!--				<div class="col-lg-4 col-lg-offset-0 col-md-6 col-md-offset-0 col-sm-8 col-sm-offset-2">-->
<!--					<div class="form-group col-lg-12">-->
<!--<!--						<input type="hidden" name="EnquiryFollowupId" id="EnquiryFollowupId" value="--><?php ////echo $enquiryFollowupId; ?><!--<!--" />-->
<!--						<input type="text" id="NameOfWork" name="NameOfWork" class="form-control lbl_move" label="Name of Work" readonly/>-->
<!--					</div>-->
<!--				</div>-->
<!--			</div>-->
			<!--form end-->
			<!--accordion start-->
			<div class="col-lg-12 clear">
				<div id="accordion" class="panel-group">
					<!--Resource Rate-->
					<div class="panel panel-info">
						<div data-target="#collapseOne" data-parent="#accordion" data-toggle="collapse" class="panel-heading collapsed panel_heads" id="panelheading-1">
							<h4 class="panel-title accordion-toggle defa_panels">Resource Rate</h4>
						</div>
						<div class="panel-collapse collapse" id="collapseOne" style="height: 0px;">
							<div class="panel-body bgcolr">
								<div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1 col-sm-10 col-sm-offset-1">
									<div class="deft_act">
										<div class="table-responsive topsp">
											<input type="hidden" name="ResourceCount" id="ResourceCount" value="1" />
											<table class="table tableWithFloatingHeader" style=" margin-bottom:0px;" id="ResourceTable">
												<thead>
													<th>Resource Name</th>
													<th>Unit</th>
													<th>Rate</th>
                                                    <th>&nbsp;</th>
												</thead>
												<tbody>
													<tr>
														<td width="15%">
                                                            <input class="parent_text ResourceRow" data-toggle="popover" type="text" id="ResourceName_1" name="ResourceName_1"  onfocus="return CheckResourceFocus(this.id)"/>
														    <input type="hidden" id="ResourceId_1" name="ResourceId_1" />
                                                        </td>
														<td width="4%">
                                                            <input class="parent_text ResourceRow" type="text" id="Unit_1" name="Unit_1" />
                                                            <input type="hidden" name="UnitId_1" id="UnitId_1"/>
                                                        </td>
														<td width="6%"><input class="parent_text ResourceRow text-right" type="text" id="Rate_1" name="Rate_1" onKeyPress="return isNumberKey(event);" /></td>
                                                        <td width="1%" class="action_btns_td">
                                                            <ul class="action_btns">
                                                                <li>
                                                                    <a href="#" name="resdelrow_1" id="resdelrow_1" onclick="javascript:deleteResource(this.id, event)">
                                                                        <span data-original-title="Delete" data-placement="left" data-toggle="tooltip"><i class="fa fa-trash-o"></i></span>
                                                                    </a>
                                                                </li>
                                                            </ul>
                                                        </td>
													</tr>
												</tbody>
											</table>
										</div>
										<div class="cont_bt col-lg-5 col-lg-offset-7 col-md-9 col-md-offset-3 col-sm-7 col-sm-offset-5 col-xs-7 col-xs-offset-5">
											<ul>
												<li><a href="javascript:nextAccordian(2)">Continue &nbsp;<i class="fa fa-chevron-circle-right"></i></a></li>
											</ul>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!--Resource Rate-->
					<!--Coefficient-->
					<div class="panel panel-info">
						<div data-target="#collapseTwo" data-parent="#accordion" data-toggle="collapse" class="panel-heading collapsed panel_heads" id="panelheading-2">
							<h4 class="panel-title accordion-toggle defa_panels">Coefficient</h4>
						</div>
						<div class="panel-collapse collapse" id="collapseTwo" style="height: 0px;">
							<div class="panel-body bgcolr">
                                <div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1 col-sm-10 col-sm-offset-1">
									<div class="deft_act">
										<div class="table-responsive topsp">
											<input type="hidden" name="CoefficientCount" id="CoefficientCount" value="1" />
											<table class="table tableWithFloatingHeader" style=" margin-bottom:0px;" id="CoefficientTable">
												<thead>
                                                    <th>Serial No</th>
													<th>Specification</th>
													<th>Resource</th>
													<th>Coefficient</th>
													<th>Unit</th>
                                                    <th>&nbsp;</th>
												</thead>
												<tbody>
													<tr>
                                                        <td width="3%">
                                                            <input class="parent_text CoefficientRow" type="text" id="SerialNo_1" name="SerialNo_1" />
                                                        </td>
														<td width="15%">
                                                            <textarea class="parent_texts CoefficientRow" id="ItemOfWork_1" name="ItemOfWork_1"></textarea>
                                                        </td>
														<td width="15%">
                                                            <input class="parent_text CoefficientRow" data-toggle="popover" type="text" id="Resources_1" name="Resources_1" />
														    <input class="parent_text CoefficientRow" type="hidden" id="ResourcesIOWId_1" name="ResourcesIOWId_1" />
                                                        </td>
														<td width="3%"><input class="parent_text CoefficientRow text-right" type="text" id="Coefficient_1" name="Coefficient_1" onKeyPress="return isNumberKey(event);" /></td>
														<td width="3%">
                                                            <input class="parent_text CoefficientRow" type="text" id="CoUnit_1" name="CoUnit_1" />
                                                            <input type="hidden" name="CoUnitId_1" id="CoUnitId_1"/>
                                                        </td>
                                                        <td width="1%" class="action_btns_td">
                                                            <ul class="action_btns">
                                                                <li>
                                                                    <a href="#" name="codelrow_1" id="codelrow_1" onclick="javascript:deleteCoefficientRow(this.id, event)">
                                                                        <span data-original-title="Delete" data-placement="left" data-toggle="tooltip"><i class="fa fa-trash-o"></i></span>
                                                                    </a>
                                                                </li>
                                                            </ul>
                                                        </td>
													</tr>
												</tbody>
											</table>
										</div>
										<div class="cont_bt col-lg-5 col-lg-offset-7 col-md-9 col-md-offset-3 col-sm-7 col-sm-offset-5 col-xs-7 col-xs-offset-5">
											<ul>
												<li><a href="javascript:nextAccordian(3)">Continue &nbsp;<i class="fa fa-chevron-circle-right"></i></a></li>
											</ul>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!--Coefficient-->
					<!--Make / Brand-->
					<div class="panel panel-info">
						<div data-target="#collapsethree" data-parent="#accordion" data-toggle="collapse" class="panel-heading collapsed panel_heads" id="panelheading-3">
							<h4 class="panel-title accordion-toggle defa_panels">Make & Brand</h4>
						</div>
						<div class="panel-collapse collapse" id="collapsethree" style="height: 0px;">
							<div class="panel-body bgcolr">
                                <div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1 col-sm-10 col-sm-offset-1">
									<div class="deft_act">
										<div class="table-responsive topsp">
											<input type="hidden" name="MakeBrandCount" id="MakeBrandCount" value="1" />
											<table class="table tableWithFloatingHeader" style=" margin-bottom:0px;" id="MakeBrandTable">
												<thead>
													<th>Material Name</th>
													<th>Make</th>
                                                    <th>&nbsp;</th>
												</thead>
												<tbody>
													<tr>
														<td width="10%"><input class="parent_text MakeBrandRow" data-toggle="popover" type="text" id="MaterialName_1" name="MaterialName_1" onfocus="return CheckBrandResourceFocus(this.id)"/>
														<input class="parent_text MakeBrandRow" type="hidden" id="MaterialId_1" name="MaterialId_1" /></td>
														<td width="8%"><input class="parent_text MakeBrandRow" type="text" id="Make_1" name="Make_1" /></td>
                                                        <td width="1%" class="action_btns_td">
                                                            <ul class="action_btns">
                                                                <li>
                                                                    <a href="#" name="branddelrow_1" id="branddelrow_1" onclick="javascript:deleteBrandRow(this.id, event)">
                                                                        <span data-original-title="Delete" data-placement="left" data-toggle="tooltip"><i class="fa fa-trash-o"></i></span>
                                                                    </a>
                                                                </li>
                                                            </ul>
                                                        </td>
													</tr>
												</tbody>
											</table>
										</div>
										<div class="cont_bt col-lg-5 col-lg-offset-7 col-md-9 col-md-offset-3 col-sm-7 col-sm-offset-5 col-xs-7 col-xs-offset-5">
											<ul>
												<li><a href="javascript:nextAccordian(4)">Continue &nbsp;<i class="fa fa-chevron-circle-right"></i></a></li>
											</ul>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!--Make / Brand-->
					<!--Short Notes-->
					<div class="panel panel-info">
						<div data-target="#collapsefour" data-parent="#accordion" data-toggle="collapse" class="panel-heading collapsed panel_heads" id="panelheading-4">
							<h4 class="panel-title accordion-toggle defa_panels">Short Notes</h4>
						</div>
						<div class="panel-collapse collapse" id="collapsefour" style="height: 0px;">
							<div class="panel-body bgcolr">
                                <div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1 col-sm-10 col-sm-offset-1">
									<div class="deft_act">
										<div class="table-responsive topsp">
											<input type="hidden" name="ShortNotesCount" id="ShortNotesCount" value="1" />
											<table class="table tableWithFloatingHeader" style=" margin-bottom:0px;" id="ShortNotesTable">
												<thead>
													<th>Title</th>
													<th>Specifications</th>
                                                    <th>&nbsp;</th>
												</thead>
												<tbody>
													<tr>
														<td width="10%"><input class="parent_text ShortNotesRow" type="text" id="Title_1" name="Title_1" /></td>
														<td width="8%"><input class="parent_text ShortNotesRow" type="text" id="Specifications_1" name="Specifications_1" /></td>
                                                        <td width="1%" class="action_btns_td">
                                                            <ul class="action_btns">
                                                                <li>
                                                                    <a href="#" name="titledelrow_1" id="titledelrow_1" onclick="javascript:deleteTitleRow(this.id, event)">
                                                                        <span data-original-title="Delete" data-placement="left" data-toggle="tooltip"><i class="fa fa-trash-o"></i></span>
                                                                    </a>
                                                                </li>
                                                            </ul>
                                                        </td>
													</tr>
												</tbody>
											</table>
										</div>
										<div class="cont_bt col-lg-5 col-lg-offset-7 col-md-9 col-md-offset-3 col-sm-7 col-sm-offset-5 col-xs-7 col-xs-offset-5">
											<ul>
												<li><a href="javascript:nextAccordian(5)">Continue &nbsp;<i class="fa fa-chevron-circle-right"></i></a></li>
											</ul>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!--Short Notes end-->
					<!--Check List-->
<!--					<div class="panel panel-info">-->
<!--						<div data-target="#collapseseventh" data-parent="#accordion" data-toggle="collapse" class="panel-heading collapsed panel_heads" id="panelheading-5">-->
<!--							<h4 class="panel-title accordion-toggle defa_panels">Check List</h4>-->
<!--						</div>-->
<!--						<div class="panel-collapse collapse" id="collapseseventh" style="height: 0px;">-->
<!--							<div class="panel-body bgcolr">-->
<!--								<div class="morechc">-->
<!--									<div class="radio_check">-->
<!--									--><?php //foreach($checkLists as $value) { ?>
<!--										<p>-->
<!--											<input type="checkbox" id="CheckList_--><?php //echo $value['CheckListId']; ?><!--" value="--><?php //echo $value['CheckListId']; ?><!--" name="CheckList[]" />-->
<!--											<label style="position: relative; overflow: hidden;" class="ripple has-ripple" for="CheckList_--><?php //echo $value['CheckListId']; ?><!--">--><?php //echo $value['CheckListName']; ?><!--<span class="ripple-wrapper"></span><span class="ripple-wrapper"></span></label>-->
<!--										</p>-->
<!--									--><?php //} ?>
<!--									</div>-->
<!--								</div>-->
<!--								<div class="col-lg-12">-->
<!--									<div class="col-lg-6 col-lg-offset-3 col-md-6 col-md-offset-3 col-sm-7 col-sm-offset-2">-->
<!--										<div class="deft_act">-->
<!--											<div class="table-responsive topsp">-->
<!--												<input type="hidden" name="CheckListCount" id="CheckListCount" value="1" />-->
<!--												<table class="table tableWithFloatingHeader" style=" margin-bottom:0px;" id="CheckListTable">-->
<!--													<thead>-->
<!--														<th>Add New Check List</th>-->
<!--													</thead>-->
<!--													<tbody>-->
<!--														<tr>-->
<!--															<td width="10%"><input class="parent_text CheckListRow" type="text" id="NewCheckList_1" name="NewCheckList_1" /></td>-->
<!--														</tr>-->
<!--													</tbody>-->
<!--												</table>-->
<!--											</div>-->
<!--										</div>-->
<!--									</div>-->
<!--								</div>								-->
<!--								<div class="cont_bt col-lg-5 col-lg-offset-7 col-md-9 col-md-offset-3 col-sm-7 col-sm-offset-5 col-xs-7 col-xs-offset-5">-->
<!--									<ul>-->
<!--										<li><a href="javascript:nextAccordian(6)">Continue &nbsp;<i class="fa fa-chevron-circle-right"></i></a></li>-->
<!--									</ul>-->
<!--								</div>-->
<!--							</div>-->
<!--						</div>-->
<!--					</div>-->
					<!--Check List-->
					<div class="panel panel-info">
						<div data-target="#collapsefive" data-parent="#accordion" data-toggle="collapse" class="panel-heading collapsed panel_heads" id="panelheading-5">
							<h4 class="panel-title accordion-toggle defa_panels">Note</h4>
						</div>
						<div class="panel-collapse collapse" id="collapsefive" style="height: 0px;">
							<div class="panel-body bgcolr">
								<div class="deft_act col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1 col-sm-10 col-sm-offset-1">
									<div class="form-group">
										<textarea class="form-control lbl_move" label="Enter Note" id="Notes" name="Notes"></textarea>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			</form>
			<!--accordion end-->
		</div>
	</div>
</div>
<div class="col-lg-12 savebtn_area">
	<ul>
		<li class="dropdown save_btn float_r"><a href="javascript:void(0);" data-toggle="tooltip" class="ripple" title="Save" id="submitData">Save</a></li>
        <form class="form-horizontal" action="<?php echo $this->basePath() . '/project/followup/followup';?>" method="post" id="frmfollowup">
            <input type="hidden" name="EnquiryId" value="<?php echo (isset($enquiryId)) ? $enquiryId : 0; ?>"/>
            <input type="hidden" id="formfrom" name="formfrom"/>
            <input type="hidden" id="EnquiryName" name="EnquiryName" value = "<?php echo $EnquiryName; ?>"/>
            <li class="cancel_btn float_l goback-foll"><a onclick="backfn(); return false;" data-toggle="tooltip" class="ripple" title="Go back"><i class="fa fa-chevron-circle-left"></i> Go Back</a></li>
        </form>
<!--        <li class="cancel_btn float_l goback-foll"><a onclick="backfn(); return false;" data-toggle="tooltip" class="ripple" title="Go back"><i class="fa fa-chevron-circle-left"></i> Go Back</a></li>-->
	</ul>
</div>
<script type="text/javascript">
    var arrreslist = <?php echo json_encode($reslist);?>;
    var arrayres = arrreslist;
    var arrresMaterial = <?php echo json_encode($resMaterial);?>;
    var arrayMat = arrresMaterial;
    var arrresiowlist = <?php echo json_encode($resiowlist);?>;
    var arrayunitlist = <?php echo (isset($unit)) ? json_encode($unit) : '[]';?>;
    //for loop to load resourse
    function bindResourceAutoComplete() {
        var $Resource = $('input[id^=ResourceName_]');
        $Resource.unbind('autocomplete');
        $.each($Resource, function (i, obj) {
            var $this = $(this),
                name = $this[0].id;
            if (name.indexOf('__') != -1) return;
            var key1 = name.split('_')[1];
            $this.autocomplete({
                lookup: arrayres,
                showNoSuggestionNotice: false,
                lookupFilter: function (suggestion, originalQuery, queryLowerCase) {
                    if (queryLowerCase == '*') {
                        return suggestion.value;
                    } else {
                        var re = new RegExp($.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');
                        return re.test(suggestion.value);
                    }
                },
                onSelect: function (suggestion) {
                    if (suggestion) {
                        $("#ResourceId_" + key1).val(suggestion.data);

                        $(this).removeClass('error');
                    }
                },
                onSearchStart: function (suggestion) {
                    $("#ResourceId_" + key1).val(0);
                },
                onSearchComplete: function (query, suggestions) {
                    if (!suggestions.length) {
                        $(this).addClass('error');
                        $("#ResourceId_" + key1).val(0);
                    } else $(this).removeClass('error');
                }
            });
        });
    }
    //IOW
    /*function bindIOWAutoComplete() {
        var $ItemOfWork = $('input[id^=ItemOfWork_]');
        $ItemOfWork.unbind('autocomplete');
        $.each($ItemOfWork, function (i, obj) {
            var $this = $(this),
                name = $this[0].id;
            if (name.indexOf('__') != -1) return;
            var key1 = name.split('_')[1];
            $this.autocomplete({
                lookup: arrresiowlist,
                showNoSuggestionNotice: false,
                lookupFilter: function (suggestion, originalQuery, queryLowerCase) {
                    if (queryLowerCase == '*') {
                        return suggestion.value;
                    } else {
                        var re = new RegExp($.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');
                        return re.test(suggestion.value);
                    }
                },
                onSelect: function (suggestion) {
                    if (suggestion) {
                        $("#ItemOfWorkId_" + key1).val(suggestion.data);
                        $(this).removeClass('error');
                    }
                },
                onSearchStart: function (suggestion) {
                    $("#ItemOfWorkId_" + key1).val(0);
                },
                onSearchComplete: function (query, suggestions) {
                    if (!suggestions.length) {
                        $(this).addClass('error');
                        $("#ItemOfWorkId_" + key1).val(0);
                    } else $(this).removeClass('error');
                }
            });
        });
    }*/
    //IOW Resource
    function bindIOWResourceAutoComplete() {
        var $Resources = $('input[id^=Resources_]');
        $Resources.unbind('autocomplete');
        $.each($Resources, function (i, obj) {
            var $this = $(this),
                name = $this[0].id;
            if (name.indexOf('__') != -1) return;
            var key1 = name.split('_')[1];
            $this.autocomplete({
                lookup: arrreslist,
                showNoSuggestionNotice: false,
                lookupFilter: function (suggestion, originalQuery, queryLowerCase) {
                    if (queryLowerCase == '*') {
                        return suggestion.value;
                    } else {
                        var re = new RegExp($.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');
                        return re.test(suggestion.value);
                    }
                },
                onSelect: function (suggestion) {
                    if (suggestion) {
                        $("#ResourcesIOWId_" + key1).val(suggestion.data);
                        $(this).removeClass('error');
                    }
                },
                onSearchStart: function (suggestion) {
                    $("#ResourcesIOWId_" + key1).val(0);
                },
                onSearchComplete: function (query, suggestions) {
                    if (!suggestions.length) {
                        $(this).addClass('error');
                        $("#ResourcesIOWId_" + key1).val(0);
                    } else $(this).removeClass('error');
                }
            });
        });
    }
    //Material
    function bindMaterialAutoComplete() {
        var $MaterialName = $('input[id^=MaterialName_]');
        $MaterialName.unbind('autocomplete');
        $.each($MaterialName, function (i, obj) {
            var $this = $(this),
                name = $this[0].id;
            if (name.indexOf('__') != -1) return;
            var key1 = name.split('_')[1];
            $this.autocomplete({
                lookup: arrayMat,
                showNoSuggestionNotice: false,
                lookupFilter: function (suggestion, originalQuery, queryLowerCase) {
                    if (queryLowerCase == '*') {
                        return suggestion.value;
                    } else {
                        var re = new RegExp($.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');
                        return re.test(suggestion.value);
                    }
                },
                onSelect: function (suggestion) {
                    if (suggestion) {
                        $("#MaterialId_" + key1).val(suggestion.data);
                        $(this).removeClass('error');
                    }
                },
                onSearchStart: function (suggestion) {
                    $("#MaterialId_" + key1).val(0);
                },
                onSearchComplete: function (query, suggestions) {
                    if (!suggestions.length) {
                        $(this).addClass('error');
                        $("#MaterialId_" + key1).val(0);
                    } else $(this).removeClass('error');
                }
            });
        });
    }

$(function(){
	nextAccordian(1);

    bindResourceAutoComplete();
    //bindIOWAutoComplete();
    bindIOWResourceAutoComplete();
    bindMaterialAutoComplete();
    bindUnitAutoComplete();
    bindCoUnitAutoComplete();
    bindPopOver();
    bindResourceChange();
    bindCoefficientResourceChange();
    bindMakeResourceChange();

//    var NameOfWork = $('#NameOfWork');

//    var arrNameOfWork = <?php //if(isset($NameOfWork)) echo json_encode($NameOfWork); else echo "[]";?>//;
    var arrEnquiryTechnicalSpecification = <?php if(isset($EnquiryTechnicalSpecification)) echo json_encode($EnquiryTechnicalSpecification); else echo "[]";?>;
    var arrEnquiryResourceRate = <?php if(isset($EnquiryResourceRate)) echo json_encode($EnquiryResourceRate); else echo "[]";?>;
    var arrEnquiryCoefficient = <?php if(isset($EnquiryCoefficient)) echo json_encode($EnquiryCoefficient); else echo "[]";?>;
    var arrEnquiryMakeBrand = <?php if(isset($EnquiryMakeBrand)) echo json_encode($EnquiryMakeBrand); else echo "[]";?>;
    var arrEnquiryShortNotes = <?php if(isset($EnquiryShortNotes)) echo json_encode($EnquiryShortNotes); else echo "[]";?>;
    var arrEnquiryCheckList = <?php if(isset($EnquiryCheckList)) echo json_encode($EnquiryCheckList); else echo "[]";?>;

    if(arrEnquiryTechnicalSpecification.length != 0) {
        ///NameOfWork.val(arrEnquiryTechnicalSpecification['NameOfWork']).trigger('change');
        $('#Notes').val(arrEnquiryTechnicalSpecification['Notes']).trigger('change');
    }
//    if(arrNameOfWork.length != 0) {
//        NameOfWork.val(arrNameOfWork.NameOfWork).trigger('change');
//    }

    if(arrEnquiryResourceRate.length != 0) {
        var i;
        for(i = 0;i< arrEnquiryResourceRate.length;i++) {
            var m = i+1;
            $('#ResourceName_'+m).val(arrEnquiryResourceRate[i]['ResourceName']).trigger('change');
            $('#ResourceId_'+m).val(arrEnquiryResourceRate[i]['ResourceId']).trigger('change');
            $('#UnitId_'+m).val(arrEnquiryResourceRate[i]['UnitId']);
            $('#Unit_'+m).val(arrEnquiryResourceRate[i]['UnitName']);
            $('#Rate_'+m).val(arrEnquiryResourceRate[i]['Rate']);
            $('#resdelrow_'+m).show();
            loadResourceRow();
        }
    }

    if(arrEnquiryCoefficient.length != 0) {
        var i;
        for(i = 0;i< arrEnquiryCoefficient.length;i++) {
            var m = i+1;
            $('#SerialNo_'+m).val(arrEnquiryCoefficient[i]['SerialNo']).trigger('change');
            $('#ItemOfWork_'+m).val(arrEnquiryCoefficient[i]['ItemOfWork']).trigger('change');
            $('#Resources_'+m).val(arrEnquiryCoefficient[i]['ResourceName']).trigger('change');
            $('#ResourcesIOWId_'+m).val(arrEnquiryCoefficient[i]['ResourceId']);
            $('#Coefficient_'+m).val(arrEnquiryCoefficient[i]['Coefficient']);
            $('#CoUnit_'+m).val(arrEnquiryCoefficient[i]['UnitName']);
            $('#CoUnitId_'+m).val(arrEnquiryCoefficient[i]['UnitId']);
            $('#codelrow_'+m).show();
            loadCoefficientRow();
        }
    }

    if(arrEnquiryMakeBrand.length != 0) {
        var i;
        for(i = 0;i< arrEnquiryMakeBrand.length;i++) {
            var m = i+1;
            $('#MaterialName_'+m).val(arrEnquiryMakeBrand[i]['MaterialName']).trigger('change');
            $('#Make_'+m).val(arrEnquiryMakeBrand[i]['Make']).trigger('change');
            $('#branddelrow_'+m).show();
        }
    }

    if(arrEnquiryShortNotes.length != 0) {
        var i;
        for(i = 0;i< arrEnquiryShortNotes.length;i++) {
            var m = i+1;
            $('#Title_'+m).val(arrEnquiryShortNotes[i]['Title']).trigger('change');
            $('#Specifications_'+m).val(arrEnquiryShortNotes[i]['Specifications']).trigger('change');
            $('#titledelrow_'+m).show();
        }
    }

    if(arrEnquiryCheckList.length != 0) {
        var i;
        for(i = 0;i< arrEnquiryCheckList.length;i++) {
            $('#CheckList_'+arrEnquiryCheckList[i]['CheckListId']).prop("checked",true);
        }
    }
});

function nextAccordian(id)
{
	$('#panelheading-' + id).trigger('click');
}

addResourceRow();
function addResourceRow()
{
	$( "#ResourceTable" ).on('change','.ResourceRow', function() {
        var $x = $(this),
            key = $x[0].id.split('_')[1];
		if($('#ResourceId_'+key).val().length>0 && $('#Unit_'+key).val().length>0 && $('#Rate_'+key).val().length>0 && $(this).closest("tr").index() == $("#ResourceTable tbody tr:last").index()) {
                $('#resdelrow_'+key).show();
				var todc = $('#ResourceCount').val();
			var ntodc = (parseInt(todc) + parseInt(1)); 
			$('#ResourceCount').val(ntodc);
			$('#ResourceTable tbody').append('<tr>'+
				'<td width="15%">' +
                    '<input class="parent_text ResourceRow" type="text" id="ResourceName_'+ntodc+'" data-toggle="popover" name="ResourceName_'+ntodc+'" onfocus="return CheckResourceFocus(this.id)"/>' +
                    '<input type="hidden" id="ResourceId_'+ntodc+'" name="ResourceId_'+ntodc+'" />' +
                '</td>'+
				'<td width="4%">' +
                    '<input class="parent_text ResourceRow" type="text" id="Unit_'+ntodc+'" name="Unit_'+ntodc+'" />' +
                    '<input type="hidden" name="UnitId_'+ntodc+'" id="UnitId_'+ntodc+'"/>'+
                '</td>'+
				'<td width="6%"><input class="parent_text ResourceRow text-right" type="text" id="Rate_'+ntodc+'" name="Rate_'+ntodc+'" onKeyPress="return isNumberKey(event);" /></td>'+
                '<td width="1%" class="action_btns_td">'+
                '<ul class="action_btns">'+
                '<li>'+
                '<a href="#" name="resdelrow_'+ntodc+'" id="resdelrow_'+ntodc+'" style="display:none;" onclick="javascript:deleteResource(this.id, event)">'+
                '<span data-original-title="Delete" data-placement="left" data-toggle="tooltip"><i class="fa fa-trash-o"></i></span>'+
                '</a>'+
                '</li>'+
                '</ul>'+
                '</td>'+
            '</tr>');
            bindResourceAutoComplete();
            bindUnitAutoComplete();
            bindPopOver();
            bindResourceChange();
		}
	});
}

addCoefficientRow();
function addCoefficientRow()
{
//	$( ".CoefficientRow" ).unbind();
//	$( ".CoefficientRow" ).bind('keyup', function() {
//		if($(this).val().length>0 && $(this).closest("tr").index() == $("#CoefficientTable tbody tr:last").index()) {
//			var todc = $('#CoefficientCount').val();
//			var ntodc = (parseInt(todc) + parseInt(1));
//			$('#CoefficientCount').val(ntodc);
//			$('#CoefficientTable tbody').append('<tr>'+
//				'<td width="10%"><input class="parent_text CoefficientRow" type="text" id="ItemOfWork_'+ntodc+'" name="ItemOfWork_'+ntodc+'" /></td>'+
//				'<td width="10%"><input class="parent_text" type="text" id="Resources_'+ntodc+'" name="Resources_'+ntodc+'" /></td>'+
//				'<td width="3%"><input class="parent_text" type="text" id="Coefficient_'+ntodc+'" name="Coefficient_'+ntodc+'" /></td>'+
//				'<td width="3%"><input class="parent_text" type="text" id="CoUnit_'+ntodc+'" name="CoUnit_'+ntodc+'" onKeyPress="return isNumberKey(event);" /></td>'+
//				'</tr>');
//			addCoefficientRow();
//		}
//	});
    $( "#CoefficientTable" ).on('change','.CoefficientRow', function() {
        var $x = $(this),
            key = $x[0].id.split('_')[1];
        if($('#ItemOfWork_'+key).val().length>0 && $('#Resources_'+key).val().length>0 && $('#Coefficient_'+key).val().length>0 && $('#CoUnit_'+key).val().length>0 && $(this).closest("tr").index() == $("#CoefficientTable tbody tr:last").index()) {
            $('#codelrow_'+key).show();
            var todc = $('#CoefficientCount').val();
            var ntodc = (parseInt(todc) + parseInt(1));
            $('#CoefficientCount').val(ntodc);
            $('#CoefficientTable tbody').append('<tr>'+
            '<td width="3%">'+
            '<input class="parent_text CoefficientRow" type="text" id="SerialNo_'+ntodc+'" name="SerialNo_'+ntodc+'" />'+
            '</td>'+
            '<td width="15%">'+
            '<textarea class="parent_text CoefficientRow" id="ItemOfWork_'+ntodc+'" name="ItemOfWork_'+ntodc+'"></textarea>'+
            '</td>'+
            '<td width="15%"><input class="parent_text CoefficientRow" data-toggle="popover" type="text" id="Resources_'+ntodc+'" name="Resources_'+ntodc+'" />' +
            '<input class="parent_text CoefficientRow" type="hidden" id="ResourcesIOWId_'+ntodc+'" name="ResourcesIOWId_'+ntodc+'" /></td>'+
            '<td width="3%"><input class="parent_text CoefficientRow text-right" type="text" id="Coefficient_'+ntodc+'" name="Coefficient_'+ntodc+'" onKeyPress="return isNumberKey(event);" /></td>'+
            '<td width="3%">' +
            '<input class="parent_text CoefficientRow" type="text" id="CoUnit_'+ntodc+'" name="CoUnit_'+ntodc+'" />' +
            '<input type="hidden" name="CoUnitId_'+ntodc+'" id="CoUnitId_'+ntodc+'"/>'+
            '</td>'+
            '<td width="1%" class="action_btns_td">'+
            '<ul class="action_btns">'+
            '<li>'+
            '<a href="#" name="codelrow_'+ntodc+'" id="codelrow_'+ntodc+'" style="display:none;" onclick="javascript:deleteCoefficientRow(this.id, event)">'+
            '<span data-original-title="Delete" data-placement="left" data-toggle="tooltip"><i class="fa fa-trash-o"></i></span>'+
            '</a>'+
            '</li>'+
            '</ul>'+
            '</td>'+
            '</tr>');
//            addCoefficientRow();
            //bindIOWAutoComplete();
            bindIOWResourceAutoComplete();
            bindCoUnitAutoComplete();
            bindPopOver();
            bindCoefficientResourceChange()

        }
    });
}

addMakeBrandRow();
function addMakeBrandRow()
{
//	$( ".MakeBrandRow" ).unbind();
	$( "#MakeBrandTable" ).on('change','.MakeBrandRow',function() {
        var $x = $(this),
            key = $x[0].id.split('_')[1];
		if($('#MaterialName_'+key).val().length>0 && $('#Make_'+key).val().length>0 && $(this).closest("tr").index() == $("#MakeBrandTable tbody tr:last").index()) {
            $('#branddelrow_'+key).show();
			var todc = $('#MakeBrandCount').val();
			var ntodc = (parseInt(todc) + parseInt(1)); 
			$('#MakeBrandCount').val(ntodc);
			$('#MakeBrandTable tbody').append('<tr>'+
				'<td width="10%"><input class="parent_text MakeBrandRow" data-toggle="popover" type="text" id="MaterialName_'+ntodc+'" name="MaterialName_'+ntodc+'" onfocus="return CheckBrandResourceFocus(this.id)"/>'+
				'<input class="parent_text MakeBrandRow" type="hidden" id="MaterialId_'+ntodc+'" name="MaterialId_'+ntodc+'" /></td>'+
				'<td width="8%"><input class="parent_text MakeBrandRow" type="text" id="Make_'+ntodc+'" name="Make_'+ntodc+'" /></td>'+
                '<td width="1%" class="action_btns_td">'+
                '<ul class="action_btns">'+
                '<li>'+
                '<a href="#" name="branddelrow_'+ntodc+'" id="branddelrow_'+ntodc+'" style="display:none;" onclick="javascript:deleteBrandRow(this.id, event)">'+
                '<span data-original-title="Delete" data-placement="left" data-toggle="tooltip"><i class="fa fa-trash-o"></i></span>'+
                '</a>'+
                '</li>'+
                '</ul>'+
                '</td>'+
				'</tr>');
//			addMakeBrandRow();
            bindMaterialAutoComplete();
            bindPopOver();
            bindMakeResourceChange();
		}
	});
}

addShortNotesRow();
function addShortNotesRow()
{
	//$( ".ShortNotesRow" ).unbind();
	//$( ".ShortNotesRow" ).bind('keyup', function() {
    $( "#ShortNotesTable" ).on('change','.ShortNotesRow',function() {
        var $x = $(this),
            key = $x[0].id.split('_')[1];

		if($('#Title_'+key).val().length>0 && $('#Specifications_'+key).val().length>0 && $(this).closest("tr").index() == $("#ShortNotesTable tbody tr:last").index()) {
            $('#titledelrow_'+key).show();
            var todc = $('#ShortNotesCount').val();
			var ntodc = (parseInt(todc) + parseInt(1)); 
			$('#ShortNotesCount').val(ntodc);
			$('#ShortNotesTable tbody').append('<tr>'+
				'<td width="10%"><input class="parent_text ShortNotesRow" type="text" id="Title_'+ntodc+'" name="Title_'+ntodc+'" /></td>'+
				'<td width="8%"><input class="parent_text ShortNotesRow" type="text" id="Specifications_'+ntodc+'" name="Specifications_'+ntodc+'" /></td>'+
                '<td width="1%" class="action_btns_td">'+
                '<ul class="action_btns">'+
                '<li>'+
                '<a href="#" name="titledelrow_'+ntodc+'" id="titledelrow_'+ntodc+'" style="display:none;" onclick="javascript:deleteTitleRow(this.id, event)">'+
                '<span data-original-title="Delete" data-placement="left" data-toggle="tooltip"><i class="fa fa-trash-o"></i></span>'+
                '</a>'+
                '</li>'+
                '</ul>'+
                '</td>'+
				'</tr>');
			//addShortNotesRow();
		}
	});
}

addCheckListRow();
function addCheckListRow()
{
	$( ".CheckListRow" ).unbind();
	$( ".CheckListRow" ).bind('keyup', function() {
		if($(this).val().length>0 && $(this).closest("tr").index() == $("#CheckListTable tbody tr:last").index()) {
			var todc = $('#CheckListCount').val();
			var ntodc = (parseInt(todc) + parseInt(1)); 
			$('#CheckListCount').val(ntodc);
			$('#CheckListTable tbody').append('<tr>'+
				'<td width="10%"><input class="parent_text CheckListRow" type="text" id="NewCheckList_'+ntodc+'" name="NewCheckList_'+ntodc+'" /></td>'+
				'</tr>');
			//addCheckListRow();
		}
	});
}

function bindUnitAutoComplete() {
    var $unitids = $('input[id^=Unit_]');
    $.each($unitids, function (i, obj) {
        var $this = $(this),
            name = $this[0].id;
        if (name.indexOf('__') != -1 || name.indexOf('excel') != -1) return;
        $this.unbind('autocomplete');
        var arrname = name.split('_');
        var key1 = arrname[1];
        $this.autocomplete({
            lookup: arrayunitlist,
            lookupFilter: function(suggestion, originalQuery, queryLowerCase) {
                if (queryLowerCase =='*') return suggestion.value;
                else {
                    var re = new RegExp($.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');
                    return re.test(suggestion.value);
                }
            },
            onSelect: function(suggestion) {
                if(suggestion) {
                    var $el = $("#UnitId_" + key1);
                    $el.val(suggestion.data);
                    removeError($(this));
                }
            },
            onSearchStart: function(suggestion) {
                $("#UnitId_" + key1).val(0);
            },
            onSearchComplete: function (query, suggestions) {
                if(!suggestions.length){
                    showError($(this), 'Required');
                    $("#UnitId_" + key1).val(0);
                } else
                    removeError($(this));
            }
        });
    });
}

function bindCoUnitAutoComplete() {
    var $unitids = $('input[id^=CoUnit_]');
    $.each($unitids, function (i, obj) {
        var $this = $(this),
            name = $this[0].id;
        if (name.indexOf('__') != -1 || name.indexOf('excel') != -1) return;
        $this.unbind('autocomplete');
        var arrname = name.split('_');
        var key1 = arrname[1];
        $this.autocomplete({
            lookup: arrayunitlist,
            lookupFilter: function(suggestion, originalQuery, queryLowerCase) {
                if (queryLowerCase =='*') return suggestion.value;
                else {
                    var re = new RegExp($.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');
                    return re.test(suggestion.value);
                }
            },
            onSelect: function(suggestion) {
                if(suggestion) {
                    var $el = $("#CoUnitId_" + key1);
                    $el.val(suggestion.data);
                    removeError($(this));
                }
            },
            onSearchStart: function(suggestion) {
                $("#CoUnitId_" + key1).val(0);
            },
            onSearchComplete: function (query, suggestions) {
                if(!suggestions.length){
                    showError($(this), 'Required');
                    $("#CoUnitId_" + key1).val(0);
                } else
                    removeError($(this));
            }
        });
    });
}
function loadResourceRow(){
    var todc = $('#ResourceCount').val();
    var ntodc = (parseInt(todc) + parseInt(1));
    $('#resdelrow_'+todc).show();
    $('#ResourceCount').val(ntodc);
    $('#ResourceTable tbody').append('<tr>'+
    '<td width="10%">' +
    '<input class="parent_text ResourceRow" type="text" id="ResourceName_'+ntodc+'" data-toggle="popover" name="ResourceName_'+ntodc+'" onfocus="return CheckResourceFocus(this.id)"/>' +
    '<input type="hidden" id="ResourceId_'+ntodc+'" name="ResourceId_'+ntodc+'" />' +
    '</td>'+
    '<td width="4%">' +
    '<input class="parent_text ResourceRow" type="text" id="Unit_'+ntodc+'" name="Unit_'+ntodc+'" />' +
    '<input type="hidden" name="UnitId_'+ntodc+'" id="UnitId_'+ntodc+'"/>'+
    '</td>'+
    '<td width="4%"><input class="parent_text ResourceRow text-right" type="text" id="Rate_'+ntodc+'" name="Rate_'+ntodc+'" onKeyPress="return isNumberKey(event);" /></td>'+
    '<td width="1%" class="action_btns_td">'+
    '<ul class="action_btns">'+
    '<li>'+
    '<a href="#" name="resdelrow_'+ntodc+'" id="resdelrow_'+ntodc+'" style="display:none;" onclick="javascript:deleteResource(this.id, event)">'+
    '<span data-original-title="Delete" data-placement="left" data-toggle="tooltip"><i class="fa fa-trash-o"></i></span>'+
    '</a>'+
    '</li>'+
    '</ul>'+
    '</td>'+
    '</tr>');
    bindResourceAutoComplete();
    bindUnitAutoComplete();
    bindPopOver();
    bindResourceChange();
}

function deleteResource(x, e) {
        e.preventDefault();
        if (confirm('Do you want to Delete')) {
            var $row = $('#'+ x).closest('tr');
            var tr_length = $('#ResourceTable tbody tr').length;
            if(tr_length == 1) {
                $row.remove();
                loadResourceRow();
            } else {
                $row.remove();
            }
        }
        return false;
    }

    function deleteCoefficientRow(x, e) {
        e.preventDefault();
        if (confirm('Do you want to Delete')) {
            var $row = $('#'+ x).closest('tr');
            var tr_length = $('#CoefficientTable tbody tr').length;
            if(tr_length == 1) {
                $row.remove();
                loadCoefficientRow()
            } else {
                $row.remove();
            }
        }
        return false;
    }
    function deleteBrandRow(x, e) {
        e.preventDefault();
        if (confirm('Do you want to Delete')) {
            var $row = $('#'+ x).closest('tr');
            var tr_length = $('#MakeBrandTable tbody tr').length;
            if(tr_length == 1) {
                $row.remove();
                addMakeBrandRow();
            } else {
                $row.remove();
            }
        }
        return false;
    }
    function deleteTitleRow(x, e) {
        e.preventDefault();
        if (confirm('Do you want to Delete')) {
            var $row = $('#'+ x).closest('tr');
            var tr_length = $('#ShortNotesTable tbody tr').length;
            if(tr_length == 1) {
                $row.remove();
                addShortNotesRow();
            } else {
                $row.remove();
            }
        }
        return false;
    }

function loadCoefficientRow()
{
    var todc = $('#CoefficientCount').val();
    var ntodc = (parseInt(todc) + parseInt(1));
    $('#CoefficientCount').val(ntodc);
    $('#CoefficientTable tbody').append('<tr>'+
    '<td width="3%">'+
    '<input class="parent_text CoefficientRow" type="text" id="SerialNo_'+ntodc+'" name="SerialNo_'+ntodc+'" />'+
    '</td>'+
    '<td width="10%">'+
    '<textarea class="parent_texts CoefficientRow" id="ItemOfWork_'+ntodc+'" name="ItemOfWork_'+ntodc+'"></textarea>'+
    '</td>'+
    '<td width="10%"><input class="parent_text CoefficientRow" data-toggle="popover" type="text" id="Resources_'+ntodc+'" name="Resources_'+ntodc+'" />' +
    '<input class="parent_text CoefficientRow" type="hidden" id="ResourcesIOWId_'+ntodc+'" name="ResourcesIOWId_'+ntodc+'" /></td>'+
    '<td width="3%"><input class="parent_text CoefficientRow" type="text" id="Coefficient_'+ntodc+'" name="Coefficient_'+ntodc+'" onKeyPress="return isNumberKey(event);" /></td>'+
    '<td width="3%">' +
    '<input class="parent_text CoefficientRow" type="text" id="CoUnit_'+ntodc+'" name="CoUnit_'+ntodc+'" />' +
    '<input type="hidden" name="CoUnitId_'+ntodc+'" id="CoUnitId_'+ntodc+'"/>'+
    '</td>'+
    '<td width="1%" class="action_btns_td">'+
    '<ul class="action_btns">'+
    '<li>'+
    '<a href="#" name="codelrow_'+ntodc+'" id="codelrow_'+ntodc+'" style="display:none;" onclick="javascript:deleteCoefficientRow(this.id, event)">'+
    '<span data-original-title="Delete" data-placement="left" data-toggle="tooltip"><i class="fa fa-trash-o"></i></span>'+
    '</a>'+
    '</li>'+
    '</ul>'+
    '</td>'+
    '</tr>');
    bindIOWResourceAutoComplete();
    bindCoUnitAutoComplete();
    bindPopOver();
    bindCoefficientResourceChange()
}

    function bindPopOver() {
        var $inputs =  $('input[data-toggle="popover"]');
        $inputs.unbind('popover');
        $inputs.popover({
            placement : 'auto left',
            trigger : 'hover'
        });
    }

    function bindResourceChange() {
        var $resnames = $('input[id*=ResourceName_]');
        $.each($resnames, function (i, obj) {
            var $this = $(this),
                name = $this[0].id;
            if (name.indexOf('__') != -1) return;
            $('#'+ name).attr('data-content', $('#'+ name).val());
            $this.blur(function () {
                if (isNullCheck($('#'+ name).val(),'string') =="") $this.removeClass('error')
                $('#'+ name).attr('data-content', $('#'+ name).val());
            });
            $this.change(function () {
                $('#'+ name).attr('data-content', $('#'+ name).val());
            });
        });
    }

    function bindCoefficientResourceChange() {
        var $resnames = $('input[id*=Resources_]');
        $.each($resnames, function (i, obj) {
            var $this = $(this),
                name = $this[0].id;
            if (name.indexOf('__') != -1) return;
            $('#'+ name).attr('data-content', $('#'+ name).val());
            $this.blur(function () {
                if (isNullCheck($('#'+ name).val(),'string') =="") $this.removeClass('error')
                $('#'+ name).attr('data-content', $('#'+ name).val());
            });
            $this.change(function () {
                $('#'+ name).attr('data-content', $('#'+ name).val());
            });
        });
    }
    function bindMakeResourceChange() {
        var $resnames = $('input[id*=MaterialName_]');
        $.each($resnames, function (i, obj) {
            var $this = $(this),
                name = $this[0].id;
            if (name.indexOf('__') != -1) return;
            $('#'+ name).attr('data-content', $('#'+ name).val());
            $this.blur(function () {
                if (isNullCheck($('#'+ name).val(),'string') =="") $this.removeClass('error')
                $('#'+ name).attr('data-content', $('#'+ name).val());
            });
            $this.change(function () {
                $('#'+ name).attr('data-content', $('#'+ name).val());
            });
        });
    }
    function CheckResourceFocus(x) {
        var arrname = x.split('_');
        var key1 = arrname[1];
        checkResource(key1);
        var $resname = $('#' + x);
        bindResRowAutoComplete($resname);
    }
    function checkResource(key1) {
        var reskeyid = $('input[id*=ResourceId_]');
        arrayres = arrreslist;
        arrayres = $.grep(arrreslist, function (element, index) {
            var is_selected = true;
            $.each(reskeyid, function (i, obj) {
                var $this = $(this),
                    name = $this[0].id;
                if (element.data == $this.val()) is_selected = false;
            });
            return is_selected;
        });
    }

    function bindResRowAutoComplete(x) {
        var $this = $(x),
            name = $this[0].id,
            arr_names = name.split('_');
        if (name.indexOf('__') != -1) return;
        var key1 = arr_names[1];
        $this.unbind('autocomplete');
        var sName = arr_names[0];
        checkResource(key1);
        $this.autocomplete({
            lookup: arrayres,
            showNoSuggestionNotice: false,
            lookupFilter: function (suggestion, originalQuery, queryLowerCase) {
                if (queryLowerCase == '*') {
                    return suggestion.value;
                } else {
                    var re = new RegExp($.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');
                    return re.test(suggestion.value);
                }
            },
            onSelect: function (suggestion) {
                if (suggestion) {
                    $("#ResourceId_" + key1).val(suggestion.data);
                    $("#UnitId_" + key1).val(suggestion.UnitId);
                    $("#Unit_" + key1).val(suggestion.UnitName);
                    $("#Rate_" + key1).val(suggestion.Rate);
                    loadResourceRow();
                    $(this).removeClass('error');
                }
            },
            onSearchStart: function (suggestion) {
                $("#ResourceId_" + key1).val(0);
            },
            onSearchComplete: function (query, suggestions) {
                if (!suggestions.length) {
                    $(this).addClass('error');
                    $("#ResourceId_" + key1).val(0);
                } else $(this).removeClass('error');
            }
        });
    }


    function CheckBrandResourceFocus(x) {
        var arrname = x.split('_');
        var key1 = arrname[1];
        checkBrandResource(key1);
        var $resname = $('#' + x);
        bindBrandResRowAutoComplete($resname);
    }
    function checkBrandResource(key1) {
        var reskeyid = $('input[id*=MaterialId_]');
        arrayMat = arrresMaterial;
        arrayMat = $.grep(arrresMaterial, function (element, index) {
            var is_selected = true;
            $.each(reskeyid, function (i, obj) {
                var $this = $(this),
                    name = $this[0].id;
                if (element.data == $this.val()) is_selected = false;
            });
            return is_selected;
        });
    }

    function bindBrandResRowAutoComplete(x) {
        var $this = $(x),
            name = $this[0].id,
            arr_names = name.split('_');
        if (name.indexOf('__') != -1) return;
        var key1 = arr_names[1];
        $this.unbind('autocomplete');
        var sName = arr_names[0];
        checkResource(key1);
        $this.autocomplete({
            lookup: arrayMat,
            showNoSuggestionNotice: false,
            lookupFilter: function (suggestion, originalQuery, queryLowerCase) {
                if (queryLowerCase == '*') {
                    return suggestion.value;
                } else {
                    var re = new RegExp($.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');
                    return re.test(suggestion.value);
                }
            },
            onSelect: function (suggestion) {
                if (suggestion) {
                    $("#MaterialId_" + key1).val(suggestion.data);
                    $(this).removeClass('error');
                }
            },
            onSearchStart: function (suggestion) {
                $("#MaterialId_" + key1).val(0);
            },
            onSearchComplete: function (query, suggestions) {
                if (!suggestions.length) {
                    $(this).addClass('error');
                    $("#MaterialId_" + key1).val(0);
                } else $(this).removeClass('error');
            }
        });
    }

function backfn() {
    $('#formfrom').val("title");
    $('#frmfollowup').submit();
}

$("#submitData").click(function(){
	$("#mainForm").submit();
});
</script>