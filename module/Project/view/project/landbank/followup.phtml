<!--STYLE-->
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/js/select2.full.min.js"></script>
<link type="text/css" rel="stylesheet" href="<?php echo $this->basePath(); ?>/css/select2.min.css" />
<link rel="stylesheet" href="<?php echo $this->basePath() . '/css/project.css';?>"/>
<style type="text/css">
.action-btns										{position:absolute !important; top:0px;  right:30px;  }
.action-btns > .btn-floating						{border-radius:0px !important;background:#E2541D!important; }
.action-btns > ul > li > a.btn-floating				{border-radius:0px !important; background:#e2541d !important; font-size:20px !important; line-height:42px !important;}
.action-btns > ul > li > a i						{line-height:30px !important;}
.action-btns > .btn-large							{height:37px !important; height:37px !important;}
.action-btns > ul									{top:16px !important;font-size:23px;left:-118px;}
.action-btns > .btn-floating i						{font-size: 23px !important;line-height: 39px !important;}
#calldate 											{display:none;}
.radio_check 										{margin-bottom:25px;}
.select2 											{width:100% !important;}
.close-btn 											{margin-right:14px;font-size:14px;float:right;}
#followWrapper 										{transition: 1s ease;-webkit-transition: 1s ease;-moz-transition: 1s ease;-o-transition: 1s ease;}
#historyWrapper 									{/*position:absolute;*/right:-50%;transition:1s ease;-webkit-transition: 1s ease;-moz-transition: 1s ease;
													-o-transition: 1s ease;	}
#historyWrapper.active 								{right:0;}
.m-top5 											{margin-bottom:30px}
.show_hide 											{position:fixed;top:95px;}
.segment 											{position:relative;display:inline-block;margin-right:-27px;}
.circle 											{display:inline-block;background-color:#A8A9AD;width:20px;height:20px;line-height:20px;border-radius:50%;color:#fff;
													 font-weight:600;overflow:hidden;text-align:center;font-size:12px;}
.line 												{display:inline-block;width:55px;height:2px;margin:9px 0;background:#A8A9AD;position:relative;left:-3px;}
.label 												{position:absolute;left:15%;top:-30px;transform: translate(-50%, 0);font-size:12px;color:#A8A9AD;}
.label a 											{background:#006633;font-size:12px;color:#FFF;padding:5px;font-weight:normal;}
.label a:before 									{content: "\f0dd";font-family:FontAwesome;font-style: normal;font-weight: normal;text-decoration: inherit;color:#006633;
													 font-size:20px;padding-right:0.5em;position:absolute;top:10px;left:46%;}
.label span 										{background:#1075F4;max-width:150px;min-width:100%;color:#fff;font-size:12px;padding:5px;font-weight:normal;}
.container 											{margin:50px;}
.segment.active .circle 							{background:#063;}
.segment.active .label 								{color:#C0A05F;}
.segment.ready .circle 								{background:#ffbf00;}
.segment.ready .label 								{color:#ffbf00;}
.pro-bar 											{display:block;padding:10px 65px;}
.circle a 											{color:#fff;}
.label span:before 									{content: "\f0dd";font-family:FontAwesome;font-style:normal;font-weight:normal;text-decoration:inherit;color:#1075F4;
													 font-size:20px;padding-right: 0.5em;position:absolute;top:10px;left:45%;}
.form-horizontal 									{margin-top:26px}
.segment 											{position:relative;display:inline-block;margin-right:-10px;}
.circle 											{display:inline-block;background-color:#A8A9AD;width:20px;height:20px;line-height:20px;border-radius:50%;color:#fff;
													 font-weight:600;overflow:hidden;text-align:center;font-size:12px;}
.line 												{display:inline-block;width:55px;height:2px;margin:9px 0;background:#A8A9AD;position:relative;left:-3px;}
.lineactive 										{display:inline-block;width:55px;height:2px;margin:9px 0;background:#063;position:relative;left:-3px;}
.label 												{position:absolute;left:15%;top:-30px;transform: translate(-50%, 0);font-size:12px;color:#A8A9AD;}
.label a 											{background:#006633;font-size:12px;color:#FFF;padding:5px;font-weight:normal;}
.label a:before 									{content: "\f0dd";font-family:FontAwesome;font-style:normal;font-weight:normal;text-decoration:inherit;color:#006633;
													 font-size:20px;padding-right:0.5em;position:absolute;top:10px;left:46%;}
.label span 										{background:#1075F4;max-width:150px;min-width:100%;color:#fff;font-size:12px;padding:5px;font-weight:normal;}
.container 											{margin:50px;}
.segment.active .circle 							{background:#063;}
.segment.active .label								{color:#C0A05F;}
.pro-bar 											{display:block;padding:10px 65px;}
.circle a 											{color:#fff;}
.label span:before 									{content: "\f0dd";font-family:FontAwesome;font-style:normal;font-weight:normal;text-decoration:inherit;color:#1075F4;
													 font-size:20px;padding-right: 0.5em;position:absolute;top:10px;left:45%;}
.form-horizontal 									{margin-top:26px}
</style>
<div class="content_wrapper padlr0">
  <div class="container-fluid padlr0">
    <form action="" onsubmit="return entryValidate()"  method="post" id="landfollowup">
      <input type="hidden" id="formfrom" name="formfrom" />
      <input type="hidden" id="EnquiryId" name="EnquiryId" value = "<?php echo $EnquiryId; ?>"/>
      <input type="hidden" id="EnquiryName" name="EnquiryName" value = "<?php echo $EnquiryName; ?>"/>
      <?php if ($EnquiryId ==0) { ?>
      <div class="col-lg-12">
        <h1 class="text-center">Land Followup</h1>
      </div>
      <div class="col-lg-12 clear">
        <div class="row">
          <div class="col-lg-12 top_ct zoomIn animated" id="MainWrapper">
            <div class="col-lg-6 col-lg-offset-3 col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2 prt-next">
              <div class="col-lg-8 col-lg-offset-2 col-md-8 col-md-offset-2 col-sm-8 col-sm-offset-2 top-nexts">
                <div class="form-group">
                  <input type="text" name="PropertyName" class="form-control lbl_move" label="Name of Property" id="PropertyName" autofocus />
                </div>
                <div class="next-bt"><a href="javascript:submitProperty();">Next <i class="fa fa-chevron-circle-right"></i></a></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <?php } else { ?>
      <div class="col-lg-12 clear">
        <div class="col-lg-12">
          <h1 data-bsfhead="Followup Details">Followup Details
            <div class="btn-group proname_btn"> <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown"><?php echo ucfirst($EnquiryName);?> <span class="edit_symbols" data-placement="right" data-toggle="tooltip" data-original-title="Change&nbsp;Followup&nbsp;Name"><i class="fa fa-caret-down "></i></span></a>
              <div class="dropdown-menu toolbar_ddown proname_ddown arrow" role="menu">
                <ul>
                  <?php
                            foreach($propertynames as $landData){?>
                  <li><a href="javascript:void(0);" class="followupId" data-index="<?php echo $landData['data'];?>"><?php echo ucfirst($landData['value']);?></a></li>
                  <?php }	?>
                </ul>
              </div>
            </div>
          </h1>
        </div>
      </div>
      <div class="col-lg-12 clear">
        <div class="land-regi">
          <div class="col-lg-4 col-lg-offset-0 col-md-4 col-md-offset-0 col-sm-4 col-sm-offset-0" style="padding:0px !important;">
            <?php if (Empty($enquiry['PropImageURL']) == false) { ?>
            <div class="imgs" style="background-image:url('<?php echo $this->basePath() . $enquiry['PropImageURL'] ; ?>'); min-height:250px; min-width:200px;" ></div>
            <?php } else { ?>
            <div class="imgs" style="background-image:url('<?php echo $this->basePath(); ?>/images/no-imgs.png'); min-height:250px; min-width:200px;" ></div>
            <?php } ?>
          </div>
          <div class="col-lg-8">
            <div class="col-lg-6 col-lg-offset-0 col-md-5 col-md-offset-0 col-sm-4 col-sm-offset-0"> <span class="info-dets">
              <h1><?php echo $enquiry['PropertyName'];?></h1>
              <ul>
                <li>
                  <label>Enquiry No</label>
                  <span><a href="<?php echo $this->basePath().'/project/landbank/enquiry/'. $enquiry['EnquiryId'];?>"><?php echo $enquiry['RefNo'];?></a></span> </li>
                <li>
                  <label>Date</label>
                  <span><?php echo date('d-m-Y', strtotime($enquiry['RefDate']));?></span> </li>
                <li>
                  <label>Source</label>
                  <span><?php echo $enquiry['SourceName'];?> (<?php echo $enquiry['SourceFrom'];?>)</span> </li>
                <li>
                  <label>Price</label>
                  <span><?php echo round($enquiry['LandCost'],2);?></span> </li>
                <li>
                  <label>Total Area</label>
                  <span><?php echo round($enquiry['TotalArea'],3);?> <?php echo $enquiry['TotalAreaUnitName'];?></span> </li>
              </ul>
              </span> </div>
            <div class="col-lg-6 col-lg-offset-0 col-md-3 col-md-offset-0 col-sm-4 col-sm-offset-0"> <span class="info-dets" style=" border:none;">
              <h1>Location</h1>
              <ul>
                <li><strong><?php echo $enquiry['PropertyLocation'];?></strong></li>
                <li><strong><?php echo $enquiry['ContactNo'];?></strong></li>
                <li><strong><?php echo $enquiry['Email'];?></strong></li>
              </ul>
              <?php if ($enquiry['Latitude']!=0 && $enquiry['Longitude']!=0) { ?>
              <ul style="padding:0px;">
                <li><a href="#" class="mapss" onclick="showMap(<?php echo $enquiry['Latitude'] .','.$enquiry['Longitude'].','.$enquiry['Radius'];?>)"><i class="fa fa-map-marker" style="color:#999; font-size:18px !important;"></i> Map</a></li>
              </ul>
              <?php }?>
              </span>
              <div class="clearfix"></div>
            </div>
            <div class="status-bars">
              <div class="pro-bar">
                <div class="segment <?php if ($enquiry['IFeasibilityId'] !=0) { ?> active <?php } else { ?> ready <?php } ?>">
                  <div class="circle">
                    <?php $bNext=false; if ($enquiry['IFeasibilityId'] !=0) { $bNext =true;?>
                    <a href="<?php echo $this->basePath().'/project/landbank/initialfeasibility/'. $enquiry['EnquiryId'] . '/' . $enquiry['IFeasibilityId']. '/F'; ?>">1</a>
                    <?php } else { ?>
                    <a href="<?php echo $this->basePath().'/project/landbank/initialfeasibility/'. $enquiry['EnquiryId'] . '/' . $enquiry['IFeasibilityId']. '/F'; ?>">1</a>
                    <?php } ?>
                  </div>
                  <div class="label" style="display: none">
                    <?php if ($enquiry['IFeasibilityId'] !=0) { ?>
                    <a href="<?php echo $this->basePath().'/project/landbank/initialfeasibility/'. $enquiry['EnquiryId'] . '/' . $enquiry['IFeasibilityId']. '/F'; ?>">Initial Feasibility</a>
                    <?php } else { ?>
                    <span>Initial Feasibility</span>
                    <?php } ?>
                  </div>
                  <?php if ($enquiry['IFeasibilityId'] !=0 && $enquiry['BFeasibilityDone'] !=0) { ?>
                  <div class="lineactive"></div>
                  <?php } else { ?>
                  <div class="line"></div>
                  <?php } ?>
                </div>
                <div class="segment <?php if ($enquiry['BFeasibilityDone'] !=0) { ?> active <?php } else if ($bNext==true) { ?> ready <?php } ?>">
                  <div class="circle">
                    <?php if ($enquiry['BFeasibilityDone'] !=0) { $bNext=true;?>
                    <a href="<?php echo $this->basePath().'/project/landbank/feasibilityoption/'. $enquiry['EnquiryId'] . '/B'.'/F';?>">2</a>
                    <?php } else if ($bNext==true) { $bNext=false; ?>
                        <a href="<?php echo $this->basePath().'/project/landbank/businessfeasibility/'. $enquiry['EnquiryId'] . '/0'.'/F';?>">2</a>
                      <?php } else { $bNext=false; ?>
                          2
                      <?php } ?>
                 </div>
                  <div class="label" style="display: none">
                    <?php if ($enquiry['BFeasibilityDone'] !=0) { ?>
                    <a href="<?php echo $this->basePath().'/project/landbank/feasibilityoption/'. $enquiry['EnquiryId'] . '/B'.'/F';?>">Business Feasibility</a>
                    <?php } else { ?>
                    <span>Business Feasibility</span>
                    <?php } ?>
                  </div>
                  <?php if ($enquiry['BFeasibilityDone'] !=0 && $enquiry['FFeasibilityDone'] !=0) { ?>
                  <div class="lineactive"></div>
                  <?php } else { ?>
                  <div class="line"></div>
                  <?php } ?>
                </div>
                <div class="segment <?php if ($enquiry['FFeasibilityDone'] !=0) { ?> active <?php } else if ($bNext==true) { ?> ready <?php } ?>">
                  <div class="circle">
                    <?php if ($enquiry['FFeasibilityDone'] !=0) { $bNext=true; ?>
                    <a href="<?php echo $this->basePath().'/project/landbank/financialfeasibility/'. $enquiry['EnquiryId'].'/F';?>">3</a>
                    <?php } else if ($bNext==true) { $bNext=false; ?>
                        <a href="<?php echo $this->basePath().'/project/landbank/financialfeasibility/'. $enquiry['EnquiryId'].'/F';?>">3</a>
                    <?php } else { $bNext=false; ?>
                        3
                    <?php } ?>
                  </div>
                  <div class="label" style="display: none" >
                    <?php if ($enquiry['FFeasibilityDone'] !=0) { ?>
                    <a href="<?php echo $this->basePath().'/project/landbank/financialfeasibility/'. $enquiry['EnquiryId'].'/F';?>">Financial Feasibility</a>
                    <?php } else { ?>
                    <span>Financial Feasibility</span>
                    <?php } ?>
                  </div>
                  <?php if ($enquiry['FFeasibilityDone'] !=0 && $enquiry['DueDiligenceId'] !=0) { ?>
                  <div class="lineactive"></div>
                  <?php } else { ?>
                  <div class="line"></div>
                  <?php } ?>
                </div>
                <div class="segment <?php if ($enquiry['DueDiligenceId'] !=0) { ?> active <?php } else if ($bNext==true) { ?> ready <?php } ?>">
                  <div class="circle">
                    <?php if ($enquiry['DueDiligenceId'] !=0) { $bNext=true; ?>
                    <a href="<?php echo $this->basePath().'/project/landbank/duediligence/'. $enquiry['EnquiryId'] . '/' .$enquiry['DueDiligenceId'].'/F';?>">4</a>
                    <?php } else if ($bNext==true) { $bNext=false; ?>
                        <a href="<?php echo $this->basePath().'/project/landbank/duediligence/'. $enquiry['EnquiryId'] . '/' .$enquiry['DueDiligenceId'].'/F';?>">4</a>
                    <?php } else { $bNext=false; ?>
                        4
                    <?php } ?>
                  </div>
                  <div class="label" style="display: none">
                    <?php if ($enquiry['DueDiligenceId'] !=0) { ?>
                    <a href="<?php echo $this->basePath().'/project/landbank/duediligence/'. $enquiry['EnquiryId'] . '/' . $enquiry['DueDiligenceId'].'/F';?>">Duediligence</a>
                    <?php } else { ?>
                    <span>Duediligence</span>
                    <?php } ?>
                  </div>
                  <?php if ($enquiry['DueDiligenceId'] !=0 && $enquiry['FinalizationId'] !=0) { ?>
                  <div class="lineactive"></div>
                  <?php } else { ?>
                  <div class="line"></div>
                  <?php } ?>
                </div>
                <div class="segment  <?php if ($enquiry['FinalizationId'] !=0) { ?> active <?php } else if ($bNext==true) { ?> ready <?php } ?>">
                  <div class="circle">
                    <?php if ($enquiry['FinalizationId'] !=0) { $bNext=true; ?>
                    <a href="<?php echo $this->basePath().'/project/landbank/finalization/'. $enquiry['EnquiryId'] . '/' . $enquiry['FinalizationId'].'/F';?>">5</a>
                    <?php } else if ($bNext==true) { $bNext=false; ?>
                    <a href="<?php echo $this->basePath().'/project/landbank/finalization/'. $enquiry['EnquiryId'] . '/' . $enquiry['FinalizationId'].'/F';?>">5</a>
                    <?php } else { $bNext=false; ?>
                        5
                    <?php } ?>
                  </div>
                  <div class="label" style="display: none">
                    <?php if ($enquiry['FinalizationId'] !=0) { ?>
                    <a href="<?php echo $this->basePath().'/project/landbank/finalization/'. $enquiry['EnquiryId'] . '/' . $enquiry['FinalizationId'].'/F';?>">Finalisation</a>
                    <?php } else { ?>
                    <span>Finalisation</span>
                    <?php } ?>
                  </div>
                  <?php if ($enquiry['FinalizationId'] !=0 && $enquiry['ConceptionDone'] !=0) { ?>
                  <div class="lineactive"></div>
                  <?php } else { ?>
                  <div class="line"></div>
                  <?php } ?>
                </div>
                <div class="segment <?php if ($enquiry['ConceptionDone'] !=0) { ?> active <?php } ?>">
                  <div class="circle">
                    <?php if ($enquiry['ConceptionDone'] !=0) { ?>
                    <a href="<?php echo $this->basePath().'/project/landbank/projectconception/'. $enquiry['EnquiryId'];?>">6</a>
                    <?php } else { ?>
                        <a href="<?php echo $this->basePath().'/project/landbank/projectconception/'. $enquiry['EnquiryId'];?>">6</a>
                    <?php } ?>
                  </div>
                  <div class="label" style="display: none">
                    <?php if ($enquiry['ConceptionDone'] !=0) { ?>
                    <a href="<?php echo $this->basePath().'/project/landbank/projectconception/'. $enquiry['EnquiryId'];?>">Project Conception</a>
                    <?php } else { ?>
                    <span>Project Conception</span>
                    <?php } ?>
                  </div>
                  <?php if ($enquiry['ConceptionDone'] !=0 && $enquiry['KickoffDone'] !=0) { ?>
                  <div class="lineactive"></div>
                  <?php } else { ?>
                  <div class="line"></div>
                  <?php } ?>
                </div>
                <div class="segment  <?php if ($enquiry['KickoffDone'] !=0) { ?> active <?php } ?>">
                  <div class="circle">
                    <?php if ($enquiry['KickoffDone'] !=0) { ?>
                    <a href="<?php echo $this->basePath().'/kickoff/index/project-kickoff/'. $enquiry['EnquiryId'];?>">7</a>
                    <?php } else { ?>
                        <a href="<?php echo $this->basePath().'/kickoff/index/project-kickoff/'. $enquiry['EnquiryId'];?>">7</a>
                    <?php } ?>
                  </div>
                  <div class="label" style="display: none">
                    <?php if ($enquiry['KickoffDone'] !=0) { ?>
                    <a href="<?php echo $this->basePath().'/kickoff/index/project-kickoff/'. $enquiry['EnquiryId'];?>">Project Kickoff</a>
                    <?php } else { ?>
                    <span>Project Kickoff</span>
                    <?php } ?>
                  </div>
                </div>
              </div>
            </div>
          </div>
         <!--Excel-->
        <div class="fixed-action-btn active action-btns">
        <a class="btn-floating btn-large" data-toggle="tooltip" data-placement="bottom" data-original-title="Comparison">
          <i class="fa fa-arrows"></i>
        </a>
        <ul>
            <li>
                <a class="btn-floating" href="#" data-toggle="tooltip" data-placement="bottom" data-original-title="Business Feasibility">
                   <i class="fa fa-briefcase fa-icons"></i>
                
                </a>
            </li>
            <li>
                <a class="btn-floating" href="#" download data-toggle="tooltip" data-placement="bottom" data-original-title="Project Conception">
                  <i class="fa fa-file-text-o fa-icons"></i>
                </a>
            </li>
        </ul>
    </div>
        </div>
      </div>
      <div class="col-lg-12 clear">
        <div class="col-lg-6 cl" id="followWrapper">
          <div class="col-lg-10 col-lg-offset-0 col-md-6 col-md-offset-0 col-sm-6 col-sm-offset-0 col-xs-12 col-xs-offset-0">
            <div class="form-horizontal">
              <div class="row">
                <div class="form-group">
                  <div class="col-lg-12"> <span class="date_icon"><i class="fa fa-calendar"></i></span>
                    <input type="text" readonly name="RefDate" id="RefDate" class="form-control lbl_move date_picker" label="Ref Date" value="<?php echo date("d-m-Y");?>" />
                  </div>
                </div>
                <!--                <div class="form-group">--> 
                <!--                  <div class="col-lg-12">--> 
                <!--                    <input type="text" name="PropertyName" id="PropertyName" class="form-control lbl_move" label="Property Name" value="" autofocus/>--> 
                <!--                    <input type="hidden" id="EnquiryId" name="EnquiryId"/>--> 
                <!--                  </div>--> 
                <!--                </div>-->
                <div class="form-group" id="divCallType">
                  <div class="col-lg-12">
                    <select name="EnquiryCallType" id="EnquiryCallType" onchange="FollowupType();" class="form-control selectpicker show-tick" data-size="5" label="Followup Type">
                      <option value="">Select Followup Type</option>
                      <?php foreach($enquiryCallType as $trans) { ?>
                      <option value="<?php echo $trans['CallTypeId']; ?>"><?php echo $trans['CallTypeName']; ?></option>
                      <?php } ?>
                    </select>
                  </div>
                </div>
                <!--Hidden Div -->
                <div class="form-group" id ="divChecklistType" style="display: none">
                  <div class="col-lg-12"> <!--onchange="FollowupType();"--><!--onchange="checklist();"-->
                    <select name="ChecklistType" id="ChecklistType" onchange="checklistType();" class="form-control selectpicker show-tick" data-size="5" label="Select Checklist Type">
                        <option value="">Select Checklist</option>
                      <?php foreach($checklisttype as $trow) { ?>
                      <option value="<?php echo $trow['TypeId']; ?>"><?php echo $trow['CheckListTypeName']; ?></option>
                      <?php } ?>
                    </select>
                  </div>
                </div>
                <div class="form-group" id ="divBroker" style="display: none">
                  <div class="col-lg-12">
                    <select name="brokerList" id="brokerList" onchange="ShowCallNature();" class="form-control selectpicker show-tick" data-size="5" label="BrokerName">
                      <option value="" >Select BrokerName</option>
                    </select>
                  </div>
                </div>
                <div class="form-group" id ="divOwner" style="display: none">
                  <div class="col-lg-12">
                    <select name="ownerList" id="ownerList" onchange="ShowCallNature();" class="form-control selectpicker show-tick" data-size="5" label="OwnerName">
                      <option value="" >Select Owner </option>
                    </select>
                  </div>
                </div>
                <div class="form-group" id ="divChecklistAssign" style="display: none">
                  <div class="col-md-12">
                    <select name="TenderAssignChecklist" id="TenderAssignChecklist" onchange="checklist();" class="form-control selectpicker show-tick add-icn col-md-11" data-size="5" label="Tender-Checklist">
                      <option value="" >Select Assign Checklist </option>
                    </select>
                   <a class="fa-add-icn" href="javascript:void(0)" onclick="checklistAddEdit('add');"><i class="fa fa-plus"></i></a>
                  
                </div></div>
                <div class="form-group" id ="divChecklistAction" style="display: none">
                  <div class="col-md-12">
                    <select name="TenderActionChecklist" id="TenderActionChecklist" onchange="checklist();" class="form-control selectpicker show-tick add-icn" data-size="5" label="Tender-Checklist">
                      <option value="" >Select Action Checklist </option>
                    </select>
                  </div>
                </div>
                <div class="form-group" id ="divUser" style="display: none">
                  <div class="col-lg-12">
                    <select name="checklistUser" id="checklistUser" onchange="checklist();" class="form-control selectpicker show-tick" data-size="5" label="Username">
                      <option value="" >Select UserName</option>
                      <?php foreach($UserName as $value) { ?>
                      <option value="<?php echo $value['UserId']; ?>"><?php echo $value['UserName']; ?></option>
                      <?php } ?>
                    </select>
                  </div>
                </div>
                <div class="form-group" id = "divChecklistDate" style="display: none">
                  <div class="col-lg-12"> <span class="date_icon"><i class="fa fa-calendar"></i></span>
                    <input type="text" readonly name="checklistDate" id="checklistDate" onchange="ShowRemarks();" class="form-control lbl_move date_picker" label="Target Date" value="" />
                  </div>
                </div>
                <div class="form-group" id ="divProgress" style="display: none">
                  <div class="col-lg-12">
                    <select name="Progress" id="Progress" class="form-control selectpicker show-tick" onchange="ShowRemarks();" data-size="5" label="Progress">
                      <option value="" >Select Progress</option>
                      <option value="In-Progress">In-Progress</option>
                      <option value="Done">Done</option>
                      <option value="Closed">Closed</option>
                    </select>
                  </div>
                </div>
                <!--End of Hidden div-->
                <div class="form-group" id="divCallNature" style="display: none">
                  <div class="col-lg-12">
                    <input type="text" name="NatureofCall" id="NatureofCall" class="form-control lbl_move" label="Nature of Call" value="" />
                    <input type="hidden" id="NatureofCallId" name="NatureofCallId" value="" />
                  </div>
                </div>
                <div class="form-group" style="display: none; margin-bottom:15px !important;" id="divRemarks">
                  <div class="col-lg-12">
                    <textarea id="Remarks" name="Remarks" class="form-control lbl_move" label="Remarks"/>
                    <?php echo (isset($arr_follow)) ? $arr_follow['Remarks'] : ''; ?></textarea>
                  </div>
                </div>
                <div class="form-group" style="display: none; margin-bottom:15px !important;" id="divReason">
                  <div class="col-lg-12">
                    <input type="text" id="Reason" name="Reason" class="form-control lbl_move" label="Reason" value="<?php echo (isset($arr_follow)) ? $arr_follow['Reason'] : ''; ?>" />
                  </div>
                </div>
                <div class="radio_check col-lg-12" id="divNextCall" style="display: none;">
                  <p>
                    <input type="checkbox" id="next-call-req" value="1" name="NextCallRequired" onchange="ToggleCallRequired(this);" <?php echo (isset($arr_follow) && $arr_follow['NextCallRequired'] == '1') ? 'checked'  : ''; ?>>
                    <label style="position: relative; overflow: hidden;" class="ripple has-ripple" for="next-call-req">Next Call Required<span class="ripple-wrapper"></span><span class="ripple-wrapper"></span></label>
                  </p>
                </div>
                <div class="form-group" id="calldate" <?php echo (isset($arr_follow) && $arr_follow['NextCallRequired'] == '1') ? 'style="display: block;"'  : ''; ?>>
                  <div class="col-lg-12"> <span class="date_icon"><i class="fa fa-calendar"></i></span>
                    <input type="text" name="NextCallDate" id="NextCallDate" class="form-control lbl_move date_picker" label="Next Call Date"/>
                  </div>
                </div>
              </div>
            </div>
            <div class="cont_bt-list flrgt">
              <ul>
                <li><a href="javascript:submitProperty();" class="ripple steps_btn">Cancel</a></li>
                <li><a href="javascript:submitForm();" class="ripple cbtn">Submit <i class="fa fa-check-circle"></i></a>
              </ul>
            </div>
          </div>
        </div>
        <div class="col-lg-6 col-lg-offset-0 col-md-6 col-md-offset-0 col-sm-6  col-xs-12 col-sm-offset-0 active" id="historyWrapper">
          <div class="fu-history clear">
            <h1>Followup History<a href="javascript:hideHistory();" class="close-btn"><i class="fa fa-close"></i></a>
              <div class="clearfix"></div>
            </h1>
            <div class="history-detalis" id="historyDetails"></div>
          </div>
        </div>
      </div>
      <?php } ?>
    </form>
  </div>
</div>

<!--Add/Edit Confirmation Modal-->
<div class="modal fade" id="AddEditModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h1 id="headerText">Edit Checklist</h1>
            </div>
            <div class="modal-body">
                <div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1 col-sm-10 col-sm-offset-1">
                    <form class="form-horizontal" method="POST" id="addEditForm" autocomplete="off">
                        <div class="row">
                            <div class="form-group req_flds padtop10 col-lg-12">
                                <input type="text" id="modalChecklistName" name="name" autocomplete="off" class="form-control lbl_move" maxlength="150" label="Name"/>
                                <input type="hidden" name="id" id="modalChecklistId"/>
                            </div>
                        </div>
                        <div class="row">
                            <div class="form-group req_flds col-lg-12">
                                <select name="type" id="modalChecklistType" autocomplete="off" class="form-control lbl_move" label="Type">
                                    <?php foreach($checklisttype as $trow) { ?>
                                        <option value="<?php echo $trow['TypeId']; ?>"><?php echo $trow['CheckListTypeName']; ?></option>
                                    <?php } ?>
                                </select>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="modal-footer clear">
                <div class="col-lg-12 savebtn_area no_border">
                    <ul>
                        <li class="save_btn float_r">
                            <a href="javascript:void(0)" onclick="addUpdateFn();" id="btnEditYes" class="ripple">Update</a>
                        </li>
                        <li class="cancel_btn float_r"><a href="javascript:void(0);" aria-hidden="true" data-dismiss="modal" class="ripple">Cancel</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">

    $(document).ready(function(){
        $(".slidingDiv").hide();
        $(".show_hide").show();

        $('.show_hide').click(function(){
            $(".slidingDiv").slideToggle();
        });

        $(".single_dropdown2").select2({
            placeholder: "",
            allowClear: true
        });



    });

    function submitProperty() {
        var id = $enquiryId.val();
        if(id == 0) {
            alert('Select a property!');
            return;
        }
        $('#formfrom').val("title");
        $('#landfollowup').submit();
    }


</script> 
<!--javascript:hideHistory();--> 
<script type="text/javascript">
var arr_propertynames =  <?php echo (isset($propertynames)) ? json_encode($propertynames) : '[]';?>;
//    var arr_natureofcall = <?php //echo (isset($natureofcalls)) ? json_encode($natureofcalls) : '[]';?>//;
var arr_CallNature = <?php echo (isset($CallNature)) ? json_encode($CallNature) : '[]';?>;
var arrReason = <?php echo (isset($Reason)) ? json_encode($Reason) : '[]';?>;

var $propertyName = $('#PropertyName'),
    $enquiryId = $('#EnquiryId'),
    $natureofcall = $('#NatureofCall'),
    $natureofcallid = $('#NatureofCallId'),
    $Reason = $('#Reason'),
    $callType = $('#EnquiryCallType'),
    $remarks = $('#Remarks'),
    $nextCallDate = $('#NextCallDate'),
    $callDate = $('#calldate'),
    $RefDate = $('#RefDate'),
    $followWrapper = $('#followWrapper'),
    $nextCallRequired = $('#next-call-req'),
    $historyWrapper = $('#historyWrapper'),
    $historyDetails = $('#historyDetails');
$TenderAssignChecklist = $('#TenderAssignChecklist');
$TenderActionChecklist = $('#TenderActionChecklist');
$checklistUser = $('#checklistUser');
$checklistDate = $('#checklistDate');
$Progress = $('#Progress');

function ShowCallType() {
    $('#divCallType').fadeIn();
}

function ShowCallNature() {
    $('#EnquiryCallType').prop('disabled',true);
    //$('#PropertyName').prop('disabled',true);

    $('#divCallNature').fadeIn();
}
function ShowRemarks() {
    $('#divRemarks').fadeIn();
    var iCallTypeId = parseInt(isNullCheck($callType.val(),'number'));
    if (iCallTypeId ==10 || iCallTypeId ==11) $('#divNextCall').fadeIn();
    else { $('#divNextCall').fadeOut(); }
}
function FollowupType() {
    var enquiryId = $enquiryId.val();
    var CallTypeId = $callType.val();
    var Date = $RefDate.val();

    if ($RefDate.val().length == 0) {
        alert('Ref Date is Required!');
        $RefDate.focus();
        return;
    }
//
//        if ($propertyName.val().length == 0 || enquiryId.length == 0 || enquiryId == 0) {
//            alert('Choose Property Name!');
//            $propertyName.focus();
//            return;
//        }
    //Make Readonly for Property Name
//        $('#PropertyName').prop('disabled',true);

    if ($callType.val() == 1) {
        var iFId = 0;
        $('.loading_area').show();
        $.ajax({
            url: getBaseURL() + "project/landbank/followup",
            data: {type: 'Initial-Feasibility', data: enquiryId},
            async: false,
            type: 'post',
            success: function (data, status) {
                iFId = parseInt(isNullCheck(data, 'number'));
            }
        });
        if (iFId != 0) {
            window.location.href = getBaseURL() + "project/landbank/initialfeasibility/" + iFId;
        } else {
            window.location.href = getBaseURL() + "project/landbank/initialfeasibility";
        }
        $('.loading_area').hide();
    } else if($callType.val() == 2) {
        var iFId = 0;
        $('.loading_area').show();
        $.ajax({
            url: getBaseURL() + "project/landbank/followup",
            data: {type: 'BusinessFeasibility', data: enquiryId},
            async: false,
            type: 'post',
            success: function (data, status) {
                iFId = parseInt(isNullCheck(data, 'number'));
            }
        });
        if (iFId != 0) {
            window.location.href = getBaseURL() + "project/landbank/feasibilityoption/" + enquiryId + "/B";
        } else {
            window.location.href = getBaseURL() + "project/landbank/businessfeasibility";
        }
        $('.loading_area').hide();
    } else if($callType.val() == 3) {
        $('.loading_area').show();
        window.location.href = getBaseURL() + "project/landbank/financialfeasibility/" + enquiryId;
        $('.loading_area').hide();
    } else if($callType.val() == 4) {
        var iFId = 0;
        $('.loading_area').show();
        $.ajax({
            url: getBaseURL() + "project/landbank/followup",
            data: {type: 'Due-Diligence', data: enquiryId},
            async: false,
            type: 'post',
            success: function (data, status) {
                iFId = parseInt(isNullCheck(data, 'number'));
            }
        });
        if (iFId != 0) {
            window.location.href = getBaseURL() + "project/landbank/duediligence/" + iFId;
        } else {
            window.location.href = getBaseURL() + "project/landbank/duediligence";
        }
        $('.loading_area').hide();
    } else if($callType.val() == 5) {
        var iFId = 0;
        $('.loading_area').show();
        $.ajax({
            url: getBaseURL() + "project/landbank/followup",
            data: {type: 'Finalization', data: enquiryId},
            async: false,
            type: 'post',
            success: function (data, status) {
                iFId = parseInt(isNullCheck(data, 'number'));
            }
        });
        if (iFId != 0) {
            window.location.href = getBaseURL() + "project/landbank/finalization/" + iFId;
        } else {
            window.location.href = getBaseURL() + "project/landbank/finalization";
        }
        $('.loading_area').hide();
    } else if($callType.val() == 6) {
        $('.loading_area').show();
        window.location.href = getBaseURL() + "project/landbank/projectconception/" + enquiryId;
        $('.loading_area').hide();
    } else if($callType.val() == 7) {
        var iFId = 0;
        $('.loading_area').show();
        $.ajax({
            url: getBaseURL() + "project/landbank/followup",
            data: {type: 'Project-KickOff', data: enquiryId},
            async: false,
            type: 'post',
            success: function (data, status) {
                iFId = parseInt(isNullCheck(data, 'number'));
            }
        });
        if (iFId != 0) {
            window.location.href = getBaseURL() + "kickoff/index/conception/" + iFId;
        } else {
            window.location.href = getBaseURL() + "kickoff/index/project-kickoff";
        }
        $('.loading_area').hide();
    } else if ($callType.val() == 8) {
        $('#divUser').fadeOut();
        $('#divChecklistDate').fadeOut();
        $('#divChecklistAssign').fadeOut();
        $('#divProgress').fadeOut();
        $('#divChecklistAction').fadeOut();
        $('#divChecklistType').fadeIn();
    } else if($callType.val() == 9) {
        $('#divUser').fadeOut();
        $('#divChecklistDate').fadeOut();
        $('#divChecklistAssign').fadeOut();
        $('#divProgress').fadeOut();
        $('#divChecklistAction').fadeOut();
        $('#divChecklistType').fadeIn();
    } else if ($callType.val() == 10) {
        oWnerList();
    } else if ($callType.val() == 11) {
        BrokerList();
    } else if ($callType.val() == 12) {
        //Closed
        ShowRemarks();
        showReason();
    }
}
function showReason() {
    $('#divUser').fadeOut();
    $('#divChecklistDate').fadeOut();
    $('#divChecklistAssign').fadeOut();
    $('#divProgress').fadeOut();
    $('#divChecklistAction').fadeOut();
    $('#divChecklistType').fadeOut();

    $('#divReason').fadeIn();
}

function oWnerList() {
    var enquiryId = $enquiryId.val();
    $.ajax({
        url: getBaseURL() + "project/landbank/followup",
        async: false,
        data: {type: 'Owner', data: enquiryId},
        type: 'post',
        success: function (data, status) {
            var arr = JSON.parse(data);
            if(!data)
                return;
            $('#ownerList').html("<option value=''>Select Owner Name</option>");

            $.each(arr, function (index, value) {
                $('#ownerList').append(
                    $('<option></option>')
                        .val(value.OwnerId)
                        .html(value.OnwerName)
                ).selectpicker('refresh');
            });
        }
    });
    $('#divBroker').fadeOut();

    //$('#EnquiryCallType').
    $('#divOwner').fadeIn();
}
function BrokerList() {
    var enquiryId = $enquiryId.val();
    $.ajax({
        url: getBaseURL() + "project/landbank/followup",
        async: false,
        data: {type: 'Broker', data: enquiryId},
        type: 'post',
        success: function (data, status) {
            var arr = JSON.parse(data);
            if(!data)
                return;
            $('#brokerList').html("<option value=''>Select Broker Name</option>");
            $.each(arr, function (index, value) {
                $('#brokerList').append(
                    $('<option></option>')
                        .val(value.VendorId)
                        .html(value.VendorName)
                ).selectpicker('refresh');
            });
        }
    });
    $('#divOwner').fadeOut();
    $('#divBroker').fadeIn();
}

function checklistType() {
    //$('#PropertyName').prop('disabled',true);
    $('#EnquiryCallType').prop('disabled',true);
//        $('#EnquiryCallType').selectpicker('enable',false);
    if($callType.val() == 8) {
        var ChecklistType =$('#divChecklistType option:selected').val();
        $.ajax({
            url: getBaseURL() + "project/landbank/followup",
            async: false,
            data: {'ChecklistAssign': ChecklistType,'type':'ChecklistAssign'},
            type: 'post',
            success: function (data, status) {
                var arr = JSON.parse(data);
                if(!data)
                    return;
                $('#TenderAssignChecklist').html("<option value=''>Select Checklist Name</option>");

                $.each(arr, function (index, value) {
                    $('#TenderAssignChecklist').append(
                        $('<option></option>')
                            .val(value.CheckListId)
                            .html(value.CheckListName)
                    ).selectpicker('refresh');
                });
            }
        });
        $('#divChecklistAssign').fadeIn();
    } else if ($callType.val() == 9) {
        var ChecklistType =$('#divChecklistType option:selected').val();
        $.ajax({
            url: getBaseURL() + "project/landbank/followup",
            async: false,
            data: {'ChecklistAction': ChecklistType,'type':'ChecklistAction'},
            type: 'post',
            success: function (data, status) {
                var arr = JSON.parse(data);
                if(!data)
                    return;
                $('#TenderActionChecklist').html("<option value=''>Select Checklist Name</option>");
                $.each(arr, function (index, value) {
                    $('#TenderActionChecklist').append(
                        $('<option></option>')
                            .val(value.CheckListId)
                            .html(value.CheckListName)
                    ).selectpicker('refresh');
                });
            }
        });
        $('#divChecklistAction').fadeIn();
    }
}
function checklist() {
    //$('#PropertyName').prop('disabled',true);
    $('#EnquiryCallType').prop('disabled',true);
    $('#ChecklistType').prop('disabled',true);

    $('#divUser').fadeIn();
    if($callType.val() == 8) {
        $('#divChecklistDate').fadeIn();
    } else if ($callType.val() == 9) {
        $('#divProgress').fadeIn();
    }
}

$(function() {
    // bind property name autocomplete
    $propertyName.autocomplete({
        lookup: arr_propertynames,
        showNoSuggestionNotice: false,
        lookupFilter: function (suggestion, originalQuery, queryLowerCase) {
            if (queryLowerCase == '*') {
                return suggestion.value;
            } else {
                var re = new RegExp($.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');
                return re.test(suggestion.value);
            }
        },
        onSelect: function (suggestion) {
            if (suggestion) {
                $enquiryId.val(suggestion.data);
                $('#EnquiryName').val(suggestion.value);
                //ShowCallType();
                //updateDetails(suggestion.data);
                $(this).removeClass('error');
            }
        },
        onSearchStart: function (suggestion) {
            $enquiryId.val(0);
            $('#EnquiryName').val("");
        },
        onSearchComplete: function (query, suggestions) {
            if (!suggestions.length) {
                $(this).addClass('error');
                $enquiryId.val(0);
            } else
                $(this).removeClass('error');
        }
    });

    //Reason Input auto completed
    $Reason.autocomplete({
        lookup: arrReason,
        showNoSuggestionNotice: false,
        lookupFilter: function (suggestion, originalQuery, queryLowerCase) {
            if (queryLowerCase == '*') {
                return suggestion.value;
            } else {
                var re = new RegExp($.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');
                return re.test(suggestion.value);
            }
        }
    });

    $natureofcall.autocomplete({
        lookup: arr_CallNature,
        showNoSuggestionNotice: false,
        lookupFilter: function (suggestion, originalQuery, queryLowerCase) {
            if (queryLowerCase == '*') {
                return suggestion.value;
            } else {
                var re = new RegExp($.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');
                return re.test(suggestion.value);
            }
        },
        onSelect: function (suggestion) {
            if (suggestion) {
                $natureofcallid.val(suggestion.data);
                ShowRemarks();
                $(this).removeClass('error');
            }
        },
        onSearchStart: function (suggestion) {
            $natureofcallid.val(0);
        },
        onSearchComplete: function (query, suggestions) {
            if (!suggestions.length) {
                $(this).addClass('error');
                $natureofcallid.val(0);
            } else
                $(this).removeClass('error');
        }
    });

    var iEnquiryId = <?php if(isset($EnquiryId)) echo json_encode($EnquiryId); else echo "0";?>;
    if (parseInt(iEnquiryId) !=0) updateDetails(iEnquiryId);

    // select2 initialize
//        $(".single_dropdown2").select2({
//            placeholder: "",
//            minimumResultsForSearch: -1
//        });

    //Load Values if Edit page
    var arrCall = <?php if(isset($Call)) echo json_encode($Call); else echo "[]";?>;
    var arrProperty = <?php if(isset($Property)) echo json_encode($Property); else echo "[]";?>;
    var arrLandBankFollow = <?php if(isset($LandBankFollow)) echo json_encode($LandBankFollow); else echo "[]";?>;
    var arrAssignlist = <?php if(isset($Assignlist)) echo json_encode($Assignlist); else echo "[]";?>;
    var arrActionlist = <?php if(isset($Actionlist)) echo json_encode($Actionlist); else echo "[]";?>;
    if(arrCall.length != 0) {
        $('#NatureofCall').val(arrCall.NatureOfCall);
    }
    if(arrProperty.length != 0) {
        $('#PropertyName').val(arrProperty.PropertyName);
    }
    if(arrLandBankFollow.length != 0) {
        $('#EnquiryCallType').val(arrLandBankFollow.CallTypeId).prop('disabled',true);
        $('#Remarks').val(arrLandBankFollow.Remarks);
        if(arrLandBankFollow.NextCallRequired == 1) {
            var d1 =arrLandBankFollow.NextCallDate.substring(8,10) + '-' + arrLandBankFollow.NextCallDate.substring(5,7) + '-' + arrLandBankFollow.NextCallDate.substring(0,4);
            $('#NextCallDate').val(d1);
        }
        if(arrLandBankFollow.CallTypeId == 8) {
            //Show Assign Checklist
            $('#divUser').fadeIn();
            $('#divChecklistDate').fadeIn();
            $('#divChecklistAssign').fadeIn();
            $('#divChecklistType').fadeIn();
            $('#ChecklistType').val(arrAssignlist.CheckListType).prop('disabled',true);

            $('#checklistUser').val(arrAssignlist.UserId);
            var d2 =arrAssignlist.ChecklistDate.substring(8,10) + '-' + arrAssignlist.ChecklistDate.substring(5,7) + '-' + arrAssignlist.ChecklistDate.substring(0,4);
            $('#checklistDate').val(d2);

            $('#TenderAssignChecklist').html("<option value='"+arrAssignlist.CheckListId+"' selected>"+arrAssignlist.CheckListName+"</option>").prop('disabled',true);


        } else if(arrLandBankFollow.CallTypeId == 9) {
            //Show Checklist Action
            $('#divUser').fadeIn();
            $('#divProgress').fadeIn();
            $('#divChecklistAction').fadeIn();
            $('#divChecklistType').fadeIn();
            $('#ChecklistType').val(arrActionlist.CheckListType).prop('disabled',true);
            $('#TenderActionChecklist').html("<option value='"+arrActionlist.CheckListId+"' selected>"+arrActionlist.CheckListName+"</option>").prop('disabled',true);
            $('#checklistUser').val(arrActionlist.UserId);
            $('#Progress').val(arrActionlist.Status);

        } else if(arrLandBankFollow.CallTypeId == 11) {
            //Broker
            $('#divBroker').fadeIn();
            $('#divCallNature').fadeIn();
            $('#divCallType').fadeIn();
            $('#divRemarks').fadeIn();

            $('#PropertyName').val(arrLandBankFollow.PropertyName);
            $('#EnquiryId').val(arrLandBankFollow.EnquiryId);
            $('#EnquiryCallType').val(arrLandBankFollow.CallTypeId);
            console.log(arrLandBankFollow.CallNatureId);
            $('#NatureofCall').val(arrLandBankFollow.CallNatureName);
            $('#NatureofCallId').val(arrLandBankFollow.CallNatureId);
            BrokerList();

            $('#brokerList').html("<option value='"+arrLandBankFollow.BrokerId+"' selected>"+arrLandBankFollow.VendorName+"</option>").selectpicker('refresh').prop('disabled',true);
            $('#PropertyName').prop('disabled',true);
            $('#EnquiryCallType').prop('disabled',true);
            //Next Call required or not
            if(arrLandBankFollow.NextCallRequired == 1) {
                var d1 =arrLandBankFollow.NextCallDate.substring(8,10) + '-' + arrLandBankFollow.NextCallDate.substring(5,7) + '-' + arrLandBankFollow.NextCallDate.substring(0,4);
                $('#calldate').fadeIn();
                $('#NextCallDate').val(d1);
            }
        } else if(arrLandBankFollow.CallTypeId == 12) {
            //Closed
            $('#divRemarks').fadeIn();
            $('#divReason').fadeIn();
            //Value Loaded in php
        }

    }
});


function showallHistory() {
    var id = $enquiryId.val();
    $.ajax({
        url: getBaseURL() + "project/landbank/followup",
        async: false,
        data: {'EnquiryId': id,'type':'Enquiry','show':'all'},
        type: 'post',
        success: function (data, status) {
            if(!data)
                return;

            $historyDetails.html(data);

        }
    });
}

// fetch data
function updateDetails(id) {
    $.ajax({
        url: getBaseURL() + "project/landbank/followup",
        async: false,
        data: {'EnquiryId': id,'type':'Enquiry','show':'limit'},
        type: 'post',
        success: function (data, status) {
            if(!data)
                return;

            $historyDetails.html(data);

        }
    });
}
$(function() {
    $(".lightGallery").lightGallery({
        loop: true
    });
    bindMouseover();
});

function bindMouseover() {
    $(".sortoption").change(function() {
        registerreload();
    });

    $(".circle").mouseover(function() {
        $this = $(this);
        $parent = $this.parent();
        $parent.find('.label').show();
    });
    $(".label").mouseover(function() {
        $this = $(this);
        $parent = $this.parent();
        $parent.find('.label').show();
    });
    $(".circle").mouseout(function() {
        $this = $(this);
        $parent = $this.parent();
        $parent.find('.label').hide();
    });
    $(".label").mouseout(function() {
        $this = $(this);
        $parent = $this.parent();
        $parent.find('.label').hide();
    });
}

function submitForm() {
    $('#PropertyName').prop('disabled',false);
    $('#PropertyName').focus();
    $('#EnquiryCallType').prop('disabled',false);
    $('#ChecklistType').prop('disabled',false);
    $('#brokerList').prop('disabled',false);

    $('form').submit();
}

function entryValidate() {

    if ($('#formfrom').val() == "title") return true;

    var enquiryId = $enquiryId.val();

    if($RefDate.val().length == 0) {
        alert('Ref Date is Required!');
        return false;
    }

    if(enquiryId.length == 0 || enquiryId == 0) {
        alert('Choose Property Name!');
        return false;
    }

//        var natureofcallId = $natureofcallid.val();
//        if($natureofcall.val().length == 0 || natureofcallId.length == 0 || natureofcallId == 0) {
//            alert('Choose Nature of Call!');
//            return false;
//        }

    if($callType.find('option:selected').val().length == 0) {
        alert('Choose Enquiry Call Type!');
        return false;
    }

    if($callType.find('option:selected').val().length != 0 ) {
        //Assign CheckList
        if($callType.val() == 8 && $TenderAssignChecklist.find('option:selected').val().length == 0) {
            alert("Choose Tender Checklist");
            return false;
        }
        if($callType.val() == 8 && $TenderAssignChecklist.find('option:selected').val().length != 0) {
            if($checklistUser.find('option:selected').val().length == 0) {
                alert("Username is Required");
                return false;
            }
            if($checklistDate.val().length == 0) {
                alert("Checklist Date is Required");
                return false;
            }
        }
        //CheckList Action
        if($callType.val() == 9 && $TenderActionChecklist.find('option:selected').val().length == 0) {
            alert("Choose Tender Checklist");
            return false;
        }
        if($callType.val() == 9 && $TenderActionChecklist.find('option:selected').val().length != 0) {
            if($checklistUser.find('option:selected').val().length == 0) {
                alert("Username is Required");
                return false;
            }
            if($Progress.find('option:selected').val().length == 0) {
                alert("Progress is Required");
                return false;
            }
        }
    }
    if($remarks.val().length == 0) {
        alert('Remarks is Required!');
        return false;
    }

    if($nextCallRequired.is(':checked') && $nextCallDate.val().length == 0) {
        alert('Next Call Date is Required!');
        return false;
    }
}

$('.followupId').on('click',function(){
    var urlId = $(this).attr('data-index');
    $enquiryId.val(urlId);
    $('#EnquiryName').val($(this).text());
    $('#formfrom').val("title");
    $('#landfollowup').submit();
});


function hideHistory() {
//        setTimeout(function() {
//            $followWrapper.addClass('col-lg-offset-3');
//        }, 500);
    //$followWrapper.addClass('col-lg-offset-3');
    //$historyWrapper.removeClass('active');
}

function ToggleCallRequired(x) {
    if($(x).is(':checked')) {
        $callDate.fadeIn();
        //$('#divNextCallType').fadeIn();
    } else {
        $callDate.fadeOut();
        //$('#divNextCallType').fadeOut();
    }
}

var $AddEditModal = $('#AddEditModal'),
    $modalChecklistId = $('#modalChecklistId'),
    $modalChecklistName = $('#modalChecklistName'),
    $modalChecklistType = $('#modalChecklistType');

function checklistAddEdit(mode,row) {
    removeError($("#ChecklistName"));
    if(mode== 'add'){
        $AddEditModal.data('mode', 'add').modal('show');
        $modalChecklistId.val(0);
        $AddEditModal.data('mode', 'add').modal('show');
        $modalChecklistName.val('');
        $modalChecklistType.val($('#ChecklistType').val());
        $("#headerText").html("New Checklist");
        $("#btnEditYes").html("Create");
    }
}

function addUpdateFn() {
    var modalChecklistName = $modalChecklistName.val();
    var modalChecklistType = $modalChecklistType.find('option:selected').val();

    validate(function(isSuccess) {
        if(isSuccess === false) {
            return false;
        } else {
            $AddEditModal.modal('hide');
            var mode = $AddEditModal.data('mode');

            if(mode == 'add') {
                $.ajax({
                    url: getBaseURL() + 'project/landbank/addchecklistmaster',
                    type: 'POST',
                    data: $('#addEditForm').serialize(),
                    success:function(data, textStatus, jqXHR){
                        console.log(data);
                        if (jqXHR.status == 200){
                            var dataParse = JSON.parse(data);
                            $('#TenderAssignChecklist').append("<option value='"+dataParse.TypeId+"' selected>"+dataParse.CheckListName+"</option>").selectpicker('refresh');
                            $('#TenderAssignChecklist').triggerHandler('change');
                        } else {
                            alert('Failed to Add Checklist!');
                        }
                    },
                    error:function(jqXHR, textStatus, errorThrown){
                        alert('Failed to Add Checklist!');
                    }
                });return false;
            }
            $modalChecklistName.val('');
            $("#modalChecklistType").find('option:first-child').prop('selected');
        }
    });


    function validate(callback) {
        if(modalChecklistName.length == 0) {
            showError($modalChecklistName, 'Required!');
            return;
        } else {
            removeError($modalChecklistName);
        }

        if(typeof modalChecklistType == 'undefined' || modalChecklistType.length == 0) {
            showError($modalChecklistType, 'Required!');
            return;
        } else {
            removeError($modalChecklistType);
        }


        //validate Checklist name already found
        $.ajax({
            url:getBaseURL()+ 'project/landbank/findchecklist',
            type:"post",
            data: $('#addEditForm').serialize(),
            async: false,
            success:function(data, textStatus, jqXHR){
                if(jqXHR.status == 200){
                    showError($modalChecklistName, 'Checklist Name already found!');
                    callback(false);
                    return false;
                } else{
                    removeError($modalChecklistName);
                    callback(true);
                }
            },
            error:function(jqXHR, textStatus, errorThrown){
                callback(false);
                return false;
            }
        });
    }
}

</script>

