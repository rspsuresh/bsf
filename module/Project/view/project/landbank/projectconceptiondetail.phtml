<link rel="stylesheet" href="<?php echo $this->basePath() . '/css/project.css';?>"/>
<?php echo $this->headScript()
    ->appendFile($this->basePath() . '/library/amcharts/amcharts.js')
    ->appendFile($this->basePath() . '/library/amcharts/serial.js')
    ->appendFile($this->basePath() . '/library/amcharts/themes/light.js');
?>
<style>
.details-2 			{display:none;}
.step_by li 		{width:25%;}
.step_by_sep + p 	{font-size:13px !important;color:#6279aa !important;}
.stepsep_active + p {color:#244996 !important;font-size:16px !important;}
.sliderfull 		{box-shadow:none;}
@media (max-width: 768px) 
{
.bck_but + div 		{margin-top:25px;}
.stepli_p1, .stepli_p2, .stepli_p3, .stepli_p4 {display:none;}
}
.show-slider-con, i.fa-chevron-up {transition: all 0.5s ease;-webkit-transition: all 0.5s ease;	-moz-transition: all 0.5s ease;	-o-transition: all 0.5s ease;}
</style>
<div class="content_wrapper padlr0">
  <div class="container-fluid">
    <div class="row">
      <form  id="formWrapper"  method="post" enctype="multipart/form-data">
        <input type="hidden" name="enquiryId" id="enquiryId" value="<?php echo (isset($enquiryId)) ? $enquiryId  : 0; ?>"/>
        <input type="hidden" name="feasibilityId" id="feasibilityId" value="<?php echo (isset($feasibilityId)) ? $feasibilityId  : 0; ?>"/>
        <input type="hidden" name="conceptionId" id="conceptionId" value="<?php echo (isset($conceptionId)) ? $conceptionId  : 0; ?>"/>
        <input type="hidden" name="mode" id="mode" value="<?php echo (isset($mode)) ? $mode  : 'add'; ?>"/>
        <input type="hidden" id="pageUrl" name="pageUrl" value="<?php if ($page != '') { echo $page; } else { echo ''; } ?>" />
        <div class="col-lg-12">
          <h1>Project Conception <?php echo $svNo;?></h1>
        </div>
        <div class="col-lg-12 top_ct" >
          <div class="col-lg-4 col-lg-offset-0 col-md-4 col-md-offset-0 col-sm-4 col-sm-offset-0 form-group"> <span class="date_icon"> <i class="fa fa-calendar"></i></span>
            <input type="text" name="RefDate" id="RefDate" class="form-control date_picker lbl_move" label="Reference Date"  value="<?php if ($conceptionId !=0) { echo date("d-m-Y", strtotime($feasibility['RefDate'])) ;} else { echo date("d-m-Y"); }?>"/>
          </div>
          <div class="col-lg-4 col-lg-offset-0 col-md-4 col-md-offset-0 col-sm-4 col-sm-offset-0 form-group">
            <input type="text" name="RefNo" id="RefNo" class="form-control lbl_move" <?php echo ($genType==true) ? 'readonly' : ''; ?>  label="Reference No"  value="<?php if ($conceptionId !=0) { echo $feasibility['RefNo'];} else { echo $svNo; } ?>" />
          </div>
          <div class="col-lg-4 col-lg-offset-0 col-md-4 col-md-offset-0 col-sm-4 col-sm-offset-0 form-group">
            <input type="text" class="form-control lbl_move" label="Name of Property" id="lblPropertyName" value="<?php echo isset($feasibility['PropertyName']) ? $feasibility['PropertyName'] :0;?>" readonly/>
          </div>
          <div class="clear"></div>
          <div class="col-lg-4 col-lg-offset-0 col-md-4 col-md-offset-0 col-sm-4 col-sm-offset-0 form-group">
            <input type="text" class="form-control lbl_move" label="Option Name" name="OptionName" value="<?php echo $feasibility['OptionName']; ?>" <?php if(isset($feasibility['OptionName'])){?>readonly <?php }?> />
          </div>
          <div class="col-lg-4 col-lg-offset-0 col-md-4 col-md-offset-0 col-sm-4 col-sm-offset-0 form-group">
            <input type="text" class="form-control lbl_move" label="Presented by" value="<?php echo $feasibility['PresentedBy']; ?>" readonly/>
          </div>
        </div>
        <!--accordion start-->
        <div class="col-lg-12 clear details-1">
          <?php if(!empty($imagelist)) { ?>
          <div class="sliderfull">
            <div id="carousel-example" class="carousel slide" data-ride="carousel">
              <div class="carousel-inner">
                <?php $imagecount=1; foreach($imagelist as $ilist) { ?>
                <div class="item <?php if ($imagecount==1) echo active; ?>">
                  <div class="imgsslider" style="background-image:url('<?php echo $this->basePath(). $ilist["URL"] ?>'); height:400px;"></div>
                </div>
                <?php $imagecount = $imagecount+1; } ?>
              </div>
              <a class="left carousel-control" href="#carousel-example" data-slide="prev"> <span class="glyphicon glyphicon-chevron-left"></span></a> <a class="right carousel-control" href="#carousel-example" data-slide="next"> <span class="glyphicon glyphicon-chevron-right"></span></a> </div>
            <span id="btn-show-hide-content" class="show-slider-con open"><i class="fa fa-chevron-up tform"></i></span>
            <div class="slider-con clear active" id="slide-content">
              <div class="col-lg-3 col-lg-offset-0 col-md-3 col-md-offset-0 col-sm-3 col-sm-offset-0">
                <label class="slider-la">Project Type</label>
                <input type="text" id="ProjectType"  class="form-control lbl_move btm-labl" name="ProjectType" value="<?php echo isset($feasibility['ProjectTypeName']) ? $feasibility['ProjectTypeName'] : '';?>"/>
                <input type="hidden" id="ProjectTypeId" name="ProjectTypeId" value="<?php echo isset($feasibility['ProjectTypeId']) ? $feasibility['ProjectTypeId'] :0 ; ?>"/>
              </div>
              <div class="col-lg-3 col-lg-offset-0 col-md-3 col-md-offset-0 col-sm-3 col-sm-offset-0">
                <label class="slider-la">No of Blocks</label>
                <input type="text"  class="form-control lbl_move btm-labl" name="NoOfBlocks" value="<?php echo $feasibility['NoOfBlocks']; ?>" onblur="return FormatNum(this, 0)" onkeypress="return isNumberKey(event,this)" maxlength="12"/>
              </div>
              <div class="col-lg-3 col-lg-offset-0 col-md-3 col-md-offset-0 col-sm-3 col-sm-offset-0">
                <label class="slider-la">No of Floors</label>
                <input type="text"  class="form-control lbl_move btm-labl" name="NoOfFloors" value="<?php echo $feasibility['NoOfFloors']; ?>" onblur="return FormatNum(this, 0)" onkeypress="return isNumberKey(event,this)" maxlength="12"/>
              </div>
              <div class="col-lg-3 col-lg-offset-0 col-md-3 col-md-offset-0 col-sm-3 col-sm-offset-0">
                <label class="slider-la">No of Flats</label>
                <input type="text"  class="form-control lbl_move btm-labl" name="NoOfFlats" value="<?php echo $feasibility['NoOfFlats']; ?>" onblur="return FormatNum(this, 0)" onkeypress="return isNumberKey(event,this)" maxlength="12"/>
              </div>
              <div class="col-lg-3 col-lg-offset-0 col-md-3 col-md-offset-0 col-sm-3 col-sm-offset-0">
                <label class="slider-la">Common Area</label>
                <div class="form-group">
                  <input type="text"  class="form-control lbl_move btm-labl" id="CommonArea" name="CommonArea" value="<?php echo $feasibility['CommonArea']; ?>"/>
                </div>
              </div>
              <div class="col-lg-3 col-lg-offset-0 col-md-3 col-md-offset-0 col-sm-3 col-sm-offset-0">
                <label class="slider-la">&nbsp;</label>
                <select name="CommonAreaUnitId" class="form-control single_dropdown lbl_move" style="width:100%;">
                  <?php if(isset($unittypes) && isset($feasibility)):
                                           foreach($unittypes as $list): ?>
                  <option value="<?php echo $list['UnitId'];?>" <?php echo ($list['UnitId'] == $feasibility['CommonAreaUnitId']) ? 'selected' : '';?>><?php echo $list['UnitName']; ?></option>
                  <?php endforeach;
                                       endif;?>
                </select>
              </div>
              <div class="col-lg-3 col-lg-offset-0 col-md-3 col-md-offset-0 col-sm-3 col-sm-offset-0">
                <label class="slider-la">Saleable Area</label>
                <div class="form-group">
                  <input type="text" class="input-group-txt form-control lbl_move btm-labl" name="PropSaleableArea" onblur="return FormatNum(this, 2)" onkeypress="return isDecimal(event,this)" maxlength="18" value="<?php echo $feasibility['SaleableArea']; ?>"/>
                </div>
              </div>
              <div class="col-lg-3 col-lg-offset-0 col-md-3 col-md-offset-0 col-sm-3 col-sm-offset-0">
                <label class="slider-la">&nbsp;</label>
                <select name="PropSaleableAreaUnitId" class="form-control single_dropdown lbl_move" style="width:100%;">
                  <?php if(isset($unittypes) && isset($feasibility)):
                                            foreach($unittypes as $list): ?>
                  <option value="<?php echo $list['UnitId'];?>" <?php echo ($list['UnitId'] == $feasibility['SaleableAreaUnitId']) ? 'selected' : '';?>><?php echo $list['UnitName']; ?></option>
                  <?php endforeach;
                                        endif;?>
                </select>
              </div>
            </div>
          </div>
          <?php } ?>
        </div>
        <!-- Step Two -->
        <div class="col-lg-12 clear details-2">
          <div class="col-lg-12 col-lg-offset-0 col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0">
            <div class="col-lg-12">
              <div class="row">
                <div class="step_by_liner animated slideInDown"></div>
                <ul class="step_by stepby_mb60">
                  <li>
                    <div class="step_by_sep stepsep_active animated slideInRight" id="tag-step-1">
                      <p>1</p>
                    </div>
                    <p class="stepli_p1">Specification & Amenities</p>
                  </li>
                  <li>
                    <div class="step_by_sep animated slideInRight" id="tag-step-2">
                      <p>2</p>
                    </div>
                    <p class="stepli_p2">Drawings & Consultants</p>
                  </li>
                  <!--                  <li>--> 
                  <!--                    <div class="step_by_sep animated slideInRight" id="tag-step-3">--> 
                  <!--                      <p>3</p>--> 
                  <!--                    </div>--> 
                  <!--                    <p class="stepli_p3">Land Summary</p>--> 
                  <!--                  </li>-->
                  <li>
                    <div class="step_by_sep animated slideInRight" id="tag-step-3">
                      <p>3</p>
                    </div>
                    <p class="stepli_p3">Proposal Cost</p>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="col-lg-12 col-lg-offset-0 col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0 cnt_sliders">
            <div id="carousel-example-generic" class="carousel slide" data-ride="carousel"> 
              <!-- Wrapper for slides -->
              <div class="carousel-inner" role="listbox"> 
                <!--step 1-->
                <div class="item active">
                  <div class="list-div">
                    <div class="col-lg-6 col-lg-offset-0 col-md-6 col-md-offset-0 col-sm-6 col-sm-offset-0 form-group">
                      <h2 class="sp-tl" style="padding-left:9px;">Special Features</h2>
                      <div class="table-responsive topsp" style="border:none !important;">
                        <table class="table" style="box-shadow:none;">
                          <tbody>
                            <?php $i=1; if(isset($featurelist)) {
                                foreach($featurelist as $trans) { ?>
                            <tr>
                              <td width="10%" style="border-top:none !important;border-bottom:none !important;"><input class="parent_text" type="text" id="splfeature_<?php echo $i; ?>" name="splfeature_<?php echo $i; ?>" value="<?php echo isset($trans['FeatureName']) ? $trans['FeatureName'] :''; ?>" onchange="addSplfeatureRow(this)"/></td>
                              <td width="1%" class="action_btns_td" style="border-top:none !important;"><ul class="action_btns">
                                  <li> <a class="splfeatureDelete_<?php echo $i; ?>" href="#" onclick="deleteSplfeature(this, event);" style="display: none;"> <span data-toggle="tooltip" data-placement="left" data-original-title="Delete"> <i class="fa fa-trash-o"></i></span></a> </li>
                                </ul></td>
                            </tr>
                            <?php $i=$i+1;}} ?>
                            <tr>
                              <td width="10%" style="border-top:none !important;border-bottom:none !important;"><input class="parent_text" type="text" id="splfeature_<?php echo $i; ?>" name="splfeature_<?php echo $i; ?>" value="" onchange="addSplfeatureRow(this)"/></td>
                              <td width="1%" class="action_btns_td" style="border-top:none !important;border-bottom:none !important;"><ul class="action_btns">
                                  <li> <a class="splfeatureDelete_<?php echo $i; ?>" href="#" onclick="deleteSplfeature(this, event);" style="display: none;"> <span data-toggle="tooltip" data-placement="left" data-original-title="Delete"> <i class="fa fa-trash-o"></i></span></a> </li>
                                </ul></td>
                            </tr>
                          </tbody>
                        </table>
                        <input type="hidden" name="splfeaturerowid" id="splfeaturerowid" value="<?php echo $i; ?>"/>
                      </div>
                    </div>
                    <div class="col-lg-6 col-lg-offset-0 col-md-6 col-md-offset-0 col-sm-6 col-sm-offset-0 form-group">
                      <h2 class="sp-tl" style="padding-left:9px;">Amenities</h2>
                      <div class="table-responsive topsp" style="border:none !important;">
                        <table class="table" style="box-shadow:none;">
                          <tbody>
                            <?php $i=1; if(isset($amenitylist)) {
                                foreach($amenitylist as $trans) { ?>
                            <tr>
                              <td width="10%" style="border-top:none !important;border-bottom:none !important;"><input class="parent_text" type="text" id="amenities_<?php echo $i; ?>" name="amenities_<?php echo $i; ?>" value="<?php echo isset($trans['AmenityName']) ? $trans['AmenityName'] :''; ?>" onchange="addAmenitiesRow(this)"/></td>
                              <td width="1%" class="action_btns_td" style="border-top:none !important;border-bottom:none !important;"><ul class="action_btns">
                                  <li> <a class="amenitiesDelete_<?php echo $i; ?>" href="#" onclick="deleteAmenities(this, event);" style="display: none;"> <span data-toggle="tooltip" data-placement="left" data-original-title="Delete"> <i class="fa fa-trash-o"></i></span></a> </li>
                                </ul></td>
                            </tr>
                            <?php $i=$i+1;}} ?>
                            <tr>
                              <td width="10%" style="border-top:none !important;"><input class="parent_text" type="text" id="amenities_<?php echo $i; ?>" name="amenities_<?php echo $i; ?>" value="" onchange="addAmenitiesRow(this)"/></td>
                              <td width="1%" class="action_btns_td" style="border-top:none !important;"><ul class="action_btns">
                                  <li> <a class="amenitiesDelete_<?php echo $i; ?>" href="#" onclick="deleteAmenities(this, event);" style="display: none;"> <span data-toggle="tooltip" data-placement="left" data-original-title="Delete"> <i class="fa fa-trash-o"></i></span></a> </li>
                                </ul></td>
                            </tr>
                          </tbody>
                        </table>
                        <input type="hidden" name="amenitiesrowid" id="amenitiesrowid" value="<?php echo $i; ?>"/>
                      </div>
                    </div>
                  </div>
                  <div class="cont_bt-list">
                    <ul>
                      <li><a href="javascript:showDetails(1);" class="steps_btn"><i class="fa fa-chevron-circle-left"></i> Back</a></li>
                      <li><a href="#carousel-example-generic" data-slide="next" class="cbtn steps_btn" data-stepno="2">Continue <i class="fa fa-chevron-circle-right"></i></a></li>
                    </ul>
                  </div>
                </div>
                <!--step 1--> 
                <!--step 2-->
                <div class="item">
                  <div class="col-lg-12 clear">
                    <div class="col-lg-12" style="padding-left:0px !important;">
                      <div class="drawing">
                        <h2 class="sp-tl">Drawings</h2>
                        <div class="table-responsive topsp">
                          <table class="table" style=" margin-bottom:0px;">
                            <thead>
                              <tr>
                                <th width="15%">Name</th>
                                <th width="15%">Description</th>
                                <th width="3%">&nbsp;</th>
                              </tr>
                            </thead>
                            <tbody>
                              <?php $i=1; if(isset($drawinglist)):
                                foreach($drawinglist as $dtrans): ?>
                              <tr>
                                <td width="15%"><input class="parent_text" type="text" name="drawType_<?php echo $i; ?>" id="drawType_<?php echo $i; ?>"  value="<?php echo $dtrans['Title'];?>" maxlength="155" onchange="addDrawingRow(this)"/></td>
                                <td width="15%"><textarea class="parent_texts" name="drawDesc_<?php echo $i; ?>" id="drawDesc_<?php echo $i; ?>"><?php echo $dtrans['Description'];?></textarea></td>
                                <td width="5%" class="action_btns_td"><ul class="action_btns">
                                    <li style="float:left;"> <a class="pull-left" id="drawAttachment_<?php echo $i; ?>" href="<?php echo (trim($dtrans['URL']) == '')?'#': $this->basePath(). $dtrans['URL'];?>" <?php if(trim($dtrans['URL']) != ''): ?> target="_blank" download="" <?php endif; ?>>
                                      <?php if(trim($dtrans['URL']) == ''): ?>
                                      <span data-toggle="tooltip" data-placement="left" data-original-title="Click to attach documents" class="btn-file butclr_imp"> <i class="fa fa-paperclip dcm_atch"></i>
                                      <input type="file" name="drawFile_<?php echo $i; ?>" id="drawFile_<?php echo $i; ?>">
                                      </span>
                                      <?php else: ?>
                                      <i class="fa fa-file-o file-do" data-toggle="tooltip" data-placement="left" data-original-title="Download Attachment"></i>
                                      <input type="hidden" name="drawFile_<?php echo $i; ?>" id="drawFile_<?php echo $i; ?>" value="<?php echo $dtrans['URL'];?>">
                                      <?php endif; ?>
                                      </a>
                                      <?php if(trim($dtrans['URL']) != ''): ?>
                                      <i class="fa fa-chain-broken brkn" onclick="removeAttachment($(this));"></i>
                                      <?php endif; ?>
                                    </li>
                                    <li class=""> <a href="#" class="drawDelete_<?php echo $i; ?>" onclick="deleteDrawing(this, event);"><span data-toggle="tooltip" data-placement="left" data-original-title="Document Delete"><i class="fa fa-trash-o"></i></span></a> </li>
                                  </ul></td>
                              </tr>
                              <?php $i=$i+1; endforeach;?>
                              <?php endif; ?>
                              <tr>
                                <td width="15%"><input class="parent_text" type="text" name="drawType_<?php echo $i; ?>" id="drawType_<?php echo $i; ?>" maxlength="155" onchange="addDrawingRow(this)"/></td>
                                <td width="15%"><textarea class="parent_texts" name="drawDesc_<?php echo $i; ?>" id="drawDesc_<?php echo $i; ?>"></textarea></td>
                                <td width="5%" class="action_btns_td"><ul class="action_btns">
                                    <li style="float:left;" class="lft-doc"> <a id="drawAttachment_<?php echo $i; ?>" href="#"><span data-toggle="tooltip" data-placement="left" data-original-title="Click to attach documents" class="btn-file butclr_imp"> <i class="fa fa-paperclip dcm_atch"></i>
                                      <input type="file" name="drawFile_<?php echo $i; ?>" id="drawFile_<?php echo $i; ?>">
                                      </span></a> </li>
                                    <li style="float:left;"> <a href="#" class="drawDelete_<?php echo $i; ?>" onclick="deleteDrawing(this, event);" style="display: none;"><span data-toggle="tooltip" data-placement="left" data-original-title="Document Delete"><i class="fa fa-trash-o"></i></span></a> </li>
                                  </ul></td>
                              </tr>
                            </tbody>
                          </table>
                          <input type="hidden" name="drawingrowid" id="drawingrowid" value="<?php echo $i; ?>"/>
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-12 clear" style="padding-left:0px !important;">
                      <div class="drawings">
                        <h2 class="sp-tl">Documents</h2>
                        <div class="table-responsive topsp">
                          <table class="table" style=" margin-bottom:0px;">
                            <thead>
                              <tr>
                                <th width="15%">Type</th>
                                <th width="15%">Description</th>
                                <th width="4%">&nbsp;</th>
                              </tr>
                            </thead>
                            <tbody>
                              <?php $i=1; if(isset($documentlist)):
                                foreach($documentlist as $dtrans): ?>
                              <tr>
                                <td width="15%"><input class="parent_text" type="text" name="docType_<?php echo $i; ?>" id="docType_<?php echo $i; ?>"  value="<?php echo $dtrans['Type'];?>" maxlength="155" onchange="addDocumentRow(this)"/></td>
                                <td width="15%"><textarea class="parent_texts" name="docDesc_<?php echo $i; ?>" id="docDesc_<?php echo $i; ?>"><?php echo $dtrans['Description'];?></textarea></td>
                                <td width="5%" class="action_btns_td"><ul class="action_btns">
                                    <li style="float:left;"> <a class="pull-left" id="docAttachment_<?php echo $i; ?>" href="<?php echo (trim($dtrans['URL']) == '')?'#': $this->basePath(). $dtrans['URL'];?>" <?php if(trim($dtrans['URL']) != ''): ?> target="_blank" download <?php endif; ?>>
                                      <?php if(trim($dtrans['URL']) == ''): ?>
                                      <span data-toggle="tooltip" data-placement="left" data-original-title="Click to attach documents" class="btn-file butclr_imp"> <i class="fa fa-paperclip dcm_atch"></i>
                                      <input type="file" name="docFile_<?php echo $i; ?>" id="docFile_<?php echo $i; ?>">
                                      </span>
                                      <?php else: ?>
                                      <i class="fa fa-file-o file-do" data-toggle="tooltip" data-placement="left" data-original-title="Download Attachment"></i>
                                      <input type="hidden" name="docFile_<?php echo $i; ?>" id="docFile_<?php echo $i; ?>" value="<?php echo $dtrans['URL'];?>">
                                      <?php endif; ?>
                                      </a>
                                      <?php if(trim($dtrans['URL']) != ''): ?>
                                      <i class="fa fa-chain-broken brkn" onclick="removeAttachment($(this));"></i>
                                      <?php endif; ?>
                                    </li>
                                    <li class=""> <a href="#" class="docDelete_<?php echo $i; ?>" onclick="deleteDocument(this, event);"><span data-toggle="tooltip" data-placement="left" data-original-title="Document Delete"><i class="fa fa-trash-o"></i></span></a> </li>
                                  </ul></td>
                              </tr>
                              <?php $i=$i+1; endforeach;?>
                              <?php endif; ?>
                              <tr>
                                <td width="15%"><input class="parent_text" type="text" name="docType_<?php echo $i; ?>" id="docType_<?php echo $i; ?>" maxlength="155" onchange="addDocumentRow(this)"/></td>
                                <td width="15%"><textarea class="parent_texts" name="docDesc_<?php echo $i; ?>" id="docDesc_<?php echo $i; ?>"></textarea></td>
                                <td width="5%" class="action_btns_td"><ul class="action_btns">
                                    <li style="float:left;" class="lft-doc"> <a id="docAttachment_<?php echo $i; ?>" href="#"><span data-toggle="tooltip" data-placement="left" data-original-title="Click to attach documents" class="btn-file butclr_imp"> <i class="fa fa-paperclip dcm_atch"></i>
                                      <input type="file" name="docFile_<?php echo $i; ?>" id="docFile_<?php echo $i; ?>">
                                      </span></a> </li>
                                    <li style="float:left;"> <a href="#" class="docDelete_<?php echo $i; ?>" onclick="deleteDocument(this, event);" style="display: none;"><span data-toggle="tooltip" data-placement="left" data-original-title="Document Delete"><i class="fa fa-trash-o"></i></span></a> </li>
                                  </ul></td>
                              </tr>
                            </tbody>
                          </table>
                          <input type="hidden" name="documentrowid" id="documentrowid" value="<?php echo $i; ?>"/>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-lg-12 clear">
                    <div class="drawings-full">
                      <h2 class="sp-tl">Consultants</h2>
                      <div class="table-responsive topsp" style="margin-top:10px; float:left;">
                        <table class="table" style=" margin-bottom:0px;">
                          <thead>
                            <tr>
                              <th>Consultant Name</th>
                              <th>Consultant Type</th>
                              <th>Fees %</th>
                              <th>Fees Amount</th>
                              <th>&nbsp;</th>
                            </tr>
                          </thead>
                          <tbody>
                            <?php $i=0; if(isset($consultantlist) && count($consultantlist) !=0) {
                            foreach($consultantlist as $trans) { $i++; ?>
                            <tr>
                              <td width="10%"><input type="text" class="parent_text" name="consultantname_<?php echo $i; ?>" id="consultantname_<?php echo $i; ?>"  value="<?php echo $trans['Name'];?>" onchange="addConsultantRow(this)"/></td>
                              <td width="10%"><input type="text" class="parent_text" name="consultanttype_<?php echo $i; ?>" id="consultanttype_<?php echo $i; ?>" value="<?php echo $trans['Type'];?>" onchange="addConsultantRow(this)"/></td>
                              <td width="5%"><input type="text" class="parent_text text-right" name="fees_<?php echo $i; ?>" id="fees_<?php echo $i; ?>" value="<?php echo $this->commonHelper()->sanitizeNumber($trans['Fee'],2);?>" onblur="return FormatNum(this, 2)" onkeypress="return isDecimal(event,this)" maxlength="18" onchange="return isPercentage(this)" /></td>
                              <td width="5%"><input type="text" class="parent_text text-right" name="feesamount_<?php echo $i; ?>" id="feesamount_<?php echo $i; ?>" value="<?php echo $this->commonHelper()->sanitizeNumber($trans['FeeAmount'],2,true);?>" onblur="return FormatNum(this, 2)" onkeypress="return isDecimal(event,this)" maxlength="18" onchange="addConsultantRow(this)"/></td>
                              <td width="3%" class="action_btns_td"><ul class="action_btns">
                                  <li style="float:left;"> <a href="#" class="consultDelete_<?php echo $i; ?>" onclick="deleteConsultant(this, event);" style=""> <span data-toggle="tooltip" data-placement="left" data-original-title="Document Delete"><i class="fa fa-trash-o"></i></span> </a> </li>
                                </ul></td>
                            </tr>
                            <?php }} else { $i=1;?>
                            <tr>
                              <td width="10%"><input type="text" class="parent_text" id="consultantname_1" name="consultantname_1" onchange="addConsultantRow(this)"></td>
                              <td width="10%"><input type="text" class="parent_text" id="consultanttype_1" name="consultanttype_1" onchange="addConsultantRow(this)"></td>
                              <td width="5%"><input type="text" class="parent_text text-right" id="fees_1" name="fees_1" onchange="return isPercentage(this)" onblur="return FormatNum(this, 2)" onkeypress="return isDecimal(event,this)" maxlength="18" onchange="addConsultantRow(this)"></td>
                              <td width="5%"><input type="text" class="parent_text text-right" id="feesamount_1" name="feesamount_1" onblur="return FormatNum(this, 2)" onkeypress="return isDecimal(event,this)" maxlength="18" onchange="addConsultantRow(this)"></td>
                              <td width="3%" class="action_btns_td"><ul class="action_btns">
                                  <li style="float:left;"> <a href="#" class="consultDelete_<?php echo $i; ?>" onclick="deleteConsultant(this, event);" style=""> <span data-toggle="tooltip" data-placement="left" data-original-title="Document Delete"><i class="fa fa-trash-o"></i></span> </a> </li>
                                </ul></td>
                            </tr>
                            <?php } ?>
                          </tbody>
                        </table>
                        <input type="hidden" name="consultantrowid" id="consultantrowid" value="<?php echo $i; ?>"/>
                      </div>
                    </div>
                    <div class="cont_bt-list">
                      <ul>
                        <li><a href="#carousel-example-generic" data-slide="prev" class="steps_btn" data-stepno="1"><i class="fa fa-chevron-circle-left"></i> Back</a></li>
                        <li><a href="#carousel-example-generic" data-slide="next" class="cbtn steps_btn" data-stepno="3">Continue <i class="fa fa-chevron-circle-right"></i></a></li>
                      </ul>
                    </div>
                  </div>
                </div>
                <!--step 2--> 
                <!--step 3-->
                <div class="item">
                  <div class="col-lg-12 col-lg-offset-0 col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0">
                    <div class="col-lg-6">
                      <h2 class="sp-tl">Expected Income</h2>
                      <div class="table-responsive topsp">
                        <table class="table" style="box-shadow:none;">
                          <thead>
                            <tr>
                              <th>Particular</th>
                              <th class="text-right">Amount</th>
                              <th>&nbsp;</th>
                            </tr>
                          </thead>
                          <tbody>
                            <?php $i=1; $totaIncome=0; if(isset($incomelist)) {
                            foreach($incomelist as $trans){ ?>
                            <tr>
                              <td width="10%"><input class="parent_text" type="text" name="incomeparticular_<?php echo $i; ?>" id="incomeparticular_<?php echo $i; ?>"  value="<?php echo isset($trans['Particular']) ? $trans['Particular'] : ''; ?>" onchange="addExIncomeRow(this)"/></td>
                              <td width="8%"><input class="parent_text text-right" type="text" name="incomeamount_<?php echo $i; ?>" id="incomeamount_<?php echo $i; ?>" value="<?php echo isset($trans['Amount']) ? $this->commonHelper()->sanitizeNumber($trans['Amount'],2,true) : $this->commonHelper()->sanitizeNumber(0,2,true); ?>" onblur="return FormatNum(this, 2,true)" onkeypress="return isDecimal(event,this)" maxlength="18" onchange="addExIncomeRow(this)"/></td>
                              <td width="1%"><ul class="action_btns">
                                  <li style="float:left;"> <a href="#" class="incomeDelete_<?php echo $i; ?>" onclick="deleteExIncomeRow(this, event);" style="display: none;"> <span data-toggle="tooltip" data-placement="left" data-original-title="Delete"><i class="fa fa-trash-o"></i></span> </a> </li>
                                </ul></td>
                            </tr>
                            <?php $i=$i+1; $totaIncome = $totaIncome + floatval($trans['Amount']); }}?>
                            <tr>
                              <td width="10%"><input class="parent_text" type="text" name="incomeparticular_<?php echo $i; ?>" id="incomeparticular_<?php echo $i; ?>" onchange="addExIncomeRow(this)"/></td>
                              <td width="8%"><input class="parent_text text-right" type="text" name="incomeamount_<?php echo $i; ?>" id="incomeamount_<?php echo $i; ?>" onblur="return FormatNum(this, 2,true)" onkeypress="return isDecimal(event,this)" maxlength="18" onchange="addExIncomeRow(this)"/></td>
                              <td width="1%"><ul class="action_btns">
                                  <li style="float:left;"> <a href="#" class="incomeDelete_<?php echo $i; ?>" onclick="deletePCostRow(this, event);" style="display: none;"> <span data-toggle="tooltip" data-placement="left" data-original-title="Delete"><i class="fa fa-trash-o"></i></span> </a> </li>
                                </ul></td>
                            </tr>
                            <tr class="total">
                              <td width="10%" align="right" class="rate_pri">Total Expected Income</td>
                              <td width="8%"><input class="parent_text text-right total-clr" type="text" id="totalExpectedIncome" value ="<?php echo $this->commonHelper()->sanitizeNumber($totaIncome,2,true); ?>" readonly/></td>
                              <td></td>
                            </tr>
                          </tbody>
                        </table>
                        <input type="hidden" name="incomerowid" id="incomerowid" value="<?php echo $i; ?>"/>
                      </div>
                    </div>
                    <div class="col-lg-6">
                      <h2 class="sp-tl">Proposal Cost</h2>
                      <div class="table-responsive topsp">
                        <table class="table" style="box-shadow:none;">
                          <thead>
                            <tr>
                              <th>Particular</th>
                              <th class="text-right">Amount</th>
                              <th>&nbsp;</th>
                            </tr>
                          </thead>
                          <tbody>
                            <?php $i=1; $totaExpense=0; if(isset($expenselist)) {
                            foreach($expenselist as $trans){ ?>
                            <tr>
                              <td width="10%"><input class="parent_text" type="text" name="exparticular_<?php echo $i; ?>" id="exparticular_<?php echo $i; ?>" value="<?php echo isset($trans['Particular']) ? $trans['Particular'] : ''; ?>" onchange="addPCostRow(this)"/></td>
                              <td width="8%"><input class="parent_text text-right " type="text" name="examount_<?php echo $i; ?>" id="examount_<?php echo $i; ?>" value="<?php echo isset($trans['Amount']) ? $this->commonHelper()->sanitizeNumber($trans['Amount'],2,true) : $this->commonHelper()->sanitizeNumber(0,2,true); ?>"  onblur="return FormatNum(this, 2,true)" onkeypress="return isDecimal(event,this)" maxlength="18" onchange="addPCostRow(this)"/></td>
                              <td width="1%"><ul class="action_btns">
                                  <li style="float:left;"> <a href="#" class="exDelete_<?php echo $i; ?>" onclick="deletePCostRow(this, event);" style="display: none;"> <span data-toggle="tooltip" data-placement="left" data-original-title="Delete"><i class="fa fa-trash-o"></i></span> </a> </li>
                                </ul></td>
                            </tr>
                            <?php $i=$i+1; $totaExpense = $totaExpense + floatval($trans['Amount']); }} $totalProfit = floatval($totaIncome)-floatval($totaExpense);?>
                            <tr>
                              <td width="10%"><input class="parent_text" type="text" name="exparticular_<?php echo $i; ?>" id="exparticular_<?php echo $i; ?>" onchange="addPCostRow(this)"/></td>
                              <td width="8%"><input class="parent_text text-right " type="text" name="examount_<?php echo $i; ?>" id="examount_<?php echo $i; ?>" onblur="return FormatNum(this, 2,true)" onkeypress="return isDecimal(event,this)" maxlength="18" onchange="addPCostRow(this)"/></td>
                              <td width="1%"><ul class="action_btns">
                                  <li style="float:left;"> <a href="#" class="exDelete_<?php echo $i; ?>" onclick="deletePCostRow(this, event);" style="display: none;"> <span data-toggle="tooltip" data-placement="left" data-original-title="Delete"><i class="fa fa-trash-o"></i></span> </a> </li>
                                </ul></td>
                            </tr>
                            <tr class="total">
                              <td width="10%" align="right" class="rate_pri">Total Proposal Cost</td>
                              <td width="8%"><input class="parent_text text-right total-clr" type="text" id="totalProposalCost" value ="<?php echo $this->commonHelper()->sanitizeNumber($totaExpense,2,true); ?>" readonly/></td>
                              <td></td>
                            </tr>
                          </tbody>
                        </table>
                        <input type="hidden" name="exrowid" id="exrowid" value="<?php echo $i; ?>"/>
                      </div>
                    </div>
                    
                    <!--                    <div class="chats-lft">--> 
                    <!--                        <h2 class="sp-tl">Ratio Analysis</h2>--> 
                    <!--                        <div class="cht" id="feasibilityRatioChart" style="height:300px;"></div>--> 
                    <!--                    </div>--> 
                  </div>
                  <div class="col-lg-12 col-lg-offset-0 col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0" style="margin-top:10px; margin-bottom:10px;">
                    <div class="col-lg-4 col-lg-offset-4 col-md-6 col-md-offset-0 col-sm-6 col-sm-offset-0" style=" border:1px solid #c2c2c2;">
                      <h2 class="sp-tl">Net Profit</h2>
                      <div class="table-responsive topsp">
                        <table class="table"  style="box-shadow:none; background:#F5F0EA !important; margin-bottom:0px;">
                          <tbody>
                            <tr>
                              <td align="right" class="rate_pri" width="5%" >Total</td>
                              <td style="border-right:none;"><input class="parent_text text-right total-clr" name="netprofit" id="netprofit" type="text" value ="<?php echo $this->commonHelper()->sanitizeNumber($totalProfit,2,true); ?>" readonly/></td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                  <div class="col-lg-12 col-lg-offset-0 col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0">
                    <div class="col-lg-6 col-lg-offset-0 col-md-6 col-md-offset-0 col-sm-6 col-sm-offset-0">
                      <h2 class="sp-tl">Construction Schedule</h2>
                      <div class="table-responsive topsp">
                        <table style=" margin-bottom:0px;" class="table tableWithFloatingHeader">
                          <thead>
                            <tr>
                              <th>Year</th>
                              <th class="text-right">Amount</th>
                              <th>&nbsp;</th>
                            </tr>
                          </thead>
                          <tbody>
                            <?php $i=1; if(isset($shedulelist)) {
                            foreach($shedulelist as $trans){ ?>
                            <tr>
                              <td width="3%"><input type="text" class="parent_text date_picker_year" name="constructionyear_<?php echo $i; ?>" id="constructionyear_<?php echo $i; ?>" value="<?php echo isset($trans['ShYear']) ? $trans['ShYear'] : ''; ?>" onchange="addConstructionRow(this)"></td>
                              <td width="5%"><input type="text" class="parent_text text-right" name="constructionamount_<?php echo $i; ?>" id="constructionamount_<?php echo $i; ?>" value="<?php echo isset($trans['Amount']) ? $this->commonHelper()->sanitizeNumber($trans['Amount'],2,true) : $this->commonHelper()->sanitizeNumber(0,2,true); ?>" onblur="return FormatNum(this, 2,true)" onkeypress="return isDecimal(event,this)" maxlength="18" onchange="updateFundFlowChart()"></td>
                              <td width="3%"><ul class="action_btns">
                                  <li style="float:left;"> <a href="#" class="constructionDelete_<?php echo $i; ?>" onclick="deleteConstructionRow(this, event);" style="display: none;"> <span data-toggle="tooltip" data-placement="left" data-original-title="Delete"><i class="fa fa-trash-o"></i></span> </a> </li>
                                </ul></td>
                            </tr>
                            <?php $i=$i+1;}}?>
                            <tr>
                              <td width="3%"><input type="text" class="parent_text date_picker_year" name="constructionyear_<?php echo $i; ?>" id="constructionyear_<?php echo $i; ?>" onchange="addConstructionRow(this)"></td>
                              <td width="5%"><input type="text" class="parent_text text-right" name="constructionamount_<?php echo $i; ?>" id="constructionamount_<?php echo $i; ?>" onblur="return FormatNum(this, 2,true)" onkeypress="return isDecimal(event,this)" maxlength="18" onchange="updateFundFlowChart()"></td>
                              <td width="3%"><ul class="action_btns">
                                  <li style="float:left;"> <a href="#" class="constructionDelete_<?php echo $i; ?>" onclick="deleteConstructionRow(this, event);" style="display: none;"> <span data-toggle="tooltip" data-placement="left" data-original-title="Delete"><i class="fa fa-trash-o"></i></span> </a> </li>
                                </ul></td>
                            </tr>
                          </tbody>
                        </table>
                        <input type="hidden" name="constructionrowid" id="constructionrowid" value="<?php echo $i; ?>"/>
                      </div>
                    </div>
                    <div class="col-lg-6 col-lg-offset-0 col-md-6 col-md-offset-0 col-sm-6 col-sm-offset-0">
                      <div class="chats-lft">
                        <h2 class="sp-tl">Fund Flow</h2>
                        <div class="col-lg-12 cht" style="height:350px;" id="fundFlowChart"></div>
                      </div>
                    </div>
                  </div>
                  <div class="cont_bt-list">
                    <ul>
                      <li><a href="#carousel-example-generic" data-slide="prev" class="steps_btn" data-stepno="3"><i class="fa fa-chevron-circle-left"></i> Back</a></li>
                      <li><a href="#carousel-example-generic" onclick="submitConception();" class="cbtn">Submit&nbsp;&nbsp;<i class="fa fa-check-circle"></i></a></li>
                    </ul>
                  </div>
                </div>
                <!--step 3--> 
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
<div class="col-lg-12 savebtn_area">
  <ul class="details-1">
    <li class="dropdown save_btn float_r"><a href="javascript:showDetails(2);" data-toggle="tooltip" class="ripple" title="Next">Next</a>
  </ul>
</div>

<!--Dummy Tables-->
<table id="dummy-splfeature" style="display: none;">
  <tbody>
    <tr>
      <td width="10%" style="border-top:none !important;"><input class="parent_text" type="text" id="splfeature__1" name="splfeature__1" onchange="addSplfeatureRow(this)"/></td>
      <td width="1%" class="action_btns_td" style="border-top:none !important;"><ul class="action_btns">
          <li> <a class="splfeatureDelete__1" href="#" onclick="deleteSplfeature(this, event);" style="display: none;"> <span data-toggle="tooltip" data-placement="left" data-original-title="Delete"> <i class="fa fa-trash-o"></i></span> </a> </li>
        </ul></td>
    </tr>
  </tbody>
</table>
<table id="dummy-amenities" style="display: none;">
  <tbody>
    <tr>
      <td width="10%" style="border-top:none !important;"><input class="parent_text" type="text" id="amenities__1" name="amenities__1" onchange="addAmenitiesRow(this)"/></td>
      <td width="1%" class="action_btns_td" style="border-top:none !important;"><ul class="action_btns">
          <li> <a class="amenitiesDelete__1" href="#" onclick="deleteAmenities(this, event);" style="display: none;"> <span data-toggle="tooltip" data-placement="left" data-original-title="Delete"> <i class="fa fa-trash-o"></i></span></a> </li>
        </ul></td>
    </tr>
  </tbody>
</table>
<table id="dummy-drawing" style="display: none;">
  <tbody>
    <tr>
      <td width="15%"><input class="parent_text" type="text" name="drawType__1" id="drawType__1" maxlength="155" onchange="addDrawingRow(this)"/></td>
      <td width="15%"><textarea class="parent_texts" name="drawDesc__1" id="drawDesc__1"></textarea></td>
      <td width="5%" class="action_btns_td"><ul class="action_btns">
          <li style="float:left;" class="lft-doc"> <a id="drawAttachment__1" href="#"><span data-toggle="tooltip" data-placement="left" data-original-title="Click to attach documents" class="btn-file butclr_imp"> <i class="fa fa-paperclip dcm_atch"></i>
            <input type="file" name="drawFile__1" id="drawFile__1">
            </span></a> </li>
          <li style="float:left;"> <a href="#" class="drawDelete_<?php echo $i; ?>" onclick="deleteDrawing(this, event);" style="display: none;"><span data-toggle="tooltip" data-placement="left" data-original-title="Document Delete"><i class="fa fa-trash-o"></i></span></a> </li>
        </ul></td>
    </tr>
  </tbody>
</table>
<table id="dummy-document" style="display: none;">
  <tbody>
    <tr>
      <td width="15%"><input class="parent_text" type="text" name="docType__1" id="docType__1" maxlength="155" onchange="addDocumentRow(this)"/></td>
      <td width="15%"><textarea class="parent_texts" name="docDesc__1" id="docDesc__1"></textarea></td>
      <td width="5%" class="action_btns_td"><ul class="action_btns">
          <li style="float:left;" class="lft-doc"> <a id="docAttachment__1" href="#"><span data-toggle="tooltip" data-placement="left" data-original-title="Click to attach documents" class="btn-file butclr_imp"> <i class="fa fa-paperclip dcm_atch"></i>
            <input type="file" name="docFile__1" id="docFile__1">
            </span></a> </li>
          <li style="float:left;"> <a href="#" class="docDelete_<?php echo $i; ?>" onclick="deleteDocument(this, event);" style="display: none;"><span data-toggle="tooltip" data-placement="left" data-original-title="Document Delete"><i class="fa fa-trash-o"></i></span></a> </li>
        </ul></td>
    </tr>
  </tbody>
</table>
<table id="dummy-consultant" style="display: none;">
  <tbody>
    <tr>
      <td width="10%"><input type="text" class="parent_text" id="consultantname__1" name="consultantname__1" onchange="addConsultantRow(this)"></td>
      <td width="10%"><input type="text" class="parent_text" id="consultanttype__1" name="consultanttype__1" onchange="addConsultantRow(this)"></td>
      <td width="5%"><input type="text" class="parent_text text-right" id="fees__1" name="fees__1" onchange="return isPercentage(this)" onblur="return FormatNum(this, 2)" onkeypress="return isDecimal(event,this)" maxlength="18" onchange="addConsultantRow(this)"></td>
      <td width="5%"><input type="text" class="parent_text text-right" id="feesamount__1" name="feesamount__1" onblur="return FormatNum(this, 2)" onkeypress="return isDecimal(event,this)" maxlength="18" onchange="addConsultantRow(this)"></td>
      <td width="3%" class="action_btns_td"><ul class="action_btns">
          <li style="float:left;"> <a href="#" class="consultDelete__1" onclick="deleteConsultant(this, event);" style=""><span data-toggle="tooltip" data-placement="left" data-original-title="Document Delete"><i class="fa fa-trash-o"></i></span> </a> </li>
        </ul></td>
    </tr>
  </tbody>
</table>
<table id="dummy-income" style="display: none;">
  <tbody>
    <tr>
      <td width="10%"><input class="parent_text" type="text" name="incomeparticular__1" id="incomeparticular__1" onchange="addExIncomeRow(this)"/></td>
      <td width="5%"><input class="parent_text text-right" type="text" name="incomeamount__1" id="incomeamount__1" onblur="return FormatNum(this, 2,true)" onkeypress="return isDecimal(event,this)" maxlength="18" onchange="addExIncomeRow(this)"/></td>
      <td width="3%"><ul class="action_btns">
          <li style="float:left;"> <a href="#" class="incomeDelete__1" onclick="deleteExIncomeRow(this, event);" style="display: none;"> <span data-toggle="tooltip" data-placement="left" data-original-title="Delete"><i class="fa fa-trash-o"></i></span> </a> </li>
        </ul></td>
    </tr>
  </tbody>
</table>
<table id="dummy-expense" style="display: none;">
  <tbody>
    <tr>
      <td width="10%"><input class="parent_text" type="text" name="exparticular__1" id="exparticular__1" onchange="addPCostRow(this)"/></td>
      <td width="5%"><input class="parent_text text-right" type="text" name="examount__1" id="examount__1" onblur="return FormatNum(this, 2,true)" onkeypress="return isDecimal(event,this)" maxlength="18" onchange="addPCostRow(this)"/></td>
      <td width="3%"><ul class="action_btns">
          <li style="float:left;"> <a href="#" class="exDelete__1" onclick="deletePCostRow(this, event);" style="display: none;"> <span data-toggle="tooltip" data-placement="left" data-original-title="Delete"><i class="fa fa-trash-o"></i></span> </a> </li>
        </ul></td>
    </tr>
  </tbody>
</table>
<table id="dummy-construction-schedule" style="display: none;">
  <tbody>
    <tr>
      <td width="3%"><input type="text" class="parent_text date_picker_year" name="constructionyear__1" id="constructionyear__1" onchange="addConstructionRow(this)"></td>
      <td width="5%"><input type="text" class="parent_text text-right" name="constructionamount__1" id="constructionamount__1" onblur="return FormatNum(this, 2,true)" onkeypress="return isDecimal(event,this)" maxlength="18" onchange="updateFundFlowChart()"></td>
      <td width="3%"><ul class="action_btns">
          <li style="float:left;"> <a href="#" class="constructionDelete__1" onclick="deleteConstructionRow(this, event);" style="display: none;"> <span data-toggle="tooltip" data-placement="left" data-original-title="Delete"><i class="fa fa-trash-o"></i></span> </a> </li>
        </ul></td>
    </tr>
  </tbody>
</table>
<table id="dummy-approval" style="display: none;">
  <tbody>
    <tr>
      <td width="10%"><input class="parent_text" type="text" id="approvalauthority__1" name="approvalauthority__1" onchange="addApprovalRow(this)"/></td>
      <td width="10%"><input class="parent_text date_picker" type="text" id="approvaldate__1" name="approvaldate__1" onchange="addApprovalRow(this)"/></td>
      <td width="5%"><input class="parent_text" type="text" id="approvalno__1" name="approvalno__1" onchange="addApprovalRow(this)"/></td>
      <td width="3%"><ul class="action_btns">
          <li style="float:left;"> <a href="#" class="approvalDelete__1" onclick="deleteApprovalRow(this, event);" style="display: none;"> <span data-toggle="tooltip" data-placement="left" data-original-title="Delete"><i class="fa fa-trash-o"></i></span> </a> </li>
        </ul></td>
    </tr>
  </tbody>
</table>
<script type="text/javascript">
    var arr_proposalCostParticulars = <?php echo isset($arr_proposalCostParticulars) ? json_encode($arr_proposalCostParticulars) : 'null';?>;
    var arr_expectedincomeParticulars = <?php echo isset($arr_expectedincomeParticulars) ? json_encode($arr_expectedincomeParticulars) : 'null';?>;
    var arr_projecttypes = <?php echo isset($projecttypes) ? json_encode($projecttypes) : 'null';?>;
    var $projectType = $('#ProjectType'),
        $projectTypeId = $('#ProjectTypeId'),
        $showHideBtn = $('#btn-show-hide-content'),
        $showHideBtnI = $('#btn-show-hide-content > i'),
        $slideContent = $('#slide-content');
    var $steps_wrapper = $('ul.stepby_mb60'),
        $steps = $('.step_by_sep');
        fundFlowChart = null;
        //feasibilityRatioChart = null;
    $(function() {
        $projectType.autocomplete({
            lookup: arr_projecttypes,
            showNoSuggestionNotice: false,
            lookupFilter: function (suggestion, originalQuery, queryLowerCase) {
                if (queryLowerCase == '*') {
                    return suggestion.value;
                } else {
                    var re = new RegExp($.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');
                    return re.test(suggestion.value);
                }
            },
            onSelect: function (suggestion) {
                if (suggestion) {
                    $projectTypeId.val(suggestion.data);
                    $(this).removeClass('error');
                }
            },
            onSearchStart: function (suggestion) {
                $projectTypeId.val(0);
            },
            onSearchComplete: function (query, suggestions) {
                if (!suggestions.length) {
                    $(this).addClass('error');
                    $projectTypeId.val(0);
                } else $(this).removeClass('error');
            }
        });
        $showHideBtn.on('click', function () {
            $slideContent.toggleClass('active');
            $showHideBtn.toggleClass('open');
            $showHideBtnI.toggleClass('tform');
        });

        // slider
        $('.cnt_sliders .carousel').carousel({
            interval: false
        });

        $('.steps_btn').on('click', function(e) {
            $('.step_by_sep').removeClass('stepsep_active');
            var stpno = parseInt($(this).data('stepno'));
            $('#tag-step-' + stpno).addClass('stepsep_active');
            $steps_wrapper.css('left', (33.3 - (stpno - 1) * 25) + '%');
            animateSteps();
        });

        bindPCostAutocomplete(1);
        bindEIncomeAutocomplete(1);
        //updateFeasibilityRatioChart();
        bindDrawAttached();
        bindDocAttached();
        bindDatepicker();
        updateFundFlowChart();

        var consultantrowid = $('#consultantrowid').val();
        $('#consultantname_'+consultantrowid).triggerHandler('change');
    });

    function updateFeasibilityRatioChart() {


        var chartData = [
            {'Year' : 2015, 'Rate': 100}
        ];

        if (feasibilityRatioChart != null) {
            feasibilityRatioChart.dataProvider = chartData;
            feasibilityRatioChart.validateData();
            return;
        }

        feasibilityRatioChart = AmCharts.makeChart("feasibilityRatioChart", {
            "theme": "light",
            "type": "serial",
            "marginRight": 80,
            "autoMarginOffset": 20,
            "marginTop":20,
            "dataProvider": chartData,
            "valueAxes": [{
                "id": "v1",
                "axisAlpha": 0.1
            }],
            "graphs": [{
                "useNegativeColorIfDown": true,
                "balloonText": "[[category]]<br><b>value: [[value]]</b>",
                "bullet": "round",
                "bulletBorderAlpha": 1,
                "bulletBorderColor": "#FFFFFF",
                "hideBulletsCount": 50,
                "lineThickness": 2,
                "lineColor": "#fdd400",
                "negativeLineColor": "#67b7dc",
                "valueField": "Rate"
            }],
            "chartCursor": {
                "valueLineEnabled": true,
                "valueLineBalloonEnabled": true
            },
            "categoryField": "Year",
            "categoryAxis": {
                "axisAlpha": 0,
                "minHorizontalGap": 60
            }
        });
    }

    function animateSteps() {
        $steps.removeClass('slideInRight');
        setTimeout(function(){
            $steps.addClass('slideInRight');
        }, 200);
    }

    function showDetails(id) {
        if (id==2) {
            $('.details-' + 1).hide();
            $('.details-' + 2).fadeIn();
            return;
        }

        $('.details-' + 1).fadeIn();
        $('.details-' + 2).hide();
    }
    function submitConception() {
        var $error = $('.error');
        if($error.length != 0) {
            alert('Kindly notice the error notifications!');
            $error.parents('.collapse:not(.in)').siblings('.panel-heading').trigger('click');
            return false;
        }
        $('#formWrapper').submit();
    }
    function addSplfeatureRow(x) {
        var $x =  $(x),
            $tr = $x.closest('tr'),
            key = $x[0].id.split('_')[1];

        if ($tr.next('tr').length != 0)
            return;

        if ($('#splfeature_' + key).val().length == 0)
            return;

        var $rowid = $('#splfeaturerowid'),
            count = parseInt($rowid.val()) + 1,
            template = $('#dummy-splfeature tbody').html();

        template = template.replace(/__1/g, '_' + count);
        $tr.parent('tbody').append(template);
        $rowid.val(count);
        $('.splfeatureDelete_' + key).show();
    }

    function deleteSplfeature(x,e) {
        e.preventDefault();
        if (!confirm('Do you want to Delete'))
            return false;

        var $tr = $(x).closest('tr'),
            $tbody = $tr.parent('tbody');

        if ($tbody.find('> tr').length == 1) {
            var template = $('#dummy-splfeature tbody').html();
            template = template.replace(/__1/g, '_' + 1);
            $tbody.append(template);
            $('#splfeaturerowid').val(1);
        }

        $tr.next('tr.subTr').remove();
        $tr.remove();
        return false;
    }

    function addAmenitiesRow(x) {
        var $x =  $(x),
            $tr = $x.closest('tr'),
            key = $x[0].id.split('_')[1];

        if ($tr.next('tr').length != 0)
            return;

        if ($('#amenities_' + key).val().length == 0)
            return;

        var $rowid = $('#amenitiesrowid'),
            count = parseInt($rowid.val()) + 1,
            template = $('#dummy-amenities tbody').html();

        template = template.replace(/__1/g, '_' + count);
        $tr.parent('tbody').append(template);
        $rowid.val(count);
        $('.amenitiesDelete_' + key).show();
    }

    function deleteAmenities(x,e) {
        e.preventDefault();
        if (!confirm('Do you want to Delete'))
            return false;

        var $tr = $(x).closest('tr'),
            $tbody = $tr.parent('tbody');

        if ($tbody.find('> tr').length == 1) {
            var template = $('#dummy-amenities tbody').html();
            template = template.replace(/__1/g, '_' + 1);
            $tbody.append(template);
            $('#amenitiesrowid').val(1);
        }

        $tr.next('tr.subTr').remove();
        $tr.remove();
        return false;
    }

    function addDrawingRow(x) {
        var $x =  $(x),
            $tr = $x.closest('tr'),
            key = $x[0].id.split('_')[1];

        if ($tr.next('tr').length != 0) return;

        if ($('#drawType_' + key).val().length == 0) return;

        var $rowid = $('#drawingrowid'),
            count = parseInt($rowid.val()) + 1,
            template = $('#dummy-drawing tbody').html();

        template = template.replace(/__1/g, '_' + count);
        $tr.parent('tbody').append(template);
        $rowid.val(count);
        $('.drawDelete_' + key).show();
        bindDrawAttached();
    }

    function deleteDrawing(x,e) {

        e.preventDefault();

        var $tr = $(x).closest('tr'),
            $tbody = $tr.parent('tbody');

        if($tr.find('.fa-file-o').length > 0) {
            alert('Document attached. Remove document and then try!');
            return false;
        }

        if (!confirm('Do you want to Delete'))
            return false;



        if ($tbody.find('> tr').length == 1) {
            var template = $('#dummy-drawing tbody').html();
            template = template.replace(/__1/g, '_' + 1);
            $tbody.append(template);
            $('#drawingrowid').val(1);
        }

        $tr.hide();
        return false;
    }

    function addDocumentRow(x) {
        var $x =  $(x),
            $tr = $x.closest('tr'),
            key = $x[0].id.split('_')[1];

        if ($tr.next('tr').length != 0)
            return;

        if ($('#docType_' + key).val().length == 0)
            return;

        var $rowid = $('#documentrowid'),
            count = parseInt($rowid.val()) + 1,
            template = $('#dummy-document tbody').html();

        template = template.replace(/__1/g, '_' + count);
        $tr.parent('tbody').append(template);
        $rowid.val(count);
        $('.docDelete_' + key).show();
        bindDocAttached();
    }

    function deleteDocument(x,e) {
        e.preventDefault();
        if (!confirm('Do you want to Delete'))
            return false;

        var $tr = $(x).closest('tr'),
            $tbody = $tr.parent('tbody');

        if ($tbody.find('> tr').length == 1) {
            var template = $('#dummy-document tbody').html();
            template = template.replace(/__1/g, '_' + 1);
            $tbody.append(template);
            $('#documentrowid').val(1);
        }

        $tr.next('tr.subTr').remove();
        $tr.remove();
        return false;
    }

    function addConsultantRow(x) {
        var $x =  $(x),
            $tr = $x.closest('tr'),
            key = $x[0].id.split('_')[1];

        if ($tr.next('tr').length != 0)
            return;

        if ($('#consultantname_' + key).val().length == 0 || $('#consultanttype_' + key).val().length == 0
            || $('#fees_' + key).val().length == 0 || $('#feesamount_' + key).val().length == 0)
            return;

        var $rowid = $('#consultantrowid'),
            count = parseInt($rowid.val()) + 1,
            template = $('#dummy-consultant tbody').html();

        template = template.replace(/__1/g, '_' + count);
        $tr.parent('tbody').append(template);
        $rowid.val(count);
        $('.consultDelete_' + key).show();
    }

    function deleteConsultant(x,e) {
        e.preventDefault();
        if (!confirm('Do you want to Delete'))
            return false;

        var $tr = $(x).closest('tr'),
            $tbody = $tr.parent('tbody');

        if ($tbody.find('> tr').length == 1) {
            var template = $('#dummy-consultant tbody').html();
            template = template.replace(/__1/g, '_' + 1);
            $tbody.append(template);
            $('#consultantrowid').val(1);
        }

        $tr.next('tr.subTr').remove();
        $tr.remove();
        return false;
    }

    function addPCostRow(x) {
        calcTotalPropCost();

        var $x =  $(x),
            $tr = $x.closest('tr'),
            key = $x[0].id.split('_')[1];

        if ($tr.next('tr:not(.total)').length != 0)
            return;

        if ($('#exparticular_' + key).val().length == 0 || $('#examount_' + key).val().length == 0)
            return;

        var $rowid = $('#exrowid'),
            count = parseInt($rowid.val()) + 1,
            template = $('#dummy-expense tbody').html();

        template = template.replace(/__1/g, '_' + count);
        $tr.after(template);
        $rowid.val(count);
        $('.exDelete_' + key).show();
        bindPCostAutocomplete(count);
    }

    function deletePCostRow(x,e) {
        e.preventDefault();
        if (!confirm('Do you want to Delete'))
            return false;

        var $tr = $(x).closest('tr'),
            $tbody = $tr.parent('tbody');

        if ($tbody.find('> tr:not(.total)').length == 1) {
            var template = $('#dummy-expense tbody').html();
            template = template.replace(/__1/g, '_' + 1);
            $tr.after(template);
            $('#extrowid').val(1);
        }

        $tr.remove();
        calcTotalPropCost();

        return false;
    }

    function addApprovalRow(x) {
        calcTotalPropCost();

        var $x =  $(x),
            $tr = $x.closest('tr'),
            key = $x[0].id.split('_')[1];

        if ($tr.next('tr:not(.total)').length != 0)
            return;

        if ($('#approvalauthority_' + key).val().length == 0 || $('#approvaldate_' + key).val().length == 0 || $('#approvalno_' + key).val().length == 0)
            return;

        var $rowid = $('#approvalrowid'),
            count = parseInt($rowid.val()) + 1,
            template = $('#dummy-approval tbody').html();

        template = template.replace(/__1/g, '_' + count);
        $tr.after(template);
        $rowid.val(count);
        $('.approvalDelete_' + key).show();
        $('.date_picker').datepicker( {format: "dd-mm-yyyy"});
    }

    function deleteApprovalRow(x,e) {
        e.preventDefault();
        if (!confirm('Do you want to Delete'))
            return false;

        var $tr = $(x).closest('tr'),
            $tbody = $tr.parent('tbody');

        if ($tbody.find('> tr:not(.total)').length == 1) {
            var template = $('#dummy-approval tbody').html();
            template = template.replace(/__1/g, '_' + 1);
            $tr.after(template);
            $('#approvalrowid').val(1);
            $('.date_picker').datepicker( {format: "dd-mm-yyyy"});
        }

        $tr.remove();
        return false;
    }

    function calcTotalPropCost() {
        var $amt = $('input[id^=examount_]');
        var summaryProposalCost = 0;
        $.each($amt, function() {
            var amt = parseFloat(isNullCheck($(this).val(),'number'));
            summaryProposalCost += amt;
        });
        $('#totalProposalCost').val(sanitizeNumber(summaryProposalCost,2,true));
        calcCostSummary();
    }

    function addExIncomeRow(x) {
        calcExIncomeCost();

        var $x =  $(x),
            $tr = $x.closest('tr'),
            key = $x[0].id.split('_')[1];

        if ($tr.next('tr:not(.total)').length != 0)
            return;

        if ($('#incomeparticular_' + key).val().length == 0 || $('#incomeamount_' + key).val().length == 0)
            return;

        var $rowid = $('#incomerowid'),
            count = parseInt($rowid.val()) + 1,
            template = $('#dummy-income tbody').html();

        template = template.replace(/__1/g, '_' + count);
        $tr.after(template);
        $rowid.val(count);
        $('.incomeDelete_' + key).show();
        bindEIncomeAutocomplete(count);
    }


    function bindDrawAttached() {
        var docFiles = $('input[id^=drawFile_]');
        docFiles.unbind('change');

        docFiles.on('change', function() {
            var $this = $(this);
            var $tarEl = $(this).siblings('i');
            var $tooltip = $tarEl.parent('span');
            var $tarA = $tarEl.closest('a');
            if($(this).val() != '') {
                $tarEl.removeClass('fa-paperclip').addClass('fa-file-o file-do');
                $tooltip.attr('data-original-title', 'Document Attached');

                if($tarA.next('i.brkn').length == 0)
                    $('<i class="fa fa-chain-broken brkn" onclick="removeAttachment($(this));"></i>').insertAfter($tarA);
            } else {
                $tarA.next('i.brkn').remove();
                $tarEl.addClass('fa-paperclip').removeClass('fa-file-o file-do');
                $tooltip.attr('data-original-title', 'Click to attach documents');
            }
        });
    }

    function bindDocAttached() {
        var docFiles = $('input[id^=docFile_]');
        docFiles.unbind('change');

        docFiles.on('change', function() {
            var $this = $(this);
            var $tarEl = $(this).siblings('i');
            var $tooltip = $tarEl.parent('span');
            var $tarA = $tarEl.closest('a');
            if($(this).val() != '') {
                $tarEl.removeClass('fa-paperclip').addClass('fa-file-o file-do');
                $tooltip.attr('data-original-title', 'Document Attached');

                if($tarA.next('i.brkn').length == 0)
                    $('<i class="fa fa-chain-broken brkn" onclick="removeAttachment($(this));"></i>').insertAfter($tarA);
            } else {
                $tarA.next('i.brkn').remove();
                $tarEl.addClass('fa-paperclip').removeClass('fa-file-o file-do');
                $tooltip.attr('data-original-title', 'Click to attach documents');
            }
        });
    }

    function removeAttachment($tarEl) {

        if (!confirm('Do you want to Remove')) {
            return false;
        }

        var $tarLi = $tarEl.closest('li');
        var $tarA = $tarLi.find('a');
        var $tarI = $tarA.find('i.fa-file-o');
        var $tarIp = $tarLi.find('input[type="hidden"]');

        $tarIp.attr('type', 'file').removeAttr('value');
        $tarA.attr('href', '#').removeAttr('download').removeAttr('target');
        $tarI.addClass('fa-paperclip').removeClass('fa-file-o file-do');
        $tarA.html('<span class="btn-file butclr_imp">' + $tarA.html() + '</span>');
        bindDrawAttached();
        bindDocAttached();
        $tarEl.remove();
    }

    function deleteExIncomeRow(x,e) {
        e.preventDefault();
        if (!confirm('Do you want to Delete'))
            return false;

        var $tr = $(x).closest('tr'),
            $tbody = $tr.parent('tbody');

        if ($tbody.find('> tr:not(.total)').length == 1) {
            var template = $('#dummy-income tbody').html();
            template = template.replace(/__1/g, '_' + 1);
            $tr.after(template);
            $('#incomerowid').val(1);
        }

        $tr.remove();
        calcExIncomeCost();

        return false;
    }

    function calcExIncomeCost() {
        var $amt = $('input[id^=incomeamount_]');
        var summaryExpectedIncome = 0;
        $.each($amt, function() {
            var amt = parseFloat(isNullCheck($(this).val(),'number'));
            summaryExpectedIncome += amt;
        });
        $('#totalExpectedIncome').val(sanitizeNumber(summaryExpectedIncome,2,true));
        calcCostSummary();
    }

    function calcCostSummary(){
         var dIncome = isNullCheck($('#totalExpectedIncome').val(),'number'),
             dExpense = isNullCheck($('#totalProposalCost').val(),'number'),
             dProfit = parseFloat(dIncome) - parseFloat(dExpense);
         $('#netprofit').val(sanitizeNumber(dProfit,2,true));
    }

    function bindPCostAutocomplete(rowId) {
        $('#exparticular_' + rowId).autocomplete({
            lookup: arr_proposalCostParticulars,
            showNoSuggestionNotice: false,
            lookupFilter: function (suggestion, originalQuery, queryLowerCase) {
                if (queryLowerCase == '*') {
                    return suggestion.value;
                } else {
                    var re = new RegExp($.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');
                    return re.test(suggestion.value);
                }
            }
        });
    }

    function bindEIncomeAutocomplete(rowId) {
        $('#incomeparticular_' + rowId).autocomplete({
            lookup: arr_expectedincomeParticulars,
            showNoSuggestionNotice: false,
            lookupFilter: function (suggestion, originalQuery, queryLowerCase) {
                if (queryLowerCase == '*') {
                    return suggestion.value;
                } else {
                    var re = new RegExp($.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');
                    return re.test(suggestion.value);
                }
            }
        });
    }

    function addConstructionRow(x) {
        var $x =  $(x),
            $tr = $x.closest('tr'),
            key = $x[0].id.split('_')[1];

        if ($tr.next('tr').length != 0)
            return;

        var $rowid = $('#constructionrowid'),
            count = parseInt($rowid.val()) + 1,
            template = $('#dummy-construction-schedule tbody').html();

        template = template.replace(/__1/g, '_' + count);
        $tr.parent('tbody').append(template);
        $rowid.val(count);
        $('.constructionDelete_' + key).show();

        bindDatepicker();
    }

    function bindDatepicker() {
        $('.date_picker_year').datepicker( {
            format: "yyyy",
            startView: "years",
            minViewMode: "years"
        });
    }

    function deleteConstructionRow(x,e) {
        e.preventDefault();
        if (!confirm('Do you want to Delete'))
            return false;

        var $tr = $(x).closest('tr'),
            $tbody = $tr.parent('tbody');

        if ($tbody.find('> tr').length == 1) {
            var template = $('#dummy-construction-schedule tbody').html();
            template = template.replace(/__1/g, '_' + 1);
            $tbody.append(template);
            $('#constructionrowid').val(1);

            bindDatepicker();
        }

        $tr.remove();
        updateFundFlowChart();
        return false;
    }

    function updateFundFlowChart() {
        var $rate = $('input[id^=constructionamount_]');
        var chartData = [];
        $.each($rate, function() {
            var $this = $(this),
                name = $this[0].id;
            if (name.indexOf('__') != -1) return;

            var key = name.split('_')[1],
                name = $('#constructionyear_'+key).val(),
                rate =  parseFloat(isNullCheck($this.val(),'number'));

            if (name.length !=0) {
                chartData.push({
                    'Year': name,
                    'Rate': rate
                });
            }
        });

        if (fundFlowChart != null) {
            fundFlowChart.dataProvider = chartData;
            fundFlowChart.validateData();
            return;
        }

        fundFlowChart = AmCharts.makeChart("fundFlowChart", {
            "theme": "light",
            "type": "serial",
            "marginRight": 80,
            "autoMarginOffset": 20,
            "numberFormatter":{precision:-1, decimalSeparator:'.', thousandsSeparator:''},
            "marginTop":20,
            "dataProvider": chartData,
            "valueAxes": [{
                "id": "v1",
                "axisAlpha": 0.1
            }],
            "graphs": [{
                "useNegativeColorIfDown": true,
                "balloonText": "[[category]]<br><b>value: [[value]]</b>",
                "bullet": "round",
                "bulletBorderAlpha": 1,
                "bulletBorderColor": "#FFFFFF",
                "hideBulletsCount": 50,
                "lineThickness": 2,
                "lineColor": "#fdd400",
                "negativeLineColor": "#67b7dc",
                "valueField": "Rate"
            }],
            "chartCursor": {
                "valueLineEnabled": true,
                "valueLineBalloonEnabled": true
            },
            "categoryField": "Year",
            "categoryAxis": {
                "axisAlpha": 0,
                "minHorizontalGap": 60
            }
        });
    }
</script>