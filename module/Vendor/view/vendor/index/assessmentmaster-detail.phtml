<style type="text/css">
    .vendor_button 		  {height: 38px !important;}
    .vendor_button select {height: 35px !important;}
</style>

<div class="content_wrapper  padlr0">
	<div class="container-fluid">
		<form action="" method="post" enctype="multipart/form-data">
			 <div class="row">
				<div class="col-lg-12">
					<h1 class="padbtm0">Assessment Master Detail</h1> 
				</div>
				<div class="col-lg-12 clear">
					<div class="table-responsive clear">				

						<table class="table table-hover vendar_bottom clear" id="contactTable">
							<thead>
							  <tr>
								<th>Description</th>
								<th>AssessmentType</th>
								<th>Supply</th>
								<th>Contract</th>
								<th>Service</th>
								<th>MaxPoint</th>
								<th></th>
							  </tr>
							</thead>
							<tbody>
							<?php 
								$count=0;
								foreach($assessmentResult as $resu){
									$count=$count+1;
							?>
									<tr>
										<td width="15%">
										<input type='hidden' name="Id_<?php echo $count;?>" id="Id_<?php echo $count;?>"  tagname="Id" value="<?php echo $resu['CheckListId'];?>" />
										<input type="text" class="parent_txts newRow" name="Description_<?php echo $count;?>" id="Description_<?php echo $count;?>" tagname="Description" value="<?php echo $resu['Description'];?>" /></td>
										<td width="20%">
											<div class="vendor_button">
												<select class="parent_txts" name="AssessmentType_<?php echo $count;?>" id="AssessmentType_<?php echo $count;?>" tagname="AssessmentType">
													<option value="">Select one</option>
													<?php								
													$Assest = array('R'=>'Registration Assessment', 'W'=>'Work based Assessment', 'T'=>'Team or Feedback Assessment');
													foreach($Assest as $key=>$value){
													?>
													<option value="<?php echo $key;?>" <?php echo (($key==$resu['AssessmentType'])?'selected':'');?>><?php echo $value;?></option>
													<?php
													}
													?>
												</select>
											</div> 
										</td>
										<td width="15%">
										<div class="checkbox">
											<p>
												<center><input type="checkbox" value="" name="Supply_<?php echo $count;?>" class="parent_txts newRow" id="Supply_<?php echo $count;?>" tagname='Supply' <?php echo (($resu['Supply']==1)?'checked': '');?>><center>
											</p>
										</div>
										</td>
										<td width="15%">
										<div class="checkbox">
											<p>
                                            <center><input type="checkbox" value="" name="Contract_<?php echo $count;?>" class="parent_txts newRow" id="Contract_<?php echo $count;?>" tagname='Contract' <?php echo (($resu['Contract']==1)?'checked': '');?>><center>
											</p>
										</div>
										</td>
										<td width="15%">
										<div class="checkbox">
											<p>
                                            <center><input type="checkbox" value="" name="Service_<?php echo $count;?>" class="parent_txts newRow" id="Service_<?php echo $count;?>" tagname='Service' <?php echo (($resu['Service']==1)?'checked': '');?>><center>
											</p>

										</div>
										</td>
										<td width="15%"> <input type="text" style="text-align: right;" class="parent_txts newRow deleteFun"  name="MaxPoint_<?php echo $count;?>"  id="MaxPoint_<?php echo $count;?>" tagname='MaxPoint' value="<?php echo number_format((float)$resu['MaxPoint'], 2, '.', '');?>" onblur="return FormatNum(this, 2)" onkeypress="return isDecimal(event,this)" ondrop='return false;' onpaste='return false;'/></td>
										
										<td cla ss="del"><a href="#" class="remove vendar_styles"><span class="glyphicon glyphicon-trash" data-toggle="tooltip" data-placement="top" data-original-title="Delete"></span></a></td>
									</tr>
								<?php
								}
								if($count==0){
								?>
									<tr>
										<td width="15%">
										<input type='hidden' name="Id_1" id="Id_1"  tagname="Id" />
										<input type="text" class="parent_txts newRow" name="Description_1" id="Description_1" tagname="Description" /></td>
										<td width="20%">
											<div class="vendor_button">
												<select class="parent_txts" name="AssessmentType_1" id="AssessmentType_1" tagname="AssessmentType">
												<option value="">Select one</option>
												<?php								
												$Assest = array('R'=>'Registration Assessment', 'W'=>'Work based Assessment', 'T'=>'Team or Feedback Assessment');
												foreach($Assest as $key=>$value){
												?>
												<option value="<?php echo $key;?>"><?php echo $value;?></option>
												<?php
												}
												?>
												</select>
											</div> 
										</td>
										<td width="15%">
										<div class="checkbox">
											<p>
                                            <center><input type="checkbox" name="Supply_1" id="Supply_1" class="parent_txts newRow" tagname='Supply'><center>
											</p>
										</div>
										</td>
										<td width="15%">
										<div class="checkbox">
											<p>
                                            <center><input type="checkbox" value="" class="parent_txts newRow" class='parent_txts newRow' name="Contract_1" id="Contract_1" tagname='Contract' ></center>
											</p>
										</div>
										</td>
										<td width="15%">
										<div class="checkbox">
											<p>
                                            <center><input type="checkbox" value="" class="parent_txts newRow" name="Service_1" id="Service_1" tagname='Service' ></center>
											</p>
										</div>
										</td>
										<td width="15%"><input type="text" style="text-align: right;" class="parent_txts deleteFun" name="MaxPoint_1"  id="MaxPoint_1" tagname='MaxPoint' onblur="return FormatNum(this, 2)" onkeypress="return isDecimal(event,this)" ondrop='return false;' onpaste='return false;'/></td>
										<td class="del" style="display:none;"><a href="#" class="remove vendar_styles"><span class="glyphicon glyphicon-trash" data-toggle="tooltip" data-placement="top" data-original-title="Delete"></span></a></td>
									</tr>
								<?php
								}
								else{
									$count=$count+1;
								?>
									<tr>
										<td width="15%">
										<input type='hidden' name="Id_<?php echo $count;?>" id="Id_<?php echo $count;?>"  tagname="Id"  />
										<input type="text" class="parent_txts newRow" name="Description_<?php echo $count;?>" id="Description_<?php echo $count;?>" tagname="Description" /></td>
										<td width="20%">
											<div class="vendor_button">
												<select class="parent_txts" name="AssessmentType_<?php echo $count;?>" id="AssessmentType_<?php echo $count;?>" tagname="AssessmentType">
												<option value="">Select one</option>
												<?php								
												$Assest = array('R'=>'Registration Assessment', 'W'=>'Work based Assessment', 'T'=>'Team or Feedback Assessment');
												foreach($Assest as $key=>$value){
												?>
												<option value="<?php echo $key;?>"><?php echo $value;?></option>
												<?php
												}
												?>
												</select>
											</div> 
										</td>
										<td width="15%">
										<div class="checkbox">
											<p>
                                            <center><input type="checkbox" class='parent_txts newRow' name="Supply_<?php echo $count;?>" id="Supply_<?php echo $count;?>" tagname="Supply" ><center>
											</p>
										</div>
										</td>
										<td width="15%">
										<div class="checkbox">
											<p>
                                            <center><input type="checkbox" class='parent_txts newRow' name="Contract_<?php echo $count;?>" id="Contract_<?php echo $count;?>" tagname="Contract" ><center>
											</p>
										</div>
										</td>
										<td width="15%">
										<div class="checkbox">
											<p>
                                            <center><input type="checkbox" class='parent_txts newRow' name="Service_<?php echo $count;?>" id="Service_<?php echo $count;?>" tagname="Service" >
											</p>
										</div>
										</td>
										<td width="15%"><input type="text" style="text-align: right;" class="parent_txts deleteFun" name="MaxPoint_<?php echo $count;?>"  id="MaxPoint_<?php echo $count;?>" tagname='MaxPoint' onblur="return FormatNum(this, 2)" onkeypress="return isDecimal(event,this)" ondrop='return false;' onpaste='return false;'/></td>
										
										<td class="del" style="display:none;"><a href="#" class="remove vendar_styles"><span class="glyphicon glyphicon-trash" data-toggle="tooltip" data-placement="top" data-original-title="Delete"></span></a></td>
									</tr>
								<?php
								}
								?>		  
							</tbody>
						</table>
						<input type="hidden" class="parent_txts" name="RowCount" id="RowCount" value="1" />
					</div>                         
				 </div> 
			</div>
		</form>
	 </div>
</div>
<div class="col-lg-12 savebtn_area">
    <ul>
        <li id="submitdata" class="dropdown save_btn float_r">
            <a href="javascript:void(0);" class="ripple" >Save</a>
        </li>      
    </ul>
</div>
<script>
removetr();
function removetr(){
	$('.remove').click(function(){
		if($(this).closest('tr').index() != 1){
            if (!confirm('Do you want to Delete'))
                return false;
                $(this).closest('tr').remove();
                $('#contactTable tbody tr').each(function () {
                    var index = $(this).index() + 1;
                    $(this).find('select, input:text, input:checkbox').each(function () {
                        $(this).attr('name', $(this).attr('tagname') + '_' + index);
                        $(this).attr('id', $(this).attr('tagname') + '_' + index);
                    })

                });
		    }
	});
}
$('#submitdata').click(function(){
	var rowCount = $('#contactTable tbody tr').length;
	$('#RowCount').val(rowCount);
	$('form').submit();
});

$('#AddNew').click(function(){
	$('#contactTable tbody').append('<tr>'+$('#contactTable tbody tr:first').html()+'</tr>');
	$('#contactTable tbody tr').each(function(){
		var index=$(this).index() + 1;
		var lastIndex=$('#contactTable tbody tr:last').index() + 1;
		$(this).find('select, input:text, input:checkbox').each(function(){
			if(index==lastIndex){
				if($(this).prop('tagName').toLowerCase() == 'input'){
					if(($(this).attr('type') == 'text') && ($(this).attr('type') == 'checkbox') ){
                       $(this).val('');
                      $(this).prop('checked', false);
                    }
				}
				else{
					$(this).val('1');
				}
			}
			$(this).attr('name', $(this).attr('tagname')+'_'+index);
			$(this).attr('id', $(this).attr('tagname')+'_'+index);
        })
		
	});	
	removetr();
});
addRow();
function addRow(){
	$( ".newRow" ).unbind();
	$( ".newRow" ).bind('keyup', function() {
	//alert($(this).closest("tr").index()+"------------"+$("#contactTable tbody tr:last").index())
		if($(this).val().length>0 && $(this).closest("tr").index() == $("#contactTable tbody tr:last").index()){
			$("#contactTable tbody").append("<tr>"+$("#contactTable tbody tr:first").html()+"</tr>");
				$("#contactTable tbody tr").each(function(){
				var index=$(this).index() + 1;
				var lastIndex=$("#contactTable tbody tr:last").index() + 1;
				$(this).find("select,input:checkbox, input:text").each(function(){
					if(index==lastIndex){
						if($(this).prop("tagName").toLowerCase() == 'input'){
							if($(this).attr('type') == 'text')
								$(this).val("");
								$(this).prop('checked', false);
						}
						else{
							$(this).val("1");

						}
					}
					$(this).attr("name", $(this).attr("tagname")+'_'+index);
					$(this).attr("id", $(this).attr("tagname")+'_'+index);
                    $("#contactTable tbody tr:last").find('.del').hide();
				})
			});	
			removetr();
			addRow();
		}
	});
}

$(document).on('change','.deleteFun',function(){
    if($(this).val() != ''){
        $(this).parent().parent().find('.del').show();
    } else {
        $(this).parent().parent().find('.del').hide();
    }
});
</script>