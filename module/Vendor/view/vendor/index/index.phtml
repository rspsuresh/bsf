<script src="<?php echo $this->basePath();?>/js/multiple-emails.js"></script>
<script type="text/javascript" src="<?php echo $this->basePath(); ?>/js/select2.full.min.js"></script>
<link rel="stylesheet" href="<?php echo $this->basePath();?>/css/multiple-emails.css">
<link rel="stylesheet" href="<?php echo $this->basePath() . '/css/project.css'; ?>" />
<style>
    .ulclass>li{float:none!important;}
    .mar_15{margin-top:15px;}
    .fixed-action-btn ul {left: -68px !important;}
	.select2-container {background-color: #f2f2f2 !important;}
	.table-responsive {box-shadow: 0 0px 0 rgba(0, 0, 0, 0.12), 0 0px 0px rgba(0, 0, 0, 0.24) !important}
</style>
<div class="content_wrapper padlr0">
    <div class="container-fluid">
        <div class="col-lg-12" style="margin-bottom: 10px">
            <h1>Manage Vendors Information</h1>
        </div>
        <div class="fixed-action-btn active mar_15">
            <a class="btn-floating btn-large">
                <i class="fa fa-paperclip"></i>
            </a>
            <ul>
                <li>
                    <a class="btn-floating hide-input-file" data-toggle="tooltip" data-placement="top" data-original-title="Import From Excel">
                        <i class="fa fa-file-excel-o"></i>
                        <input type="file" name="myfile" id="myfile" class="input-large" accept=".xls,.xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" onchange="getExcelField(this.value)" />
                    </a>
                </li>
            </ul>
        </div>
        <div class="col-lg-12 clear">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 padlr0  cnt_slider">
                    <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
                        <!-- Wrapper for slides -->
                        <div class="carousel-inner" role="listbox">
                            <div class="item active">
                                <ul class="onbrd_rdo_box onbrd_rdo_box_change">
                                    <li class="" >
                                        <a href="<?php echo $this->url('vendor/basic-detail',array('controller'=>'index','action'=>'basic-detail',"vendorid"=>"0","mode"=>"0")); ?>" >
                                            <div class="rdo_box_icon brad_50">
                                                <img src="<?php echo $this->basePath(); ?>/images/rdo_box_icon9.png" class="m_auto"/>
                                            </div>
                                            <h2>Do you want to create Vendor ?</h2>
                                            <div class="rdo_box_link brad_50"><span><i class="fa fa-external-link"></i></span></div>
                                        </a>
                                    </li>
                                    <li class="">
                                        <a href="<?php echo $this->url('vendor/default',array('controller'=>'index','action'=>'vendor-register')); ?>" role="button" data-slide="next">
                                            <div class="rdo_box_icon brad_50">
                                                <img src="<?php echo $this->basePath(); ?>/images/rdo_box_icon1.png" class="m_auto"/>
                                            </div>
                                            <h2>Do you want to View/Edit Vendor ?</h2>
                                            <div class="rdo_box_link brad_50"><span><i class="fa fa-external-link"></i></span></div>
                                        </a>
                                    </li>
                                    <li class="">
                                        <a href="#carousel-example-generic" role="button" data-slide="next">
                                            <div class="rdo_box_icon brad_50">
                                                <img src="<?php echo $this->basePath(); ?>/images/invite.png" class="m_auto"/>
                                            </div>
                                            <h2>Do you want to Invite Vendor ?</h2>
                                            <div class="rdo_box_link brad_50"><span><i class="fa fa-external-link"></i></span></div>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <div class="item min_h550">
                                <div class="col-lg-12 commargin_top clear">
                                    <ul class="prev_next">
                                        <li class="float_l">
                                            <a href="#carousel-example-generic" data-slide="prev">
                                                <span><i class="fa fa-arrow-left"></i></span>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="col-lg-6 col-lg-offset-3 col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2" style="margin-top: 60px;">
                                    <form class="form-horizontal" id="frmPost" action="" method="post">
                                        <div class="row">
                                            <div class="form-group col-lg-12" style="float:none !important;">
                                                <textarea id="description" name="example_email" class="form-control lbl_move" label="Enter One or More Vendor Email to Invite"></textarea>
                                            </div>
                                        </div>
                                        <div class="col-lg-5 col-lg-offset-4 col-md-5 col-md-offset-4 col-sm-5 col-sm-offset-4 col-xs-5 col-xs-offset-2">
                                            <button class="vendor_color" type="submit" id="submitData" ><span class="plane_vendoricon"><i class="fa fa-location-arrow"></i></span>Send Invite</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--Import-->
<div id="excelfieldmodal" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h1>Vendor Import Sheet - Assign Fields</h1>
            </div>
            <div class="modal-body">
                <div class="table-responsive popuptable">
                    <table class="table" width="100%" style=" margin-bottom:0px;">
                        <tbody>
                        <tr id="excelfieldTable"></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="clearfix"></div>
            <div class="modal-footer"> <a href="#" class="md_cance" data-dismiss="modal" data-toggle="tooltip" title="" data-original-title="Cancel" style="position: relative; overflow: hidden;">Cancel<span class="ripple-wrapper"></span><span class="ripple-wrapper"></span></a>
                <button type="button" class="md_ok" onclick="return fileupload()" >Next</button>
            </div>
        </div>
    </div>
</div>
<div id="excelmodal" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-lg" role="document" style="width:75%;">
        <form id="excel_model">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h1>Vendor Import Sheet</h1>
                </div>
                <div class="modal-body">
                    <div id="error_data"></div>
                    <div class="table-responsive topsp">
                        <table class="table" style=" margin-bottom:0px;" id="excelTable">
                            <thead>
                            <tr>
                                <th class="th-modal">VendorName</th>
                                <th class="th-modal">Address</th>
                                <th class="th-modal">City</th>
                                <th class="th-modal">Pincode</th>
                                <th class="th-modal">Contact Person</th>
                                <th class="th-modal">Contact No</th>
                                <th class="th-modal">Mobile No</th>
                                <th class="th-modal">Phone No</th>
                                <th class="th-modal">EmailId</th>
                                <th class="th-modal">Fax No</th>
                                <th class="th-modal">Supply</th>
                                <th class="th-modal">Contract</th>
                                <th class="th-modal">Service</th>
                                <th class="th-modal">CST No</th>
                                <th class="th-modal">TINGST</th>
                                <th class="th-modal">TIN No</th>
                                <th class="th-modal">PAN No</th>
                                <th class="th-modal">Service TaxNo</th>
                                <th class="th-modal">Bank Name</th>
                                <th class="th-modal">Branch</th>
                                <th class="th-modal">A/C No</th>
                                <th class="th-modal">IFSC Code</th>
                                <th class="th-modal">Reg No</th>
                                <th class="th-modal">Reg Date</th>
                                <th class="th-modal">Cheque Name</th>
                                <th class="th-modal">Work Nature</th>
                            </tr>
                            </thead>
                            <tbody id="table_bind">
                            </tbody>
                            <input type="hidden" name="rowCount" value="0" id="rowCount" />
                            <input type="hidden" name="csrf" value="<?php echo (isset($csrf)) ? $csrf : "";?>" id="csrf" />
                            <input type="hidden" name="mode" value="validate" id="mode" />
                        </table>
                    </div>
                </div>
                <div class="modal-footer clear">
                    <a href="#" id="can_button" class="md_cance" data-dismiss="modal" data-toggle="tooltip" title="" data-original-title="Cancel" style="position: relative; overflow: hidden;">Cancel<span class="ripple-wrapper"></span><span class="ripple-wrapper"></span></a>
                    <button type="button" id="app_button" class="md_ok" onclick="return dataInsert()" >Apply</button>
                </div>
            </div>
        </form>
    </div>
</div>
<script id="excel_bind" type="text/template" class="hide">
    <tr id="excelrowid__" >
        <td><input class="parent_text" type="text"  placeholder="Vendor Name" name="excelvname__" value = "" id="excelvname__"/></td>
        <td><input class="parent_text" type="text"  placeholder="Address" name="exceladdress__" value = "" id="exceladdress__" /></td>
        <td><input class="parent_text" type="text"  placeholder="City" name="excelcity__" value = "" id="excelcity__" /></td>
        <td><input class="parent_text" type="text"  placeholder="Pincode" name="excelpincode__" value = "" id="excelpincode__"/></td>
        <td><input class="parent_text" type="text"  placeholder="Contact Person" name="excelcperson__" value = "" id="excelcperson__" /></td>
        <td><input class="parent_text" type="text" placeholder="Contact No" name="excelcno__" value = "" id="excelcno__" /></td>
        <td><input class="parent_text" type="text" placeholder="Mobile No" name="excelmobno__" value = "" id="excelmobno__" /></td>
        <td><input class="parent_text" type="text" placeholder="Phone No" name="excelphnno__" value = "" id="excelphnno__" /></td>
        <td><input class="parent_text" type="text" placeholder="EmailId" name="excelemail__" value = "" id="excelemail__" /></td>
        <td><input class="parent_text" type="text" placeholder="Fax No" name="excelfaxno__" value = "" id="excelfaxno__" /></td>
        <td><input class="parent_text" type="text" placeholder="Supply" name="excelsupply__" value = "" id="excelsupply__" /></td>
        <td><input class="parent_text" type="text" placeholder="Contract" name="excelcontract__" value = "" id="excelcontract__" /></td>
        <td><input class="parent_text" type="text" placeholder="Service" name="excelservice__" value = "" id="excelservice__" /></td>
        <td><input class="parent_text" type="text" placeholder="CST No" name="excelcstno__" value = "" id="excelcstno__" /></td>
        <td><input class="parent_text" type="text" placeholder="TINGST" name="exceltingst__" value = "" id="exceltingst__" /></td>
        <td><input class="parent_text" type="text" placeholder="TIN No" name="exceltinno__" value = "" id="exceltinno__" /></td>
        <td><input class="parent_text" type="text" placeholder="PAN No" name="excelpanno__" value = "" id="excelpanno__" /></td>
        <td><input class="parent_text" type="text" placeholder="Service TaxNo" name="excelservicetaxno__" value = "" id="excelservicetaxno__" /></td>
        <td><input class="parent_text" type="text" placeholder="Bank Name" name="excelbankname__" value = "" id="excelbankname__" /></td>
        <td><input class="parent_text" type="text" placeholder="Branch" name="excelbranch__" value = "" id="excelbranch__" /></td>
        <td><input class="parent_text" type="text" placeholder="A/C No" name="excelacno__" value = "" id="excelacno__" /></td>
        <td><input class="parent_text" type="text" placeholder="IFSC Code" name="excelifsccode__" value = "" id="excelifsccode__" /></td>
        <td><input class="parent_text" type="text" placeholder="Reg No" name="excelregno__" value = "" id="excelregno__" /></td>
        <td><input class="parent_text" type="text" placeholder="Reg Date" name="excelregdate__" value = "" id="excelregdate__" /></td>
        <td><input class="parent_text" type="text" placeholder="Cheque Name" name="excelchquename__" value = "" id="excelchquename__" /></td>
        <td><input class="parent_text" type="text" placeholder="Work Nature" name="excelworknautre__" value = "" id="excelworknautre__" /></td>
        <td align="center">
            <ul class="action_btns">
                <li>
                    <a href="#" id="excelTrDelete__" class="excelTrDelete" onclick="deleteRow(this);"><i class="fa fa-trash-o" data-toggle="tooltip" data-placement="top" data-original-title="Delete" ></i></a>
                </li>
            </ul>
        </td>
    </tr>
</script>
<!--End-->
<script>
    $(function(){
        $('.right_lightbox_close').click(function(){
            $('.right_lightbox').hide();
            if ($(window).width() >=980){
                $('.left-panel').addClass('collapsed');
                $('.l_menuicon_nav').addClass('cross');
            }
        });
    });
	$(document).on('focus', '.select2', function() {
	  $(this).siblings('select').select2('open');
   });
    $(document).ready(function() {
        $(".single_dropdown").select2({
            placeholder: "",
            allowClear: true
        });
    });
</script>

<script>
    var arrayField =[];
    arrayField = [{ data :1, value: 'VendorName' },
        { data :2, value: 'Address' },
        { data :3, value: 'City' },
        { data :4, value: 'Pincode' },
        { data :5, value: 'ContactPerson' },
        { data :6, value: 'ContactNo' },
        { data :7, value: 'MobileNo' },
        { data :8, value: 'PhoneNo' },
        { data :9, value: 'EmailId' },
        { data :10, value: 'FaxNo' },
        { data :11, value: 'Supply' },
        { data :12, value: 'Contract' },
        { data :13, value: 'Service' },
        { data :14, value: 'CSTNo' },
        { data :15, value: 'TINGST' },
        { data :16, value: 'TINNo' },
        { data :17, value: 'PANNo' },
        { data :18, value: 'ServiceTaxNo' },
        { data :19, value: 'BankName' },
        { data :20, value: 'Branch' },
        { data :21, value: 'ACNo' },
        { data :22, value: 'IFSCCode' },
        { data :23, value: 'RegNo' },
        { data :24, value: 'RegDate' },
        { data :25, value: 'ChequeName' },
        { data :26, value: 'WorkNature' },
    ];
    var selectCol=[];
    var arrayFieldR = arrayField;
    function getExcelField(x,y) {
        $('#uploadedFile').val(x);
        $('#rowCount').val(0);
        $('#can_button').html('Cancel').attr('data-original-title','Cancel');
        $('#app_button').html('Apply');
        $('#error_data').html('');
        formData = new FormData();
        formData.append('file', $('#myfile').prop("files")[0]);
        formData.append('mode','title');
        formData.append('csrf', "<?php echo isset($csrf)?$csrf:''; ?>");

        $.ajax({
            url: getBaseURL() +"vendor/index/get-resource-field-data",
            async: false,
            dataType: 'script',
            cache: false,
            contentType: false,
            processData: false,
            data: formData,
            type: 'post',
            success: function(data,status, xhr) {
                var obj = jQuery.parseJSON(data);
                $("#excelfieldTable").find("th").remove();
                $("#excelfieldTable").find("td").remove();

                var sStr="Select Field";
                var data = "<option value=''></option>";
                for (var i = 0; i < obj.length; i++) {
                    var fieldName = $.trim(obj[i]['Field']);
                    if (fieldName != "") {
                        data +="<option value='"+ parseInt(i+1) +"'>"+fieldName+"</option>";
                    }
                }
                $.each(arrayFieldR,function(i,o) {
                    $("#excelfieldTable").append('<tr><th width="20%"><input id="efield_' + i + '" class="text-reon text-right" type="text" value="'+ o.value+'" style="background: transparent;"/></th><td width="50%"><select id="field_' + i + '" class="form-control single_dropdown lbl_move" style="width:100%;" label="'+sStr+'"></select></td></tr>');
                    $('#efield_' + i).prop('readonly', true);
                    $('#field_' + i).html(data);
                });
               $(document).on('focus', '.select2', function() {
                   $(this).siblings('select').select2('open');
               });
                $(".single_dropdown").select2({
                    placeholder: "",
                    allowClear: true
                });
                //bindexcelFieldComplete();
                $("#excelfieldmodal").modal('show');
            },
            error: function(xhr, status, errorThrown) {
                if (xhr.status == 400)
                    alert(xhr.responseText);
                else
                    alert(errorThrown);
            }
        });
        //clearInputFile($('#myfile'));//
    }
    function clearInputFile(file){
        var f = file[0];
        if(f.value){
            try{
                f.value = '';
            }catch(err){ }
            if(f.value){
                var form = document.createElement('form'),
                    parentNode = f.parentNode, ref = f.nextSibling;
                form.appendChild(f);
                form.reset();
                parentNode.insertBefore(f,ref);
            }
        }
    }
    function fileupload() {
        var isValid=true;
        $.each(arrayField,function(e,f){
            if($.trim($('#field_'+e).val())=="") {
                var check = parseInt(e)+1;
                if(check==1 || check==2 || check==3 || check==4 || check==5 || check==6 || check==7 || check==8 || check==7 || check==8 || check==9 || check==10 || check==11 || check==12 || check==13 || check==14 || check==15 || check==16 || check==17 || check==18 || check==19 || check==20 || check==21 || check==22 || check==23 || check==24 || check==25){
                    alert('Map the '+f.value);
                    isValid=false;
                }
            }

        });
        if (isValid==false) { return;}
        $("body").removeClass('modal-open');
        $("#excelfieldmodal").modal('hide');
        var arrHeader =[];
        for (var i = 0; i < $("#excelfieldTable").find("th").length; i++) {
            if($('#field_'+i).val()!="") {
                arrHeader.push({efield: $('#field_' + i +' option:selected').text(), field: $('#efield_' + i).val()});
            }
        }
        arrHeader =  JSON.stringify(arrHeader);
        formData.append('arrHeader', arrHeader);
        formData.append('mode', 'body');
        formData.append('csrf', "<?php echo isset($csrf)?$csrf:''; ?>");
        $.ajax({
            url: getBaseURL() +"vendor/index/get-resource-field-data",
            async: false,
            dataType: 'script',
            cache: false,
            contentType: false,
            processData: false,
            data:  formData,
            type: 'post',
            success: function(data,status, xhr) {
                var obj = jQuery.parseJSON(data);
                var template = $('#excel_bind').html();
                $('#table_bind').html('');
                if(obj.length>0) {
                    for (var j = 0; j < obj.length; j++) {
                        $('#table_bind').append(template.replace(/__/g, '_' + j));
                        $('#rowCount').val(j);
                        if (obj[j].Valid == true) {
                            $("#excelvname_" + j).val(isNullCheck(obj[j].VendorName, 'string'));
                            $("#exceladdress_" + j).val(isNullCheck(obj[j].Address, 'string'));
                            $("#excelcity_" + j).val(isNullCheck(obj[j].City, 'string'));
                            $("#excelpincode_" + j).val(isNullCheck(obj[j].Pincode, 'string'));
                            $("#excelcperson_" + j).val(isNullCheck(obj[j].ContactPerson, 'string'));
                            $("#excelcno_" + j).val(isNullCheck(obj[j].ContactNo, 'string'));
                            $("#excelmobno_" + j).val(isNullCheck(obj[j].MobileNo, 'string'));
                            $("#excelphnno_" + j).val(isNullCheck(obj[j].PhoneNo, 'string'));
                            $("#excelemail_" + j).val(isNullCheck(obj[j].EmailId, 'string'));
                            $("#excelfaxno_" + j).val(isNullCheck(obj[j].FaxNo, 'string'));
                            $("#excelsupply_" + j).val(isNullCheck(obj[j].Supply, 'string'));
                            $("#excelcontract_" + j).val(isNullCheck(obj[j].Contract, 'string'));
                            $("#excelservice_" + j).val(isNullCheck(obj[j].Service, 'string'));
                            $("#excelcstno_" + j).val(isNullCheck(obj[j].CSTNo, 'string'));
                            $("#exceltingst_" + j).val(isNullCheck(obj[j].TINGST, 'string'));
                            $("#exceltinno_" + j).val(isNullCheck(obj[j].TINNo, 'string'));
                            $("#excelpanno_" + j).val(isNullCheck(obj[j].PANNo, 'string'));
                            $("#excelservicetaxno_" + j).val(isNullCheck(obj[j].ServiceTaxNo, 'string'));
                            $("#excelbankname_" + j).val(isNullCheck(obj[j].BankName, 'string'));
                            $("#excelbranch_" + j).val(isNullCheck(obj[j].Branch, 'string'));
                            $("#excelacno_" + j).val(isNullCheck(obj[j].ACNo, 'string'));
                            $("#excelifsccode_" + j).val(isNullCheck(obj[j].IFSCCode, 'string'));
                            $("#excelregno_" + j).val(isNullCheck(obj[j].RegNo,'string'));
                            $("#excelregdate_" + j).val(isNullCheck(obj[j].RegDate, 'string'));
                            $("#excelchquename_" + j).val(isNullCheck(obj[j].ChequeName, 'string'));
                            $("#excelworknautre_" + j).val(isNullCheck(obj[j].WorkNature, 'string'));
                        }

                    }
                    $("#excelmodal").modal('show');
                    setTimeout(function() { $("body").addClass('modal-open');}, 200);

                } else {
                    alert("Contains No Data");
                }
            },
            error: function(xhr, status, errorThrown) {
                if (xhr.status == 400) {
                    alert(xhr.responseText);
                }
                else {
                    alert('Invalid Excel allocation');
                }
            }
        });
        //clearInputFile($('#myfile'));//
    }
    function dataInsert() {
        //$("#excelmodal").modal('hide');
        $("body").removeClass('modal-open');

        $.ajax({
            url: getBaseURL() + 'vendor/index/get-resource-field-data',
            type: 'POST',
            data: $('#excel_model').serialize(),
            success: function (data, textStatus, jqXHR) {

                var obj = jQuery.parseJSON(data);
				var firstInput = obj.first();
                console.log(firstInput);
                var lastInput = obj.last();
                console.log(lastInput);
                firstInput.focus();
                lastInput.on('keydown', function (e) {
                    if ((e.which === 9 && !e.shiftKey)) {
                        e.preventDefault();
                        firstInput.focus();
                    }
                });

                /*redirect first shift+tab to last input*/
                firstInput.on('keydown', function (e) {
                    if ((e.which === 9 && e.shiftKey)) {
                        e.preventDefault();
                        lastInput.focus();
                    }
                })
                var firstInput = obj.first();
                console.log(firstInput);
                var lastInput = obj.last();
                console.log(lastInput);
                firstInput.focus();
                lastInput.on('keydown', function (e) {
                    if ((e.which === 9 && !e.shiftKey)) {
                        e.preventDefault();
                        firstInput.focus();
                    }
                });

                /*redirect first shift+tab to last input*/
                firstInput.on('keydown', function (e) {
                    if ((e.which === 9 && e.shiftKey)) {
                        e.preventDefault();
                        lastInput.focus();
                    }
                })

                var template = $('#excel_bind').html();
                if(obj.length>0) {
                    $('#table_bind').html('');
                    $('#error_data').html('Error Data:');
                    for (var j = 0; j < obj.length; j++) {
                        $('#table_bind').append(template.replace(/__/g, '_' + j));
                        removeError($("#excelvname_" + j));
                        removeError($("#exceladdress_" + j));
                        removeError($("#excelcity_" + j));
                        removeError($("#excelpincode_" + j));
                        removeError($("#excelcperson_" + j));
                        removeError($("#excelcno_" + j));
                        removeError($("#excelemail_" + j));
                        removeError($("#excelmobno_" + j));
                        removeError($("#excelfaxno_" + j));
                        removeError($("#excelsupply_" + j));
                        removeError($("#excelcontract_" + j));
                        removeError($("#excelservice_" + j));
                        removeError($("#excelcstno_" + j));
                        removeError($("#exceltingst_" + j));
                        removeError($("#exceltinno_" + j));
                        removeError($("#excelpanno_" + j));
                        removeError($("#excelservicetaxno_" + j));
                        removeError($("#excelbankname_" + j));
                        removeError($("#excelbranch_" + j));
                        removeError($("#excelacno_" + j));
                        removeError($("#excelifsccode_" + j));
                        removeError($("#excelregno_" + j));
                        removeError($("#excelregdate_" + j));
                        removeError($("#excelchquename_" + j));
                        removeError($("#excelworknautre_" + j));
                        $("#excelvname_" + j).val(isNullCheck(obj[j].VendorName[0], 'string'));
                        $("#exceladdress_" + j).val(isNullCheck(obj[j].Address[0], 'string'));
                        $("#excelcity_" + j).val(isNullCheck(obj[j].City[0], 'string'));
                        $("#excelpincode_" + j).val(isNullCheck(obj[j].Pincode[0], 'string'));
                        $("#excelcperson_" + j).val(isNullCheck(obj[j].ContactPerson[0], 'string'));
                        $("#excelcno_" + j).val(isNullCheck(obj[j].ContactNo[0], 'string'));
                        $("#excelmobno_" + j).val(isNullCheck(obj[j].MobileNo[0], 'string'));
						$("#excelphnno_" + j).val(isNullCheck(obj[j].PhoneNo[0], 'string'));
						$("#excelemail_" + j).val(isNullCheck(obj[j].EmailId[0], 'string'));
                        $("#excelfaxno_" + j).val(isNullCheck(obj[j].FaxNo[0], 'string'));
                        $("#excelsupply_" + j).val(isNullCheck(obj[j].Supply[0], 'string'));
                        $("#excelcontract_" + j).val(isNullCheck(obj[j].Contract[0], 'string'));
                        $("#excelservice_" + j).val(isNullCheck(obj[j].Service[0], 'string'));
                        $("#excelcstno_" + j).val(isNullCheck(obj[j].CSTNo[0], 'string'));
                        $("#exceltingst_" + j).val(isNullCheck(obj[j].TINGST[0], 'string'));
                        $("#exceltinno_" + j).val(isNullCheck(obj[j].TINNo[0], 'string'));
                        $("#excelpanno_" + j).val(isNullCheck(obj[j].PANNo[0], 'string'));
                        $("#excelservicetaxno_" + j).val(isNullCheck(obj[j].ServiceTaxNo[0], 'string'));
                        $("#excelbankname_" + j).val(isNullCheck(obj[j].BankName[0], 'string'));
						$("#excelbranch_" + j).val(isNullCheck(obj[j].Branch[0], 'string'));
                        $("#excelacno_" + j).val(isNullCheck(obj[j].ACNo[0], 'string'));
                        $("#excelifsccode_" + j).val(isNullCheck(obj[j].IFSCCode[0], 'string'));
                        $("#excelregno_" + j).val(isNullCheck(obj[j].RegNo[0], 'string'));
                        $("#excelregdate_" + j).val(isNullCheck(obj[j].RegDate[0], 'string'));
                        $("#excelchquename_" + j).val(isNullCheck(obj[j].ChequeName[0], 'string'));
                        $("#excelworknautre_" + j).val(isNullCheck(obj[j].WorkNature[0], 'string'));

                        if(obj[j].VendorName[1]==1) {
                            showError($("#excelvname_" + j),'');
                        }
                        if(obj[j].Address[1]==1) {
                            showError($("#exceladdress_" + j),'');
                        }
                        if(obj[j].City[1]==1) {
                            showError($("#excelcity_" + j),'');
                        }
                        if(obj[j].Pincode[1]==1) {
                            showError($("#excelpincode_" + j),'');
                        }
                        if(obj[j].ContactPerson[1]==1) {
                            showError($("#excelcperson_" + j),'');
                        }
                        if(obj[j].ContactNo[1]==1) {
                            showError($("#excelcno_" + j),'');
                        }
                        if(obj[j].MobileNo[1]==1) {
                            showError($("#excelmobno_" + j),'');
                        }
						 if(obj[j].PhoneNo[1]==1) {
                            showError($("#excelphnno_" + j),'');
                        }
						 if(obj[j].EmailId[1]==1) {
                            showError($("#excelemail_" + j),'');
                        }
                        if(obj[j].FaxNo[1]==1) {
                            showError($("#excelfaxno_" + j),'');
                        }
                        if(obj[j].Supply[1]==1) {
                            showError($("#excelsupply_" + j),'');
                        }
                        if(obj[j].Contract[1]==1) {
                            showError($("#excelcontract_" + j),'');
                        }
                        if(obj[j].Service[1]==1) {
                            showError($("#excelservice_" + j),'');
                        }
                        if(obj[j].CSTNo[1]==1) {
                            showError($("#excelcstno_" + j),'');
                        }
                        if(obj[j].TINGST[1]==1) {
                            showError($("#exceltingst_" + j),'');
                        }
                        if(obj[j].TINNo[1]==1) {
                            showError($("#exceltinno_" + j),'');
                        }
                        if(obj[j].PANNo[1]==1) {
                            showError($("#excelpanno_" + j),'');
                        }
                        if(obj[j].ServiceTaxNo[1]==1) {
                            showError($("#excelservicetaxno_" + j),'');
                        }
                        if(obj[j].BankName[1]==1) {
                            showError($("#excelbankname_" + j),'');
                        }
                        if(obj[j].Branch[1]==1) {
                            showError($("#excelbranch_" + j),'');
                        }
                        if(obj[j].ACNo[1]==1) {
                            showError($("#excelacno_" + j),'');
                        }
                        if(obj[j].IFSCCode[1]==1) {
                            showError($("#excelifsccode_" + j),'');
                        }
                        if(obj[j].RegNo[1]==1) {
                            showError($("#excelregno_" + j),'');
                        }
                        if(obj[j].RegDate[1]==1) {
                            showError($("#excelregdate_" + j),'');
                        }
                        if(obj[j].ChequeName[1]==1) {
                            showError($("#excelchquename_" + j),'');
                        }
                        if(obj[j].WorkNature[1]==1) {
                            showError($("#excelworknautre_" + j),'');
                        }
                    }
                    $('#rowCount').val(parseInt(obj.length)-1);
                    $('#can_button').html('Discard').attr('data-original-title','Discard');
                    $('#app_button').html('Correct');
                    $("#excelmodal").modal('show');
                    setTimeout(function() { $("body").addClass('modal-open');}, 200);

                } else {
                    alert("Details Import Successful");
                    $('#table_bind').html('');
                    $("#excelmodal").modal('hide');
                    location.reload();
                }

            },
            error: function (jqXHR, textStatus, errorThrown) {
                if (jqXHR.status == 400)
                    alert(jqXHR.responseText);
                else
                    alert("Request Failed");
            }
        });
    }
    function deleteRow(val){
        var rId = $(val).attr('id');
        rId = rId.split('_')[1];
        if (confirm('Do you want to Delete')) {
            $('#excelrowid_'+rId).remove();
        }
    }
</script>

<script type="text/javascript">
    $('.cnt_slider .carousel').carousel({
        interval: false
    })
    $(function() {
        $(window).keydown(function(event){
            if(event.keyCode == 13) {
                event.preventDefault();
                return false;
            }
        });

        $('#current_emails').text($('#description').val());
        $('#description').multiple_emails();
        $('#description').change( function(){
            $('#current_emails').text($(this).val());
        });

        $frmPost = $('#frmPost');

        $frmPost.on('submit', function () {
            var $emailIds = $('.email_name');
            $.each($emailIds, function() {
                $frmPost.append('<input type="hidden" name="emails[]" value="'+$(this).html()+'"/>');
            });
        });
    });
</script>


