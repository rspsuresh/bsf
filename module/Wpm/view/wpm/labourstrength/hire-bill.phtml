<link rel="stylesheet" href="<?php echo $this->basePath().'/css/workorder.css'; ?>" />
<link rel="stylesheet" href="<?php echo $this->basePath().'/css/wpm.css'; ?>" />
<style>
    .panel 			{border-radius:0px !important;}
    .panel-info 	{border:none;border-top:none;}
    .table-fixed tbody{height:400px;overflow-y:auto;width:100%}
    .table-fixed thead,.table-fixed tbody,.table-fixed tr,.table-fixed td,.table-fixed th{display:block}
    .table-fixed tbody td,.table-fixed thead>tr>th{float:left; border-bottom:0;position:relative;text-overflow:ellipsis;overflow:hidden;display:inline-block;white-space:nowrap}
    .pl-mi{left:0; right:inherit}
    .ad-btn {
        background: #3399ff none repeat scroll 0 0;
        border-radius: 50%;
        box-shadow: 0 0 0 2px #fff, 0 0 0 3px #3399ff;
        color: #fff;
        height: 25px;
        padding-top: 2px;
        /*position: absolute;*/
        float:right;
        right: 4px;
        text-align: center;
        text-shadow: 0 0 1px #546082;
        width: 25px;
    }
</style>
<div class="content_wrapper padlr0">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12">
                <h1 id="titleTag" class="text-center">Hire Bill</h1>
            </div>
            <form method="post" id="formWrapper">
                <div id="stageTwo" style="">
                    <input type="hidden" id="costCentreId" name="costCentreId" value="<?php if(isset($ccId)){echo $ccId;}elseif(isset($hbRegister)){echo $hbRegister['CostCentreId'];}else{echo '';} ?>" />
                    <input type="hidden" id="vendorId" name="vendorId" value="<?php if(isset($venId)){echo $venId;}elseif(isset($hbRegister)){echo $hbRegister['VendorId'];}else{echo '';} ?>" />
                    <input type="hidden" id="eHireTypeId" name="eHireTypeId" value="<?php if(isset($hireType)){echo $hireType['HireTypeId'];}elseif(isset($hbRegister)){echo $hbRegister['HireTypeId'];}else{echo '';} ?>" />
                    <input type="hidden" id="hoRegId" name="hoRegId" value="<?php if(isset($hrId)){echo $hrId;}elseif(isset($hbRegister)){echo $hbRegister['HORegisterId'];}else{echo '';} ?>" />
                    <input type="hidden" name="companyId" id="companyId" value="<?php echo (isset($costCentre)) ? $costCentre['CompanyId'] : ''; ?>">
                    <div class="col-lg-12">
                        <div class="col-lg-4 col-lg-offset-0 col-md-6 col-md-offset-0 col-sm-6 col-sm-offset-0 col-xs-12 col-xs-offset-0">
                            <div class="panel-box zoomIn animated">
                                <ul>
                                    <li>
                                        <label>Cost Centre</label>
                                        <span class="hprojName"><?php if(isset($costCentre)){echo $costCentre['CostCentreName'];}elseif(isset($hbRegister)){echo $hbRegister['CostCentreName'];}else{echo '';} ?></span>
                                    </li>
                                    <li>
                                        <label>Contractor</label>
                                        <span class="hconName"><?php if(isset($vendor)){echo $vendor['VendorName'];}elseif(isset($hbRegister)){echo $hbRegister['VendorName'];}else{echo '';} ?></span>
                                    </li>
                                    <li>
                                        <label>Hire Type</label>
                                        <span class="hhtName"><?php if(isset($hireType)){echo $hireType['HireTypeName'];}elseif(isset($hbRegister)){echo $hbRegister['HireTypeName'];}else{echo '';} ?></span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-4 col-lg-offset-0 col-md-6 col-md-offset-0 col-sm-6 col-sm-offset-0 col-xs-12 col-xs-offset-0">
                            <div class="panel-box box2th zoomIn animated">
                                <ul>
                                    <li>
                                        <label>Hire Bill Date</label>
                                        <span><input type="text" id="hbDate" name="hbDate" class="date_picker" value="<?php if($hbRegister != '') { echo date("d-m-Y", strtotime($hbRegister['HBDate'])); } else { echo date("d-m-Y"); } ?>" readonly /></span>
                                    </li>
                                    <li>
                                        <label>Ref Date</label>
                                        <span><input type="text" id="refDate" name="refDate" class="date_picker" value="<?php if($hbRegister != '') { echo date("d-m-Y", strtotime($hbRegister['RefDate'])); } else { echo date("d-m-Y"); } ?>" readonly /></span>
                                    </li>
                                    <li>
                                        <label>From Date</label>
                                        <span><input type="text" id="fromDate" name="fromDate" class="date_picker" value="<?php if($hbRegister != '') { echo date("d-m-Y", strtotime($hbRegister['FromDate'])); } else { echo date("d-m-Y"); } ?>" readonly /></span>
                                    </li>
                                    <li>
                                        <label>To Date</label>
                                        <span><input type="text" id="toDate" name="toDate" class="date_picker" value="<?php if($hbRegister != '') { echo date("d-m-Y", strtotime($hbRegister['ToDate'])); } else { echo date("d-m-Y"); } ?>" readonly /></span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-4 col-lg-offset-0 col-md-6 col-md-offset-0 col-sm-6 col-sm-offset-0 col-xs-12 col-xs-offset-0">
                            <div class="panel-box box3th zoomIn animated">
                                <ul>
                                    <li>
                                        <label>Hire Bill No</label>
                                        <span><input type="text" id="hbNo" name="hbNo" value="<?php  if($hbRegister != '') { echo trim($hbRegister['HBNo']); } else { echo ($genType) ? trim($hbNo) : ''; } ?>" readonly /></span>
                                    </li>
                                    <li>
                                        <label>CC Hire Bill No</label>
                                        <span><input type="text" id="ccHbNo" name="ccHbNo" value="<?php if(isset($hbRegister) && trim($hbRegister['HBCCNo']) != '') { echo $hbRegister['HBCCNo']; } else { echo ''; } ?>" /></span>
                                    </li>
                                    <li>
                                        <label>Comp Hire Bill No</label>
                                        <span><input type="text" id="compHbNo" name="compHbNo" value="<?php if(isset($hbRegister) && trim($hbRegister['HBCompNo']) != '') { echo $hbRegister['HBCompNo']; } else { echo ''; } ?>" /></span>
                                    </li>
                                    <li>
                                        <label>Ref No</label>
                                        <span><input type="text" id="refNo" name="refNo" value="<?php if(isset($genType)) { echo trim($hbNo); } elseif(isset($hbRegister)){echo trim($hbRegister['RefNo']);}else{echo '';} ?>" /></span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="slic">
                        <ul>
                            <li class="face"><a href="#"></a></li>
                            <li><a href="#"></a></li>
                            <li><a href="#"></a></li>
                        </ul>
                    </div>
                    <div class="clearfix"></div>
                    <div class="col-lg-12 clear top-20">
                        <a id="labourtypePickList" href="javascript:void(0);" onclick="showPickList()" class="ad-btn" data-original-title="Labour Strength PickList" data-placement="left" data-toggle="tooltip"><i class="fa fa-plus"></i></a>
                        <div id="accordion" class="panel-group">
                            <div class="panel panel-info">
                                <div data-target="#collapseOne" data-parent="#accordion" data-toggle="collapse" class="panel-heading collapsed panel_heads" id="panelheading-1">
                                    <h4 class="panel-title accordion-toggle defa_panels hhtName">&nbsp;
                                        <?php if(isset($hireType)){echo $hireType['HireTypeName'];}elseif(isset($hbRegister)){echo $hbRegister['HireTypeName'];}else{echo '';} ?>
                                    </h4>
                                </div>
                                <div class="error_message selOne" style="padding-right: 20px;"><p>please enter atleast one entry...</p></div>
                                <div class="panel-collapse collapse" id="collapseOne" style="height: 0px;">
                                    <div class="panel-body bgcolr">
                                        <div class="col-lg-12 animated fadeInUp" style="margin-bottom:10px;">
                                            <div class="table-responsive top-30">
                                                <table class="table" style="margin-bottom:0px;" id="hireTable">
                                                    <thead>
                                                    <tr>
                                                        <th>Description</th>
                                                        <th>Unit</th>
                                                        <th class="text-right">Qty</th>
                                                        <th class="hideColumns">Working Qty</th>
                                                        <th class="hideColumns">Working Unit</th>
                                                        <th class="hideColumns text-right">Total Qty</th>
                                                        <th class="text-right">Rate</th>
                                                        <th class="text-right">Amount</th>
                                                        <th>&nbsp;</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    <?php
                                                    if(isset($hbHireTrans) && count($hbHireTrans) != 0) {
                                                        $i = 1;
                                                        foreach($hbHireTrans as $hbTrans) {
                                                            ?>
                                                            <tr>
                                                                <td width="30%">
                                                                    <input class="parent_text hireSuggest" type="text" name="hireName_<?php echo $i; ?>" id="hireName_<?php echo $i; ?>" onfocus="return checkHBUsed(this);" value="<?php echo $hbTrans['ResourceName']; ?>" readonly />
                                                                    <input type="hidden" name="hireId_<?php echo $i; ?>" id="hireId_<?php echo $i; ?>" value="<?php echo $hbTrans['ResourceId']; ?>" />
                                                                </td>
                                                                <td width="15%">
                                                                    <input type="hidden" name="unitId_<?php echo $i; ?>" id="unitId_<?php echo $i; ?>" value="<?php echo $hbTrans['UnitId']; ?>" />
                                                                    <input class="parent_text" type="text" name="unitName_<?php echo $i; ?>" id="unitName_<?php echo $i; ?>" value="<?php echo $hbTrans['UnitName']; ?>" readonly />
                                                                </td>
                                                                <td width="15%"><input class="parent_text text-right" type="text" name="qty_<?php echo $i; ?>" id="qty_<?php echo $i; ?>" value="<?php echo $hbTrans['Qty']; ?>" onblur="return FormatNum(this, 3),checkqty(this,'a')" onclick="qtyClick(this,'a')"  onkeypress="return isDecimal(event,this);" onchange="return calAmount('<?php echo $i; ?>','r');" />
                                                                    <div style="position: relative; display:none;" id="wfirst_<?php echo $i; ?>">
                                                                        <div class="top-tip top-addtip"style="background-color:#506faf ! important;margin-left:-43px ! important;top:-86px !important;width:140px !important;height:44px !important; ">
                                                                            <span style="color:white;text-align:left">EstimateQty:<?php echo $hbTrans['eQty'];?></span>
                                                                        </div>
                                                                    </div>
                                                                </td>
                                                                <td class="hideColumns"><input class="parent_text text-right" type="text" name="workingQty_<?php echo $i; ?>" id="workingQty_<?php echo $i; ?>" value="<?php echo $hbTrans['WorkingQty']; ?>" onclick="qtyClick(this,'b')" onblur="return FormatNum(this, 3),checkqty(this,'b')" onkeypress="return isDecimal(event,this);" onchange="return calAmount('<?php echo $i; ?>','r');" />
                                                                    <div style="position: relative; display:none;" id="wQfirst_<?php echo $i; ?>">
                                                                        <div class="top-tip top-addtip"style="background-color:#506faf ! important;margin-left:-43px ! important;top:-86px !important;width:140px !important;height:44px !important; ">
                                                                            <span style="color:white;text-align:left">EstimateQty:<?php echo $hbTrans['eQty'];?></span>
                                                                        </div>
                                                                    </div>
                                                                </td>
                                                                <td class="hideColumns">
                                                                    <div class="select-style">
                                                                        <select class="parent_text " name="workingUnitId_<?php echo $i; ?>" id="workingUnitId_<?php echo $i; ?>">
                                                                            <option value="0"></option>
                                                                            <?php foreach($workingUnits as $wou) { ?>
                                                                                <option value="<?php echo $wou['UnitId']; ?>" <?php if($hbTrans['WorkingUnitId']==$wou['UnitId']) { ?>selected<?php } ?>><?php echo $wou['UnitName']; ?></option>
                                                                            <?php } ?>
                                                                        </select>
                                                                    </div>
                                                                </td>
                                                                <td class="hideColumns"><input class="parent_text text-right" type="text" name="totalQty_<?php echo $i; ?>" id="totalQty_<?php echo $i; ?>" value="<?php echo $hbTrans['TotalQty']; ?>" onblur="return FormatNum(this, 3)" readonly /></td>
                                                                <td width="15%"><input class="parent_text text-right" type="text" name="rate_<?php echo $i; ?>" id="rate_<?php echo $i; ?>" value="<?php echo $hbTrans['Rate']; ?>" onclick="qtyClick(this,'c')" onkeypress="return isDecimal(event,this);" onblur="return FormatNum(this, 2),checkqty(this,'c')"  onchange="return calAmount('<?php echo $i; ?>','r');" />
                                                                    <div style="position: relative; display:none;" id="wrfirst_<?php echo $i; ?>">
                                                                        <div class="top-tip top-addtip"style="background-color:#506faf ! important;margin-left:-43px ! important;top:-86px !important;width:140px !important;height:44px !important; ">
                                                                            <span style="color:white;text-align:left">EstimateRate:<?php echo $hbTrans['eRate'];?></span>
                                                                        </div>
                                                                    </div>
                                                                </td>                                                                <td width="20%"><input class="parent_text text-right" type="text" name="amount_<?php echo $i; ?>" id="amount_<?php echo $i; ?>" value="<?php echo $hbTrans['Amount']; ?>" onblur="return FormatNum(this, 2)" readonly /></td>
                                                                <td width="5%" align="center" class="action_btns_td">
                                                                    <ul class="action_btns">
                                                                        <li><a href="javascript:void(0);" class="hireDelete_<?php echo $i; ?>" id="deleteTr_<?php echo $i; ?>" onclick="deleteHireRow(this, event);"><i class="fa fa-trash-o" data-toggle="tooltip" data-placement="top" data-original-title="Delete"></i></a></li>
                                                                    </ul>
                                                                </td>
                                                                <td></td>
                                                            </tr>
                                                            <?php   $i++;
                                                        }
                                                    } else { ?>
                                                        <tr>
                                                            <td width="30%">
                                                                <input class="parent_text hireSuggest" type="text" name="hireName_1" id="hireName_1" onfocus="return checkHBUsed(this);" />
                                                                <input type="hidden" name="hireId_1" id="hireId_1" />
                                                            </td>
                                                            <td width="15%">
                                                                <input type="hidden" name="unitId_1" id="unitId_1" />
                                                                <input class="parent_text" type="text" name="unitName_1" id="unitName_1" readonly />
                                                            </td>
                                                            <td width="15%"><input class="parent_text text-right" type="text" name="qty_1" id="qty_1" onblur="return FormatNum(this, 3),checkqty(this,'a')" onkeypress="return isDecimal(event,this);" onclick="qtyClick(this,'a')"  onchange="return calAmount('1','r');" />
                                                                <div style="position: relative; display:none;" id="wfirst_1">
                                                                    <div class="top-tip top-addtip"style="background-color:#506faf ! important;margin-left:-43px ! important;top:-86px !important;width:140px !important;height:44px !important; ">
                                                                        <span style="color:white;text-align:left">EstimateQty:<i id='workSet_1' style="color:white"></i></span>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td class="hideColumns"><input class="parent_text text-right" type="text" name="workingQty_1" id="workingQty_1" onclick="qtyClick(this,'b')" onblur="return FormatNum(this, 3),checkqty(this,'b')" onkeypress="return isDecimal(event,this);" onchange="return calAmount('1','r');" />
                                                                <div style="position: relative; display:none;" id="wQfirst_1">
                                                                    <div class="top-tip top-addtip"style="background-color:#506faf ! important;margin-left:-43px ! important;top:-86px !important;width:140px !important;height:44px !important; ">
                                                                        <span style="color:white;text-align:left">EstimateQty:<i id='workingSet_1' style="color:white"></i></span>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td class="hideColumns">
                                                                <div class="select-style">
                                                                    <select class="parent_text" name="workingUnitId_1" id="workingUnitId_1">
                                                                        <option value="0"></option>
                                                                        <?php foreach($workingUnits as $wou) { ?>
                                                                            <option value="<?php echo $wou['UnitId']; ?>"><?php echo $wou['UnitName']; ?></option>
                                                                        <?php } ?>
                                                                    </select>
                                                                </div>
                                                            </td>
                                                            <td class="hideColumns"><input class="parent_text text-right" type="text" name="totalQty_1" id="totalQty_1" onblur="return FormatNum(this, 3)" readonly /></td>
                                                            <td width="15%"><input class="parent_text text-right" type="text" name="rate_1" id="rate_1" onclick="qtyClick(this,'c')" onblur="return FormatNum(this, 2),checkqty(this,'c')" onkeypress="return isDecimal(event,this);" onchange="return calAmount('1','r');" />
                                                                <div style="position: relative; display:none;" id="wrfirst_1">
                                                                    <div class="top-tip top-addtip"style="background-color:#506faf ! important;margin-left:-43px ! important;top:-86px !important;width:140px !important;height:44px !important; ">
                                                                        <span style="color:white;text-align:left">EstimateRate:<i id='rateSet_1' style="color:white"></i></span>
                                                                    </div>
                                                                </div>
                                                            </td>                                                            <td width="20%"><input class="parent_text text-right" type="text" name="amount_1" id="amount_1" onblur="return FormatNum(this, 2)" readonly /></td>
                                                            <td width="5%" align="center" class="action_btns_td">
                                                                <ul class="action_btns">
                                                                    <li><a href="javascript:void(0);" class="hireDelete_1" id="deleteTr_1" onclick="deleteHireRow(this, event);" style="display:none;"><i class="fa fa-trash-o" data-toggle="tooltip" data-placement="top" data-original-title="Delete"></i></a></li>
                                                                </ul>
                                                            </td>

                                                        </tr>
                                                    <?php } ?>
                                                    <tr class="total">
                                                        <td class="colspanId" colspan="5">&nbsp;</td>
                                                        <td align="right" colspan="2" class="rate_pri">Base Amount</td>
                                                        <td width="20%"><input class="parent_text text-right bold-text-clr" type="text" name="totalAmount" id="totalAmount" onblur="return FormatNum(this, 2)" onchange="myfunc($(this).val())" readonly  /></td>
                                                        <td width="5%">&nbsp;</td>

                                                    </tr>
                                                    <tr>
                                                        <td style="border-top:none !important" class="colspanId" colspan="5">&nbsp;</td>
                                                        <td colspan="2" style="border-right:none;border-top:none;" align="right" class="rate_pri"><label style="font-weight:300">Qualifier Amount</label></td>
                                                        <td style="border-right:none;border-top:none;"><input class="parent_text text-right total-clr" type="text" placeholder="00.0" name="qualAmt" id="qualAmt" onblur="return FormatNum(this, 2, true)" value="<?php echo (isset($soRegister)) ? $soRegister['QualifiedAmount'] : '';?>" readonly/></td>
                                                        <td style="border-right:none;border-top:none;">
                                                            <ul class="action_btns">
                                                                <li>
                                                                    <a href="#" class="qualTr">
                                                                        <span data-original-title="Expand" data-placement="left" data-toggle="tooltip"><i class="fa fa-chevron-circle-down"></i></span>
                                                                    </a>
                                                                </li>
                                                            </ul>
                                                        </td>

                                                    </tr>
                                                    <tr style="display:none;" class="qualmainTr">
                                                        <td colspan="10" style="padding:0px !important; ">
                                                            <div class="subDiv" style="display:none;overflow-y:scroll; min-height:100%; max-height:250px;">
                                                                <?php echo $qualRHtml;?>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <input type="hidden" name="rowid" id="rowid" value="0"/>
                                                    <input type="hidden" name="deleteids" id="deleteids" value="0"/>
                                                    <tr>
                                                        <td style="border-top:none !important" class="colspanId" colspan="5">&nbsp;</td>
                                                        <td colspan="2" style="border-right:none;border-top:none;" align="right" class="rate_pri"><label style="font-weight:300">Bill Recovery</label></td>
                                                        <td style="border-right:none;border-top:none;">
                                                            <input class="parent_text text-right total-clr" id="recoveryHireBill" name="recoveryHireBill" type="text" onkeypress="return isDecimal(event,this);" onblur="return FormatNum(this, 2, true)"  readonly/></td>
                                                        <td style="border-right:none;border-top:none;">
                                                            <ul class="action_btns">
                                                                <li>
                                                                    <a href="#" class="qualTr">
                                                                        <span data-original-title="Expand" data-placement="left" data-toggle="tooltip"><i class="fa fa-chevron-circle-down"></i></span>
                                                                    </a>
                                                                </li>
                                                            </ul>
                                                        </td>
                                                    </tr>
                                                    <tr style="display:none;" class="qualmainTr">
                                                        <td colspan="10" style="padding:0px !important; ">
                                                            <div class="subDiv" style="display:none;margin-left:5px">
                                                                <table class="table table-fixed" style=" margin-bottom:0px;">
                                                                    <thead>
                                                                    <tr class="col-xs-12" style="padding:0 !important">
                                                                        <th class="red-ths col-xs-5" width="45%">Recovery type name</th>
                                                                        <th class="red-ths col-xs-3" width="30%">Account</th>
                                                                        <th class="red-ths col-xs-3" width="25%" style="text-align:right">Amount</th>
                                                                        <th class="red-ths col-xs-1" width="5%">&nbsp;</th>
                                                                    </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                    <?php
                                                                    if(isset($recoveryTypes) && count($recoveryTypes) != 0) {
                                                                        $i = 1;
                                                                        foreach($recoveryTypes as $recoveryType) {
                                                                            ?>
                                                                            <tr class="col-xs-12" style="padding:0 !important">
                                                                                <td class="col-xs-5" width="30%">
                                                                                    <input class="parent_text " type="text" name="recoveryName_<?php echo $i; ?>" id="recoveryName_<?php echo $i; ?>"  value="<?php echo $recoveryType['RecoveryTypeName']; ?>" readonly />
                                                                                    <input type="hidden" name="recoveryId_<?php echo $i; ?>" id="recoveryId_<?php echo $i; ?>" value="<?php echo $recoveryType['RecoveryTypeId']; ?>" />
                                                                                </td>
                                                                                <td class="col-xs-3">
                                                                                    <input type="text" class="parent_text" class="parent_text" id="recoveryAccount_<?php echo $i; ?>" name="recoveryAccount_<?php echo $i; ?>" onkeypress="return bindAccountHeadAutoComplete(this);"/>
                                                                                    <input type="hidden" id="recoveryAccountId_<?php echo $i; ?>" name="recoveryAccountId_<?php echo $i; ?>"/>
                                                                                    <!--                                                                                            <option value="">none</option>-->
                                                                                    <!--                                                                                            --><?php //foreach($recoveryAccounts as $recoveryAccount) { ?>
                                                                                    <!--                                                                                                <option value="--><?php //echo $recoveryAccount['AccountId']; ?><!--">--><?php //echo $recoveryAccount['AccountName']; ?><!--</option>-->
                                                                                    <!--                                                                                            --><?php //} ?>
                                                                                    <!--                                                                                        </select>-->
                                                                                </td>
                                                                                <td class="col-xs-3" style="position:relative;padding-right:0 !important"align="right">
                                                                                    <input class="parent_text text-right amtCh" name="recoveryAmount_<?php echo $i; ?>"  id="recoveryAmount_<?php echo $i; ?>" type="text" onkeypress="return isDecimal(event,this);" onchange="return recoveryTotAmt(this);" onblur="return FormatNum(this, 2, true)" ></td>
                                                                                <input type="hidden" name="hiddenRecoveryAmount_<?php echo $i; ?>" id="hiddenRecoveryAmount_<?php echo $i; ?>"  />

                                                                                <td class="col-xs-1" style=" overflow: visible;">
																 <span class="pl-mi"align="center">
                                                                                    <?php if($recoveryType['RecoveryTypeId'] == 1 || $recoveryType['RecoveryTypeId'] == 2 || $recoveryType['RecoveryTypeId'] == 3 || $recoveryType['RecoveryTypeId'] == 4) {?>
                                                                                        <i class="fa fa-minus clr-red"></i>
                                                                                    <?php } else if($recoveryType['RecoveryTypeId'] == 5 || $recoveryType['RecoveryTypeId'] == 6 || $recoveryType['RecoveryTypeId'] == 7){ ?>
                                                                                        <i class="fa fa-minus clr-red" id="recoverySpanId_<?php echo $i; ?>" onclick = "recoverySignChange(this);" ></i>
                                                                                    <?php }?>
                                                                                </span>
                                                                                    <input type="hidden" id="recoverySign_<?php echo $i; ?>" value="-" name="recoverySign_<?php echo $i; ?>">

                                                                                    <ul class="action_btns">
                                                                                        <li style="float:right !important">
                                                                                            <a class="mainTr" href="#">
                                                                                                <i class="fa fa-chevron-circle-down tform" data-toggle="tooltip" data-placement="left" data-original-title="Expand"></i></a></li>
                                                                                    </ul></td>
                                                                            </tr>
                                                                            <tr class="subTr col-xs-12" style="display:none;padding:0 !important">
                                                                                <td colspan="8"class="col-md-12" style="padding:0px !important; ">
                                                                                    <div class="subDiv col-xs-12" style="display: block !important;padding:10px 0 0 0 !important;margin-left:8px">
                                                                                        <div class="col-lg-12">
                                                                                            <div class="table-responsive topsp">
                                                                                                <table class="table table-fixed" style="margin-bottom:0px;">
                                                                                                    <thead>
                                                                                                    <?php if($recoveryType['RecoveryTypeId']==7) {?>
                                                                                                        <tr class="col-xs-12" style="padding:0 !important">
                                                                                                            <th class="red-ths col-xs-1" > Date</th >
                                                                                                            <th class="red-ths col-xs-1" > Ref No .</th >
                                                                                                            <th class="red-ths col-xs-2" > Adv . Type</th >
                                                                                                            <th class="red-ths col-xs-2" style = "text-align:right" > Total Adv.</th>
                                                                                                            <th class="red-ths col-xs-2" style = "text-align:right" > Recovered Amt </th>
                                                                                                            <th class="red-ths col-xs-2" style = "text-align:right" > Balance Amt </th>
                                                                                                            <th class="red-ths col-xs-2" style = "text-align:right" > Current Amt </th
                                                                                                        </tr>
                                                                                                    <?php  }elseif($recoveryType['RecoveryTypeId']==3) {
                                                                                                        ?>
                                                                                                        <tr class="col-xs-12" style="padding:0 !important">
                                                                                                            <th class="red-ths col-xs-2" style = "text-align:right" > Mob Advance</th >
                                                                                                            <th class="red-ths col-xs-2" style = "text-align:right" > Adhoc Advance .</th >
                                                                                                            <th class="red-ths col-xs-2" style = "text-align:right" > Total Advance</th >
                                                                                                            <th class="red-ths col-xs-3" style = "text-align:right" >Recovery</th >
                                                                                                            <th class="red-ths col-xs-3" style = "text-align:right" > Balance </th >
                                                                                                        </tr>
                                                                                                    <?php }
                                                                                                    ?>
                                                                                                    </thead>
                                                                                                    <tbody class="main">
                                                                                                    <?php if($recoveryType['RecoveryTypeId']==7) {?>
                                                                                                        <tr class="col-xs-12" style="padding:0 !important">
                                                                                                            <td class="col-xs-1"><input type="text" class="parent_text text-right" /></td>
                                                                                                            <td class="col-xs-1"><input type="text" class="parent_text text-right" /></td>
                                                                                                            <td class="col-xs-2"><input type="text" class="parent_text text-right" /></td>
                                                                                                            <td class="col-xs-2"><input type="text" class="parent_text text-right" /></td>
                                                                                                            <td class="col-xs-2"><input type="text" class="parent_text text-right" /></td>
                                                                                                            <td class="col-xs-2"><input type="text" class="parent_text text-right" /></td>
                                                                                                            <td class="col-xs-2"><input type="text" class="parent_text text-right" /></td>
                                                                                                        </tr>
                                                                                                    <?php } elseif($recoveryType['RecoveryTypeId']==3) {
                                                                                                        if(isset($advRecv) && count($advRecv) != 0) {
                                                                                                            foreach($advRecv as $advRec) {
                                                                                                                ?>
                                                                                                                <tr class="col-xs-12" style="padding:0 !important">
                                                                                                                    <td class="col-xs-2"><input type="text" class="parent_text text-right" value="<?php echo $this->commonHelper()->sanitizeNumber($advRec['MobAdvance'],2),0;?>" readonly/></td>
                                                                                                                    <td class="col-xs-2"><input type="text" class="parent_text text-right" value="<?php echo $this->commonHelper()->sanitizeNumber($advRec['CashAdvance'],2),0;?>" readonly/></td>
                                                                                                                    <td class="col-xs-2"><input type="text" class="parent_text text-right" value="<?php echo $this->commonHelper()->sanitizeNumber($advRec['TotalAdvance'],2),0;?>" readonly/></td>
                                                                                                                    <td class="col-xs-3"><input type="text" class="parent_text text-right" value="<?php echo $this->commonHelper()->sanitizeNumber($advRec['Recovery'],2),0;?>" readonly/></td>
                                                                                                                    <td class="col-xs-3"><input type="text" id="balAdv" class="parent_text text-right" value="<?php echo $this->commonHelper()->sanitizeNumber($advRec['Balance'],2),0;?>" readonly/></td>
                                                                                                                </tr>
                                                                                                            <?php } }} ?>
                                                                                                    </tbody>
                                                                                                    <!--                                                                            <tbody class="total">-->
                                                                                                    <!--                                                                            <tr class="col-xs-12" style="padding:0 !important">-->
                                                                                                    <!--                                                                                <td class="col-xs-5" colspan="4">&nbsp;</td>-->
                                                                                                    <!--                                                                                <td class="rate_pri col-xs-5" align="right">Total</td>-->
                                                                                                    <!--                                                                                <td class="col-xs-2"colspan="2" width="10%"><input class="parent_text text-right total-clr" readonly="" type="text"></td>-->
                                                                                                    <!--                                                                            </tr>-->
                                                                                                    <!--                                                                            </tbody>-->
                                                                                                </table>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </td>
                                                                            </tr>
                                                                            <?php   $i++;
                                                                        }
                                                                    }?>

                                                                    <tr class="dont-hide col-xs-12" style="padding:0 !important">
                                                                        <td class="col-xs-5"colspan="1"> </td>
                                                                        <td class="rate_pri col-xs-3" align="right">Total</td>
                                                                        <td class="col-xs-3" colspan="1" width="8%">
                                                                            <input class="parent_text text-right total-clr" name="recoveryTotal" id="recoveryTotal" onkeypress="return isDecimal(event,this);" onblur="return FormatNum(this, 2, true)"  type="text" readonly>
                                                                        </td>
                                                                        <td class="col-xs-1"></td>
                                                                    </tr>
                                                                    </tbody>
                                                                </table>
                                                                <input type="hidden" name="recoveryRows" id="recoveryRows" value="<?php echo (isset($recoveryTypes) && count($recoveryTypes) != 0) ? count($recoveryTypes) : 1; ?>" />
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td  style="border-top:none !important" class="colspanId" colspan="5">&nbsp;</td>
                                                        <td colspan="2" style="border-right:none;border-top:none;" align="right" class="rate_pri"><label id="rateanal__1_lbltotrate" style="font-weight:300">Net Amount</label></td>
                                                        <td style="border-right:none;border-top:none;"><input class="parent_text text-right total-clr" type="text" placeholder="00.0" name="totAmount" id="totAmount" onblur="return FormatNum(this, 2, true)" value="<?php echo (isset($soRegister)) ? $soRegister['NetAmount'] : '';?>" readonly/></td>
                                                        <td style="border-right:none;border-top:none;">&nbsp;</td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                                <input type="hidden" name="hireRows" id="hireRows" value="<?php echo (isset($hbHireTrans) && count($hbHireTrans) != 0) ? count($hbHireTrans) : 1; ?>" />
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <!--div class="col-lg-6 col-lg-offset-0 col-md-6 col-md-offset-0 col-sm-6 col-sm-offset-0 col-xs-12 col-xs-offset-0">
                        <div class="form-group">
                            <label>Specification</label>
                            <textarea class="col-lg-12" id="specification" name="specification"><?php if(isset($hbRegister) && $hbRegister!= '') { echo ''; } else { echo ''; } ?></textarea>
                        </div>
                    </div--->
                                <div class="col-lg-12 col-lg-offset-0 col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0">
                                    <div  class="col-md-12" style="padding:0 !important;margin-top:30px">
                                        <textarea  class="lbl_move" style="width:100%; border:1px solid #ddd; height:80px !important;" label="Narration" id="narration" name="narration"> <?php if($hireBillId != 0) { echo $hbRegister['Narration']; } else { echo ''; } ?></textarea>
                                    </div>
                                </div>
            </form>
            <div id="submitDiv" class="col-lg-12 savebtn_area" style="">
                <ul>
                    <li class="dropdown save_btn float_r"><a href="javascript:void(0);" data-toggle="tooltip" class="ripple" title="Submit" onclick="return submitForm();">Submit</a>
                        <?php if($hireBillId != 0){?>
                    <li class="cancel_btn cancel_btn_bluecolor float_l"><a href="<?php echo $this->basePath() . '/wpm/workorder/bill-register';?>" class="ripple">Cancel <i class="fa fa-times-circle-o" aria-hidden="true"></i></a></li>
                    <?php }else{?>
                        <li class="cancel_btn float_r"><a href="<?php echo $this->basePath(); ?>/wpm/workbill/index" class="ripple" title="Go back!" onclick="return showBack('a');">Back</a></li>
                    <?php }?>
                </ul>
            </div>
        </div>
    </div>
</div>
<div class="clearfix"></div>
</div>
<table id="dummy-hire-row" style="display:none;">
    <tbody>
    <tr>
        <td width="30%">
            <input class="parent_text hireSuggest" type="text" name="hireName__1" id="hireName__1" onfocus="return checkHBUsed(this);" />
            <input type="hidden" name="hireId__1" id="hireId__1" />
        </td>
        <td width="15%">
            <input type="hidden" name="unitId__1" id="unitId__1" />
            <input class="parent_text" type="text" name="unitName__1" id="unitName__1" readonly />
        </td>
        <td width="15%"><input class="parent_text text-right" type="text" name="qty__1" id="qty__1" onblur="return FormatNum(this, 3),checkqty(this,'a')" onkeypress="return isDecimal(event,this);" onchange="return calAmount('__1','d');" onclick="qtyClick(this,'a')" />
            <div style="position: relative; display:none;" id="wfirst__1">
                <div class="top-tip top-addtip"style="background-color:#506faf ! important;margin-left:-43px ! important;top:-86px !important;width:140px !important;height:44px !important; ">
                    <span style="color:white;text-align:left">EstimateQty:<i id='workSet__1' style="color:white"></i></span>
                </div>
            </div>
        </td>
        <td class="hideColumns"><input class="parent_text text-right" type="text" name="workingQty__1" id="workingQty__1" onclick="qtyClick(this,'b')" onblur="return FormatNum(this, 3),checkqty(this,'b')" onkeypress="return isDecimal(event,this);" onchange="return calAmount('__1','d');" />
            <div style="position: relative; display:none;" id="wQfirst__1">
                <div class="top-tip top-addtip"style="background-color:#506faf ! important;margin-left:-43px ! important;top:-86px !important;width:140px !important;height:44px !important; ">
                    <span style="color:white;text-align:left">EstimateQty:<i id='workingSet__1' style="color:white"></i></span>
                </div>
            </div>
        </td>
        <td class="hideColumns">
            <div class="select-style">
                <select class="parent_text" name="workingUnitId__1" id="workingUnitId__1">
                    <option value="0"></option>
                    <?php foreach($workingUnits as $wou) { ?>
                        <option value="<?php echo $wou['UnitId']; ?>"><?php echo $wou['UnitName']; ?></option>
                    <?php } ?>
                </select>
            </div>
        </td>
        <td class="hideColumns"><input class="parent_text text-right" type="text" name="totalQty__1" id="totalQty__1" onblur="return FormatNum(this, 3)" readonly /></td>
        <td width="15%"><input class="parent_text text-right" type="text" name="rate__1" id="rate__1" onclick="qtyClick(this,'c')" onblur="return FormatNum(this, 2),checkqty(this,'c')" onkeypress="return isDecimal(event,this);" onchange="return calAmount('__1','d');" />
            <div style="position: relative; display:none;" id="wrfirst__1">
                <div class="top-tip top-addtip"style="background-color:#506faf ! important;margin-left:-43px ! important;top:-86px !important;width:140px !important;height:44px !important; ">
                    <span style="color:white;text-align:left">EstimateRate:<i id='rateSet__1' style="color:white"></i></span>
                </div>
            </div></td>
        <td width="20%"><input class="parent_text text-right" type="text" name="amount__1" id="amount__1" onblur="return FormatNum(this, 2)" readonly /></td>
        <td width="5%" align="center" class="action_btns_td">
            <ul class="action_btns">
                <li><a href="javascript:void(0);" class="hireDelete__1" id="deleteTr__1" onclick="deleteHireRow(this, event);" style="display:none;"><i class="fa fa-trash-o" data-toggle="tooltip" data-placement="top" data-original-title="Delete"></i></a></li>
            </ul>
        </td>
    </tr>
    </tbody>
</table>
<div class="modal fade bs-example-modal-lgs" id="picklistmodalhirebill" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabelhirebill" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times-circle-o clpot"></i></button>
                <h1><i class="fa fa-list"></i> Labour Strength Labour Picklist</h1>
            </div>
            <div class="modal-body">
                <div class="col-md-12 tab-pane" style="padding:0 !important" role="tabpanel" id="iow-view">
                    <div class="table-responsive clear">
                        <div id="hirebillltypepickgrid"> </div>
                    </div>
                </div>
            </div>
            <div class="clearfix"></div>
            <div class="modal-footer">
                <input type="hidden" id="hirebillpicklistrestype" value="">
                <input type="hidden" id="hirebillpicklistrow" value="">
                <a href="javascript:void(0);" class="md_cance" data-dismiss="modal">Cancel</a>
                <button type="button" class="md_ok" onclick="updatefromPickListhirebill()" data-dismiss="modal">OK</button>
            </div>
        </div>
    </div>
</div>
<script>
    $("#backPrev").hide();
    var hireList = '[]';
    var tmp_hireList = hireList;
    var recoveryAccounts=<?php echo (isset($recoveryAccounts)) ? json_encode($recoveryAccounts) : '[]';?>;


    $(function(){
        $('.ripple').materialripple();
        nextAccordian(1);

        expandQualTrFn();
        bindQualExpandTr();
        bindPopOver();
        <?php if($hbRegister ==''){?>
        finalNext();
        <?php } ?>

        <?php if(isset($hbHireTrans) && count($hbHireTrans) != 0) {
            $i = 1;
            foreach($hbHireTrans as $hbTrans) {
                ?>
        $('#qty_<?php echo $i; ?>').trigger('blur');
        $('#workingQty_<?php echo $i; ?>').trigger('blur');
        $('#totalQty_<?php echo $i; ?>').trigger('blur');
        $('#rate_<?php echo $i; ?>').trigger('blur');
        $('#amount_<?php echo $i; ?>').trigger('blur');
        <?php   $i++;}
               }?>
    });
    //    value="<?php //if($hireBillId != 0){echo $recoveryType['Amount']; }else{echo '0';}?>//"
    <?php if($hireBillId!= 0){
    $i=1;
    foreach($recoveryTypes as $recoveryType){?>
    $('#recoveryAmount_'+<?php echo $i;?>).val('<?php echo $recoveryType['Amount'];?>').trigger('blur').trigger('change');
    $('#hiddenRecoveryAmount_'+<?php echo $i;?>).val('<?php echo $recoveryType['Amount'];?>');
    $('#recoveryAccount_'+<?php echo $i;?>).val('<?php echo $recoveryType['AccountId'];?>');
    <?php if($recoveryType['Sign'] == "-"){?>
    $('#recoverySpanId_'+<?php echo $i;?>).removeClass('fa fa-plus clr-gre');
    $('#recoverySpanId_'+<?php echo $i;?>).addClass('fa fa-minus clr-red');
    $('#recoverySign_'+<?php echo $i;?>).val('-');
    <?php }else{?>
    $('#recoverySpanId_'+<?php echo $i;?>).removeClass('fa fa-minus clr-red')
    $('#recoverySpanId_'+<?php echo $i;?>).addClass('fa fa-plus clr-gre');
    $('#recoverySign_'+<?php echo $i;?>).val('+');
    <?php } ?>
    <?php  $i++; }?>
    <?php } ?>
    $(".mainTr").click(function(e){
        e.preventDefault();
        if(!$(this).closest("tr").next(".subTr").is(":visible")){
            $(this).closest("tr").next(".subTr").show();
            $(this).closest("tr").next(".subTr").find(".subDiv").slideDown("slow");
            $(this).find("i").addClass("tform");
        } else {
            $(this).closest("tr").next(".subTr").find(".subDiv").slideUp("slow");
            $(this).closest("tr").next(".subTr").slideUp("slow");
            $(this).find("i").removeClass("tform");
        }
    });

    $('.cnt_slider .carousel').carousel({
        interval: false
    });

    function nextAccordian(id)
    {
        $('#panelheading-' + id).trigger('click');
    }

    var $costCentreId = $('#costCentreId'),
        $vendorId = $('#vendorId'),
        $hoRegId = $('#hoRegId');

    function validateLabStg()
    {
        $('.error_message').hide();
        var currentIndex = $('#carousel-example-generic .item.active').index();
        //alert(currentIndex);
        if(currentIndex == 0) {
            var lCostCentreId = isNullCheck($costCentreId.val(),'number');
            var lVendorId = isNullCheck($vendorId.val(),'number');

            if (lCostCentreId == 0) {
                $costCentreId.closest('.form-group').find(".error_message").show();
                return;
            } else {
                var projName = $('#costCentreId option:selected').text();
                $('.projName').val(projName);
                $('.hprojName').html(projName);
                $('#hbDate').val($('#hbeDate').val());
                /*getValueOfSlider('next');
                 $('#carousel-example-generic').carousel({
                 slide: "next"
                 });*/
            }

            if (lVendorId == 0) {
                $vendorId.closest('.form-group').find(".error_message").show();
                return;
            } else {
                if ($hoRegId.val() == 0) {
                    $hoRegId.closest('.form-group').find(".error_message").show();
                    return;
                }
                var conName = $('#vendorId option:selected').text();
                var htName = $('#hoRegId option:selected').text();
                $('.conName').val(conName);
                $('.htName').val(htName);
                $('.hconName').html(conName);
                $('.hhtName').html(htName);
                getValueOfSlider('next');
                $('#carousel-example-generic').carousel({
                    slide: "next"
                });
            }
        } else {
            finalNext();
        }
    }

    function finalNext()
    {
        $.post(getBaseURL() + 'wpm/labourstrength/get-comp-cc-no', {
                typeId: $('#hbTypeId').val(),
                ccId: $costCentreId.val()
            },
            function (data) {
                var vNo = data.split('###');
                $('#ccHbNo').val($.trim(vNo[0]));
                $('#compHbNo').val($.trim(vNo[1]));
                if($.trim(vNo[0]) != '')
                    $('#ccHbNo').prop('readonly', true);
                if($.trim(vNo[1]) != '')
                    $('#compHbNo').prop('readonly', true);
            });
//    showBack('e');
        showCols($('#eHireTypeId').val());
        $.post(getBaseURL()+'wpm/labourstrength/get-ho-resources', { hoRegId: $hoRegId.val() },
            function(data) {
                hireList = JSON.parse(data);
                tmp_hireList = hireList;
                bindHireAutoComplete();
            });
    }

    function goBack()
    {
        $('#carousel-example-generic').carousel({
            slide: "prev"
        });
        getValueOfSlider('prev');
    }

    function getValueOfSlider(slType)
    {
        var curIndex = $('#carousel-example-generic .item.active').index();
        if(slType == 'next') {
            $("#backPrev").show();
        }
        if(curIndex == 1 && slType == 'prev') {
            $("#backPrev").hide();
        } else {
            $("#backPrev").show();
        }
    }

    //function showBack(sbType)
    //{
    //	if(sbType == 'a') {
    //		$('#submitDiv').hide();
    //		$('#stageTwo').hide();
    //		$('#stageOne').show();
    //		$('#titleTag').addClass('text-center');
    //	} else {
    //		$('#stageOne').hide();
    //		$('#stageTwo').show();
    //		$('#submitDiv').show();
    //		$('#titleTag').removeClass('text-center');
    //	}
    //}
    function qtyClick(x,y){
        var $x = $(x);
        var ids = $x[0].id.split('_');
        var rowid =ids[1];
        if(y == 'a') {
            $('#wfirst_' + rowid).show();
        }else if(y == 'b'){
            $('#wQfirst_'+rowid).show();
        }else if(y == 'c'){
            $('#wrfirst_'+rowid).show();
        }

    }
    function checkqty(x,y){
        var $x = $(x);
        var ids = $x[0].id.split('_');
        var rowid =ids[1];
        var eVal=parseInt($('#workSet_'+rowid).text());
        var etVal=parseInt($('#workingSet_'+rowid).text());
        var rateVal=parseInt($('#rateSet_'+rowid).text());
        var cQty=parseInt($('#qty_'+rowid).val());
        var wQty=parseInt($('#workingQty_'+rowid).val());
        var wRate=parseInt($('#rate_'+rowid).val());
        var hId=$('#hireTypeId').val();
        if(wQty == '' || isNaN(wQty)) wQty=0;
        if(cQty == '') cQty=0;
        if(wRate == '') wRate=0;
        if(eVal == '') eVal=0;
        if(etVal == '') etVal=0;
        if(rateVal == '' || isNaN(rateVal)) rateVal=0;
        if(y == 'a') {
            $('#wfirst_' + rowid).hide();
            if($("#hireTypeId").val()==1 || $("#hireTypeId").val() ==2) {
                if (parseFloat(eVal) < parseFloat(cQty * wQty)) {
                    $('#qty_' + rowid).addClass('red_bdr');
                    return false;
                } else {
                    $('#qty_' + rowid).removeClass('red_bdr');
                }
            }else if($("#hireTypeId").val() ==3){
                if (parseFloat(etVal) < parseFloat(cQty)) {
                    $('#qty_' + rowid).addClass('red_bdr');
                    return false;
                } else {
                    $('#qty_' + rowid).removeClass('red_bdr');
                }
            }
        }else if(y =='b'){
            $('#wQfirst_'+rowid).hide();
            if (parseFloat(etVal) < parseFloat(cQty * wQty)) {
                $('#workingQty_' + rowid).addClass('red_bdr');
                return false;
            } else {
                $('#workingQty_' + rowid).removeClass('red_bdr');
            }
        }else if(y == 'c'){
            $('#wrfirst_'+rowid).hide();
            if(parseFloat(rateVal) < parseFloat(wRate)){
                $('#rate_' + rowid).addClass('red_bdr');
                return false;
            }else{
                $('#rate_' + rowid).removeClass('red_bdr');
            }
        }
    }
    function showCols(hTypeId)
    {
        if(hTypeId == 1 || hTypeId == 2) {
            $('.hideColumns').show();
            $('.colspanId').attr("colspan", 5);
        } else if(hTypeId == 3 || hTypeId == 4) {
            $('.hideColumns').hide();
            $('.colspanId').attr("colspan", 3);
        }
    }

    function submitForm()
    {
        var errFlag = 0;
        var hbRows = $('#hireRows').val();
        var recoveryRows = $('#recoveryRows').val();
        var hbCnt = 0;
        for(var r=1;r<=recoveryRows;r++){
            var recoveryAmts=$('#recoveryAmount_'+r).val();
            if(recoveryAmts > 0){
                if($('#recoveryAccount_'+r).val() == '' || $('#recoveryAccount_'+r).val() == null){
                    $('#recoveryAccount_'+r).addClass('red_bdr');
                    $('#recoveryAccount_'+r).focus();
                    var recoveryName=$('#recoveryName_'+r).val();
                    alert("Please Select "+recoveryName+" Account Name ");
                    errFlag = 1;
                    return false;
                }
            }
        }

        $('.error_message').hide();
        $('.red_bdr').removeClass('red_bdr');

        if($.trim($('#fromDate').val()) != '' && $.trim($('#toDate').val()) != '') {
            if (!compareDate($('#fromDate').val(), $('#toDate').val())) {
                $('#toDate').addClass('red_bdr');
                $('#toDate').focus();
                errFlag = 1;
                return false;
            }
        }
        if($.trim($('#hbNo').val()) == '') {
            $('#hbNo').addClass('red_bdr');
            $('#hbNo').focus();
            errFlag = 1;
            return false;
        }
        if($.trim($('#ccHbNo').val()) == '') {
            $('#ccHbNo').addClass('red_bdr');
            $('#ccHbNo').focus();
            errFlag = 1;
            return false;
        }
        if($.trim($('#compHbNo').val()) == '') {
            $('#compHbNo').addClass('red_bdr');
            $('#compHbNo').focus();
            errFlag = 1;
            return false;
        }
        if($.trim($('#refNo').val()) == '') {
            $('#refNo').addClass('red_bdr');
            $('#refNo').focus();
            errFlag = 1;
            return false;
        }
        for (var i = 1; i <= hbRows; i++) {
            if($('#hireId_'+i).val() == '') {
                hbCnt = hbCnt + 1;
            }
        }
        if(hbRows == hbCnt) {
            $(".selOne").show();
            errFlag = 1;
            return false;
        }

        if(errFlag == 0) {
            $('#formWrapper').submit();
        }
    }

    /* For Hire */
    function addHireRow(x)
    {
        var $x = $(x),
            $tr = $x.closest('tr'),
            key = $x[0].id.split('_')[1];

        if ($tr.next('tr:not(.total)').length != 0)
            return;

        if ($('#hireName_' + key).val().length == 0 && $('#hireId_' + key).val().length == 0)
            return;

        var $rowid = $('#hireRows'),
            count = parseInt($rowid.val()) + 1,
            template = $('#dummy-hire-row tbody').html();

        template = template.replace(/__1/g, '_' + count);
        $('#hireTable tbody').find('.total').before(template);
        $rowid.val(count);
//    $('#qty_'+key).prop('blur',this);
//    $('#workingQty_'+key).trigger('blur');
//    $('#totalQty_'+key).trigger('blur');
//    $('#rate_'+key).trigger('blur');
//    $('#amount_'+key).trigger('blur');
        $('.hireDelete_' + key).show();
        bindHireAutoComplete();
    }

    function insertHireRow(hoRgId)
    {
        var $rowid = $('#hireRows'),
            count = parseInt($rowid.val()) + 1,
            template = $('#dummy-hire-row tbody').html();

        template = template.replace(/__1/g, '_' + count);
        $('#hireTable tbody').find('.total').before(template);
        $rowid.val(count);
        bindHireAutoComplete();
    }

    function deleteHireRow(x,e)
    {    var $x = $(x);
        var ids = $x[0].id.split('_');
        var rowid =ids[1];
        e.preventDefault();
        if (!confirm('Do you want to Delete'))
            return false;

        var $tr = $(x).closest('tr'),
            $tbody = $tr.parent('tbody');

        if ($tbody.find('> tr:not(.total)').length == 1) {
            var template = $('#dummy-hire-row tbody').html();
            template = template.replace(/__1/g, '_' + 1);
            $tbody.append(template);
            $('#hireRows').val(1);
        }
        var $x = $(x);
        var ids = $x[0].id.split('_');
        var rowid =ids[1];
        var mqty=parseFloat($('#totalAmount').val())-parseFloat($('#amount_'+rowid).val());
        $('#totalAmount').val(mqty).trigger('blur');
        $tr.remove();
        return false;
    }

    function bindHireAutoComplete(hoRgId)
    {
        $('#hireTable .hireSuggest').autocomplete({
            lookup: tmp_hireList,
            lookupFilter: function (suggestion, originalQuery, queryLowerCase) {
                if (queryLowerCase == '*') {
                    return suggestion.value;
                } else {
                    var re = new RegExp($.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');
                    return re.test(suggestion.value);
                }
            }, onSelect: function(suggestion) {
                if(suggestion) {
                    var $this = $(this);
                    var key1 = $this[0].id.split('_')[1];
                    $this.prop('readonly', true).addClass('border-none');

                    $('#hireId_'+ key1).val(suggestion.data);
                    $('#unitId_'+ key1).val(suggestion.UnitId);
                    $('#unitName_'+ key1).val(suggestion.UnitName);
                    $('#rate_'+ key1).val(suggestion.Rate).trigger('blur');
                    $('#workSet_'+ key1).text(sanitizeNumber(suggestion.TotalQty,3));
                    $('#workingSet_'+ key1).text(sanitizeNumber(suggestion.TotalQty,3));
                    $('#rateSet_'+ key1).text(sanitizeNumber(suggestion.Rate,2));
                    $('#workingUnitId_'+ key1).val(suggestion.WorkingUnitId).prop('disabled',true);
                    addHireRow($this);
                    removeError($(this));
                }
            }, onSearchStart: function(suggestion) {
                var $this = $(this);
                var key1 = $this[0].id.split('_')[1];

                $('#hireId_'+key1).val('');
                $('#unitId_'+ key1).val('');
                $('#unitName_'+ key1).val('');
            }, onSearchComplete: function (query, suggestions) {
                if(!suggestions.length){
                    $(this).addClass('error');
                } else
                    removeError($(this));
            }
        });

    }

    function checkHBUsed(x) {
        var id = $(x)[0].id.split('_')[1];
        var reskeyid = $('input[id*=hireId_]');
        console.log(hireList);
        tmp_hireList = hireList;
        tmp_hireList = $.grep(hireList, function (element, index) {
            var is_selected = true;
            $.each(reskeyid, function (i, obj) {
                var $this = $(this),
                    name = $this[0].id;
                var arrname = name.split('_');
                var key1 = arrname[1];
                if (key1 != id) {
                    if (element.data == $this.val()) {
                        is_selected = false;
                        return false;
                    }
                }
            });
            return is_selected;
        });
        bindHireAutoComplete();
    }

    function getResources(hoRgId)
    {
        $.post(getBaseURL()+'wpm/labourstrength/get-ho-resources', { hoRegId: hoRgId },
            function(data) {
                hireList = JSON.parse(data);
                tmp_hireList = hireList;
            });
    }

    function calAmount(roId,roType)
    {
        var amt = 0;
        if(roType == 'r') {
            rId = roId;
        } else {
            var roIdSp = roId.split('_');
            rId = roIdSp[1];
        }

        var totQty = 0;
        if($('#qty_'+rId).val() != '' && $('#workingQty_'+rId).val() != '') {
            totQty = parseFloat($('#qty_'+rId).val()) * parseFloat($('#workingQty_'+rId).val());
        } else {
            if($('#qty_'+rId).val() != '') {
                totQty = parseFloat($('#qty_'+rId).val());
            } else if($('#workingQty_'+rId).val() != '') {
                totQty = parseFloat($('#workingQty_'+rId).val());
            }
        }
        $('#totalQty_'+rId).val(totQty).trigger('blur');

        var amt = 0;
        if($('#totalQty_'+rId).val() != '' && $('#rate_'+rId).val() != '') {
            amt = parseFloat($('#totalQty_' + rId).val()) * parseFloat($('#rate_' + rId).val());
        }
        $('#amount_'+rId).val(amt).trigger('blur');

        sumAmount();
    }

    function sumAmount()
    {
        var $samt = $('input[id^=amount_]');
        var sumAmt = 0;
        $.each($samt, function() {
            var seAmt = parseFloat($(this).val());

            if (isNaN(seAmt))
                return;

            sumAmt += seAmt;
        });
        $('#totalAmount').val(numberFormat(sumAmt,'C')).trigger('change');
        var totRecovery=$('#recoveryHireBill').val();
        var totQualifier=$('#qualAmt').val();
        var totBase=$('#totalAmount').val();
        $('#totAmount').val(numberFormat((parseFloatVal(totBase)+parseFloatVal(totQualifier)+parseFloatVal(totRecovery)),'C'));
    }

    <?php if(isset($hbHireTrans) && count($hbHireTrans) != 0) { ?>
    getResources('<?php echo $hbRegister['HORegisterId']; ?>');
    //showBack('e');
    //    $('.cancel_btn').hide();
    showCols('<?php echo $hbRegister['HireTypeId']; ?>');
    insertHireRow();
    sumAmount();
    <?php } ?>
    <?php if($hbRegister!= ''){?>
    <?php if($hbRegister['Approve'] == 'Y'){?>
    $('.save_btn').hide();
    <?php } }?>

    //Qualifier start
    function expandQualTrFn(reset) {
        var $mainTRs = $("a[class*=qualTr]");
        if (typeof reset !== 'undefined' && reset === true) $mainTRs.unbind('click');
        $mainTRs.click(function(e){
            e.preventDefault();
            var name = $(this)[0].className;
//            key = name.split('_')[1];
//        if (validateRow(name) == false) return false;
            var $subTr = $(this).closest("tr").nextAll(".qualmainTr"),
                $i = $(this).find("i");
            if(!$subTr.is(":visible")){
                $subTr.show();
                $subTr.find(".subDiv").slideDown("slow");
                $i.removeClass("fa-chevron-circle-down");
                $i.addClass("fa-chevron-circle-up");
//            $('rateanal_'+ key +'_restable').show();
//            iFocusRowId = key;
                closeQualdetails();
            } else {
                $subTr.find(".subDiv").slideUp("slow");
                $subTr.slideUp("slow");
                $i.removeClass("fa-chevron-circle-up");
                $i.addClass("fa-chevron-circle-down");
            }
            return false;
        });
    }

    function closeQualdetails(key) {
        var $mainTRs = $("a[class*=qualTr]");
        $.each($mainTRs, function (i, obj) {
            var $this = $(this),
                $mainTr = $this.find('> i.fa-chevron-circle-down.tform');
//        if (typeof key != 'undefined' && $this[0].className.indexOf(key) != -1) return;
            if($mainTr.length != 0) $mainTr.trigger('click');
        });
    }

    function bindQualExpandTr() {
        var $mainTr = $(".qualmainExp");
        $mainTr.unbind('click');
        $mainTr.click(function (e) {
            e.preventDefault();
            if (!$(this).closest("tr").next(".qualsubTr").is(":visible")) {
                closeQualTr();
                $(this).closest("tr").next(".qualsubTr").show();
                $(this).closest("tr").next(".qualsubTr").find(".subDiv").slideDown("slow");
            }
            else {
                $(this).closest("tr").next(".qualsubTr").find(".subDiv").slideUp("slow");
                $(this).closest("tr").next(".qualsubTr").slideUp("slow");
            }
        });
    }

    function closeQualTr() {
        var $mainTr = $(".qualmainExp");
        $.each($mainTr, function () {
            $(this).closest("tr").next(".qualsubTr").find(".subDiv").slideUp("slow");
            $(this).closest("tr").next(".qualsubTr").slideUp("slow");
        });
    }

    function bindPopOver() {
        var $inputs =  $('input[data-toggle="popover"]');
        $inputs.unbind('popover');
        $inputs.popover({
            placement : 'auto left',
            trigger : 'hover'
        });
    }

    function myfunc(x){
        $(".base").val(x);
        CalcQualifier();
        var $mainTr = $(".qualChange");
        $mainTr.change(function (e) {
            CalcQualifier();
        });
    }

    function CalcQualifier() {
        $.each($(".base"), function () {
            var qId = $(this).attr('id').split('_')[4];
            var iId = $(this).attr('id').split('_')[2];
            var sFormula = isNullCheck($('#QualR__' + iId + '_Exp_' + qId).val(), 'string');
            var dbaseAmt = isNullCheck($('#QualR__' + iId + '_ExpValue_' + qId).val(), 'string');
            var dPer = parseFloatVal(isNullCheck($('#QualR__' + iId + '_ExpPer_' + qId).val(), 'number'));
            var sbaseRef = 'R0';
            if (parseFloatVal(dPer) == 0) dPer = 100;
            var sFormula = sFormula.replace(new RegExp(sbaseRef, 'g'), dbaseAmt);
            var fvaule = computeEval(sFormula);
            var iQualTypeid = $('#QualR__' + iId + '_TypeId_' + qId).val();

            var dAmt=0;
            if (iQualTypeid==1 || iQualTypeid==2) {
                var dTaxablePer = parseFloatVal(isNullCheck($('#QualR__' + iId + '_TaxablePer_' + qId).val(),'number'));
                var dTaxPer = parseFloatVal(isNullCheck($('#QualR__' + iId + '_TaxPer_' + qId).val(),'number'));
                var dCess = parseFloatVal(isNullCheck($('#QualR__' + iId + '_CessPer_' + qId).val(),'number'));
                var dEDCess = parseFloatVal(isNullCheck($('#QualR__' + iId + '_EduCessPer_' + qId).val(),'number'));
                var dHEDCess = parseFloatVal(isNullCheck($('#QualR__' + iId + '_HEduCessPer_' + qId).val(),'number'));
                var dNetPer = dTaxPer + (dTaxPer * (dCess +  dEDCess + dHEDCess))/100;
                $('#QualR__' + iId + '_NetPer_' + qId).val(dNetPer);

                $('#QualR__' + iId + '_NetPer_' + qId).val(numberFormat(dNetPer,'C'));
                $('#QualR__' + iId + '_ExpPer_'+ qId).val(numberFormat(dNetPer,'C'));

                var dTaxableAmt =  fvaule* (dTaxablePer/100);
                var dTaxAmt =  dTaxableAmt* (dTaxPer/100);
                var dCessAmt =  dTaxAmt* (dCess/100);

                var dEDAmt =  dTaxAmt* (dEDCess/100);
                var dHEDAmt =  dTaxAmt* (dHEDCess/100);
                var dNetAmt = dTaxAmt+dCessAmt+dEDAmt+dHEDAmt;

                $('#QualR__' + iId + '_TaxableAmt_'+ qId).val(numberFormat(dTaxableAmt,'C'));
                $('#QualR__' + iId +  '_TaxPerAmt_'+ qId).val(numberFormat(dTaxAmt,'C'));
                $('#QualR__' + iId + '_CessAmt_'+ qId).val(numberFormat(dCessAmt,'C'));
                $('#QualR__' + iId + '_EduCessAmt_'+ qId).val(numberFormat(dEDAmt,'C'));
                $('#QualR__' + iId + '_HEduCessAmt_'+ qId).val(numberFormat(dHEDAmt,'C'));
                $('#QualR__' + iId + '_NetAmt_'+ qId).val(numberFormat(dNetAmt,'C'));

                dAmt = dNetAmt;
            }else{
                dAmt = parseFloatVal(fvaule) * (parseFloatVal(dPer) / 100);
            }
//        var dAmt = parseFloatVal(fvaule) * (parseFloatVal(dPer) / 100);
            $('#QualR__' + iId + '_Amount_' + qId).val(numberFormat(dAmt,'C'));
        });
        sign();
    }

    function sign(){
        var tot=0;
        $.each($(".signCh"), function () {
            var qId = $(this).attr('id').split('_')[4];
            var iId = $(this).attr('id').split('_')[2];
            var cAmt=parseFloatVal($('#QualR__' + iId + '_Amount_' + qId).val());
            var yesNo=$('#QualR__' + iId +'_YesNo_'+ qId).is(':checked');
            var sSign='-';
            if ($('#QualR__' + iId +'_SignC_' + qId).hasClass("fa-plus")) {
                sSign='+';
            }
            if(yesNo== true){
                if (sSign =="-") {
                    tot = tot - parseFloatVal(cAmt);
                } else {
                    tot = tot + parseFloatVal(cAmt);
                }
            }
        });
        $('#QualRTotalAmt__1').val(numberFormat(tot,'C'));
        $('#qualAmt').val(numberFormat(tot,'C'));
        var totRecovery=$('#recoveryHireBill').val();
        var totQualifier=$('#qualAmt').val();
        var totBase=$('#totalAmount').val();
        $('#totAmount').val(numberFormat((parseFloatVal(totBase)+parseFloatVal(totQualifier)+parseFloatVal(totRecovery)),'C'));
    }

    function signChange(x) {
        var $this = $(x);
        if ($this.hasClass( "fa-plus" )) {
            $this.removeClass('fa-plus clr-gre');
            $this.addClass('fa-minus clr-red');
            var sname= $this[0].id.split('_')[0],
                key1 = $this[0].id.split('_')[1],
                key2 = $this[0].id.split('_')[3];
            $('#' +  sname + '_' + key1 + '_Sign_' + key2).val('-');
        } else {
            $this.removeClass('fa-minus clr-red');
            $this.addClass('fa-plus clr-gre');
            var sname= $this[0].id.split('_')[0],
                key1 = $this[0].id.split('_')[1],
                key2 = $this[0].id.split('_')[3];
            $('#' +  sname + '_' + key1 + '_Sign_' + key2).val('+');
        }
        sign();
    }
    function validPercent(){
        CalcQualifier();
    }
    function yesNo(){
        CalcQualifier();
    }
    //recovery
    function recoverySignChange(x) {
        var $this = $(x);
        if ($this.hasClass( "fa-minus" )) {
            $this.removeClass('fa-minus clr-red');
            $this.addClass('fa-plus clr-gre');
            var sname= $this[0].id.split('_')[0],
                key1 = $this[0].id.split('_')[1];

            $('#recoverySign_'+key1).val('+');
        } else {
            $this.removeClass('fa-plus clr-gre');
            $this.addClass('fa-minus clr-red');
            var sname= $this[0].id.split('_')[0],
                key1 = $this[0].id.split('_')[1];
            $('#recoverySign_'+key1).val('-');
        }
        recoveryTotAmt();
    }
    function recoveryTotAmt()
    {
        var tot=0;
        var balAdv=parseInt($('#balAdv').val());
        $.each($(".amtCh"), function () {
            var qId = $(this).attr('id').split('_')[1];
            if(qId == 3){
                var advAmt=parseInt($('#recoveryAmount_' + qId).val());
                var hiddenAdvAmt=parseInt($('#hiddenRecoveryAmount_' + qId).val());
                if(isNaN(hiddenAdvAmt)){
                    hiddenAdvAmt=0;
                }
                if(parseFloat(balAdv+hiddenAdvAmt) < parseFloat(advAmt)){
                    alert("Greater Than Balance Advance Amount");
                    $('#recoveryAmount_' + qId).val(0);
                    return false;
                }
            }
            var sumAmt=parseFloatVal($('#recoveryAmount_' + qId).val());
            var sSign='+';
            if ($('#recoverySign_' +qId).val() == "-") {
                sSign='-';
            }
            if (sSign =="-") {
                tot = tot - parseFloatVal(sumAmt);
            } else {
                tot = tot + parseFloatVal(sumAmt);
            }
        });

        $('#recoveryTotal').val(tot).trigger('blur');
        $('#recoveryHireBill').val(tot).trigger('blur');
        var totRecovery=$('#recoveryHireBill').val();
        var totQualifier=$('#qualAmt').val();
        var totBase=$('#totalAmount').val();
        $('#totAmount').val(numberFormat((parseFloatVal(totBase)+parseFloatVal(totQualifier)+parseFloatVal(totRecovery)),'C'));
    }
    function bindAccountHeadAutoComplete(x)
    {
        var id = $(x)[0].id;
        var ids = id.split('_');
        var rowid =ids[1];
        var typeId=0;
        if(rowid == 1) {
            typeId = 9;
        }else if(rowid == 4){
            typeId=10;
        }
//        else if(rowid == 'advanceRecoverAccountName'){
//                    typeId=9;
//        }
// else if(rowid == 'penaltyAccountName'){
//            typeId=7;
//        }else if(rowid == 'roundingOffAccountName'){
//            typeId=22;
//        }
        var arr_accountMasterNew = $.grep(recoveryAccounts, function(element, index){
            return element.TypeId == typeId;
        });
//        console.log(arr_accountMasterNew)
        $('#recoveryAccount_'+rowid).autocomplete({
            lookup: arr_accountMasterNew,
            lookupFilter: function (suggestion, originalQuery, queryLowerCase) {
                if (queryLowerCase == '*') {
                    return suggestion.value;
                } else {
                    var re = new RegExp($.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi');
                    return re.test(suggestion.value);
                }
            }, onSelect: function(suggestion) {
                if(suggestion) {
                    var $this = $(this);
                    $this.prop('readonly', true).addClass('border-none');
                    if(rowid == 1){
                        $('#recoveryAccount_'+rowid).val(suggestion.value);
                        $('#recoveryAccountId_'+rowid).val(suggestion.data);
                    }else if(rowid == 4){
                        $('#recoveryAccount_'+rowid).val(suggestion.value);
                        $('#recoveryAccountId_'+rowid).val(suggestion.data);
                    }
//                    else if(rowid == 'withHeldAccountName'){
//                        $('#withHeldAccountId').val(suggestion.data);
//                        $('#withHeldAccountName').val(suggestion.value);
//                    }else if(rowid == 'advanceRecoverAccountName'){
//                        $('#advanceRecoverAccountId').val(suggestion.data);
//                        $('#advanceRecoverAccountName').val(suggestion.value);
//                    }else if(rowid == 'penaltyAccountName'){
//                        $('#penaltyAccountId').val(suggestion.data);
//                        $('#penaltyAccountName').val(suggestion.value);
//                    }else if(rowid == 'roundingOffAccountName'){
//                        $('#roundingOffAccountId').val(suggestion.data);
//                        $('#roundingOffAccountName').val(suggestion.value);
//                    }
                }
            }, onSearchStart: function(suggestion) {
                var $this = $(this);
                $('#AccountId').val('');
                $('#AccountHead').val('');
            }, onSearchComplete: function (query, suggestions) {
                if(!suggestions.length){
                    $(this).addClass('error');
                } else
                    removeError($(this));
            }
        });
    }
   // hir bill pick list
    function showPickList() {
        var key1 = $('#hireRows').val();
        checkHBUsedpick(key1);
        bindLtypePickListGrid();
        $("#picklistmodalhirebill").modal('show');
    }
    function checkHBUsedpick(key) {

        var reskeyid = $('input[id*=hireId_]');
        tmp_hireList = hireList;
        tmp_hireList = $.grep(hireList, function (element, index) {
            var is_selected = true;
            $.each(reskeyid, function (i, obj) {
                var $this = $(this),
                    name = $this[0].id;
                var arrname = name.split('_');
                var key1 = arrname[1];
                if (key1 != key) {
                    if (element.data == $this.val()) {
                        is_selected = false;
                        return false;
                    }
                }
            });
            return is_selected;
        });
        bindHireAutoComplete();
    }
    function bindLtypePickListGrid() {
        var parent = $("#hirbillltypepickgrid").parent();
        $("#hirbillltypepickgrid").remove();
        $("<div id='hirbillltypepickgrid'></div>").appendTo(parent);
        var source = {
            localdata: tmp_hireList,
            dataFields: [
                {name: 'data', type: 'number'},
                {name: 'value', type: 'string'},
                {name: 'IsCheck', type: 'bool'},
                {name: 'UnitName', type: 'string'},
                {name: 'WorkingUnitId', type: 'string'},
                {name: 'UnitId', type: 'number'},
                {name: 'TotalQty', type: 'number'},
                {name: 'Rate', type: 'number'},
                {name: 'IsCheck', type: 'boolean'}
            ],
            dataType: "json"
        };

        var rfcdata = new $.jqx.dataAdapter(source);


        $("#hirebillltypepickgrid").jqxGrid({
            width: '100%',
            pageable: true,
            rowsheight: 35,
            selectionMode: 'singlecell',
            pagerButtonsCount: 6,
            autoheight: true,
            source: rfcdata,
            altrows: true,
            filterable: true,
            showfilterrow: true,
            editable: true,
            columnsResize: true,
            columns: [
                {text: '', dataField: 'data', hidden: true, filterable: false},
                {text: '', dataField: 'UnitId', hidden: true, filterable: false},
                {text: '', dataField: 'UnitName', hidden: true, filterable: false},
                {text: '', dataField: 'Rate', hidden: true, filterable: false},
                {text: '', dataField: 'TotalQty', hidden: true, filterable: false},
                {text: '', dataField: 'WorkingUnitId', hidden: true, filterable: false},
                {text: 'Hire list', dataField: 'value', width: '90%', editable: false},
                {text: 'Select', dataField: 'IsCheck', width: '10%', columntype: 'checkbox', filterable: false, editable: true, resizable: false, type: 'bool'
                }
            ]
        });
    }
    function updatefromPickListhirebill() {
        $('.loading_area').show();
        var rows = $('#hirebillltypepickgrid').jqxGrid('getrows');
        for (var i = 0; i < rows.length; i++) {
            if (rows[i]['IsCheck'] == true) {
                var key1 = $('#hireRows').val();
                $('#hireId_'+ key1).val(rows[i].data);
                $('#unitId_'+ key1).val(rows[i].UnitId);
                $('#hireName_'+key1).val(rows[i].value);
                $('#unitName_'+ key1).val(rows[i].UnitName);
                $('#rate_'+ key1).val(rows[i].Rate).trigger('blur');
                $('#workSet_'+ key1).text(sanitizeNumber(rows[i].TotalQty,3));
                $('#workingSet_'+ key1).text(sanitizeNumber(rows[i].TotalQty,3));
                $('#rateSet_'+ key1).html(sanitizeNumber(rows[i].Rate,2));
                $('#workingUnitId_'+ key1).val(rows[i].WorkingUnitId).prop('disabled',true);
                addHireRowpick( key1);
            }
        }
        $('#picklistmodal').modal('toggle');
        $('.loading_area').hide();
    }

    function addHireRowpick(x)
    {
      /*  var $x = $(x),
            $tr = $x.closest('tr'),
            key = $x[0].id.split('_')[1];

        if ($tr.next('tr:not(.total)').length != 0)
            return;

        if ($('#hireName_' + key).val().length == 0 && $('#hireId_' + key).val().length == 0)
            return;*/

        var $rowid = $('#hireRows'),
            count = parseInt($rowid.val()) + 1,
            template = $('#dummy-hire-row tbody').html();

        template = template.replace(/__1/g, '_' + count);
        $('#hireTable tbody').find('.total').before(template);
        $rowid.val(count);
        $('.hireDelete_' + x).show();
        bindHireAutoComplete();
    }
</script>
 