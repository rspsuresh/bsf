/*
	Copyright (c) 2014 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/
var CRD = CRD || {};
CRD.Slideshow = function(e, n, t) {
    "use strict";

    function i(e) {
        $.each(e, function(e, n) {
            nn[e] = n
        }) /*,Q="undefined"!=typeof nn.isTouch?!!nn.isTouch:"ontouchstart"in window||navigator.msPointerEnabled||window.DocumentTouch&&document instanceof DocumentTouch*/
    }

    function o(e) {
        function n() {
            var n, t, i;
            V.viewportWidth = Math.floor(document.documentElement.clientWidth), nn.breakpoints && ($.each(nn.breakpoints, function(e, o) {
                return o.range && (n = o.range[0], t = o.range[1], V.viewportWidth >= n && (!t || V.viewportWidth <= t)) ? void(i = e) : void 0
            }), "undefined" != typeof i && (e || (V.breakpoint = i), e && nn.breakpoints[i].callback && V.breakpoint !== i && (V.breakpoint = i, A && A.length && nn.breakpoints[i].callback())))
        }
        R && clearTimeout(R), R = c(n, e ? 300 : 0)
    }

    function s(e) {
        function n() {
            V.width = A.outerWidth()
        }
        N && clearTimeout(N), N = c(n, e ? 300 : 0)
    }

    function a() {
        var e = A ? !1 : !0;
        if (e || (G = !1, f.call(this, void 0, {
                slide: 0
            }), L.removeAttr("style"), P.removeAttr("style")), A = $(nn.slideshow), L = A.find("." + nn.classSlide), P = A.find("." + nn.classStrip), U = L.length, A.length && !(2 > U)) {
            S = P[0].style;
            var n = L.first(),
                t = 100 / U + "%";
            P.outerWidth(100 * U + "%"), L.outerWidth(t), n.width() && n.get(0).style.width.slice(0, 4) === t.slice(0, 4) || L.width(t), j = nn.canLoop ? Math.floor((U - 1) / 2) : 0, B = 0, T(), M(), C(), e && (_(), Q && D()), x(), V.element = A, V.strip = P, V.slides = L, A.removeClass(nn.classDisabled)
        }
    }

    function r() {
        nn.isManual || (z = c(function() {
            f()
        }, nn.interval))
    }

    function l() {
        clearTimeout(Y), clearTimeout(z)
    }

    function c(e, n) {
        return setTimeout(e, n || 0)
    }

    function d(e) {
        f.call(this, e, {
            isPrev: !1
        })
    }

    function u(e) {
        f.call(this, e, {
            isPrev: !0
        })
    }

    function f(e, n) {
        var i = V.index,
            o = nn.isCarousel ? nn.time : 0;
        if (!G && (K = n && n.isPrev, v.call(this, n && n.slide), !V.slide.is(V.slideNext))) {
            var s = t ? t.call(V, e) : !0;
            (s || "undefined" == typeof s) && (G = !0, l(), e && "hashchange" === e.type && (o = 0), h(k(i), o, function() {
                p(e)
            }))
        }
        e ? e.preventDefault() : r()
    }

    function h(e, n, t, i) {
        function o() {
            H = !1, e || 0 === e || (e = k(V.index)), n = n || 0, tn && nn.isCarousel ? (i = i || 0, n && t && P.one(en.toLowerCase() + "TransitionEnd transitionend", t), S[en + "Transition"] = n ? n / 1e3 + "s" : "", S[en + "Transform"] = "translateX(" + -1 * (b(e, !0) - i) + "%)", !n && t && t()) : P.stop(!0, !0).animate({
                left: b(e) + "%"
            }, n, t)
        }
        on && "undefined" != typeof i ? (H = !0, I = requestAnimationFrame(o)) : o()
    }

    function p(e) {
        V.slide = V.slideNext, G = !1, L.removeClass(nn.classSlideActive), V.slide.addClass(nn.classSlideActive), S[en + "Transition"] = "", nn.canLoop && C(), x(), e && (("click" === e.type || "hashchange" === e.type) && c(function() {
            V.slide.focus()
        }), n && n.call(V, e))
    }

    function v(e) {
        var n = $(this),
            t = V.index,
            i = U - 1,
            o = n.is(E) ? nn.step : 1;
        "undefined" != typeof e ? (K = t > e ? !0 : !1, t = e) : K ? (t -= o, t = 0 >= t ? nn.canLoop ? g(t) : 0 : t) : (t += o, t = t >= i ? nn.canLoop ? g(t) : i : t), V.slideNext = L.eq(t), V.index = t
    }

    function m() {
        return !nn.canLoop && (K && 0 === V.index || !K && V.index === U - 1)
    }

    function w(e) {
        W && (e ? f.call(this, e, {
            slide: q.index(this)
        }) : q.removeClass(nn.classMarkerActive).eq(V.index).addClass(nn.classMarkerActive)), X && X.html("<strong>" + (V.index + 1) + "</strong>/<strong>" + U + "</strong>")
    }

    function x() {
        var e, n = nn.classDisabled;
        if (!nn.canLoop) {
            switch (E.removeClass(n), V.index) {
                case 0:
                    e = F;
                    break;
                case U - 1:
                    e = O
            }
            e && e.addClass(n)
        }
        w()
    }

    function b(e, n) {
        return n ? e * (100 / U) : -100 * e
    }

    function g(e) {
        return e >= U && (e -= U), 0 > e && (e = U + e), e
    }

    function k(e) {
        return g(V.index + (nn.canLoop ? j - e : 0))
    }

    function y(e) {
        return g(nn.canLoop ? e - j + V.index : e)
    }

    function M(e) {
        var n, t;
        V.slide || (V.slide = L.filter("." + nn.classSlideActive).first(), V.index = L.index(V.slide)), location.hash && (n = L.filter(location.hash), t = L.index(n), n.length && V.index !== t && f(e, {
            slide: t
        })), V.slide.length || (V.index = 0, V.slide = L.eq(V.index)), c(function() {
            A.scrollTop(0), A.scrollLeft(0)
        })
    }

    function C() {
        for (var e, n, t, i = U; i--;) e = L.eq(y(i)), n = e.data("x"), t = b(i, !0) + "%", t !== n && e.css({
            left: t,
            display: nn.display
        }).attr("tabindex", "-1").data("x", t);
        h(nn.canLoop ? j : V.index)
    }

    function T() {
        if (nn.markers) {
            W = $(nn.markers);
            for (var e = U; e--;) W.prepend($("<button>" + (e + 1) + "</button>").addClass(nn.classMarker));
            q = W.find("button")
        }
        nn.numbers && (X = $(nn.numbers).text("1/9"))
    }

    function _() {
        A.mouseenter(l).mouseleave(r), O = $(nn.next).on("click touchend", d), F = $(nn.previous).on("click touchend", u), E = F.add(O), Y = c(r, nn.delay), nn.markers && W.length && W.on("click touchend", "button", w), $(window).on("hashchange", M), s(), $(window).resize(s)
    }

    function D() {
        function e(e) {
            var i = E || W && W.add(E),
                a = e.originalEvent,
                l = a.touches && a.touches[0] || a;
            i.has(e.target).length || i.is(e.target) || (G && p(), o = {
                x: l.pageX || l.screenX,
                y: l.pageY || l.screenY,
                time: +new Date
            }, s = {}, J = void 0, A.on(r, n), A.on(c, t))
        }

        function n(e) {
            var n = e.originalEvent,
                t = n.touches && n.touches[0] || n;
            H || t.length > 1 || n.scale && 1 !== n.scale || (s = {
                x: (t.pageX || t.screenX) - o.x,
                y: (t.pageY || t.screenY) - o.y
            }, "undefined" == typeof J && (J = !!(J || Math.abs(s.x) < Math.abs(s.y))), J || (e.preventDefault(), l(), K = s.x > 0, G = !0, !nn.canLoop && m() && (s.x = s.x / (Math.abs(s.x) / V.width + 1)), h(null, null, null, s.x / V.width * (100 / U))))
        }

        function t() {
            if (!J) {
                var e = +new Date - o.time,
                    i = Math.abs(s.x),
                    a = 250 > e && i > 20 || i > V.width / 3;
                G = !1, on && cancelAnimationFrame(I), a && !m() ? f.call(this, event, {
                    isPrev: K
                }) : i > 0 && h(null, nn.time)
            }
            A.off(r, n), A.off(c, t)
        }

        function i(e) {
            !J && G && e.preventDefault()
        }
        var o, s, a = "touchstart pointerdown MSPointerDown",
            r = "touchmove pointermove MSPointerMove",
            c = "touchend touchleave touchcancel MSPointerUp MSPointerOut MSPointerCancel pointerup pointerleave pointercancel";
        nn.isCarousel = !0, A.on(a, e).on("click", i).addClass(nn.classTouch)
    }
    var S, A, L, P, W, q, X, E, F, O, Y, z, N, R, I, U, j, B, G, H, J, K, Q, V = this,
        Z = ["ms", "O", "Moz", "Webkit", ""],
        en = "",
        nn = {
            next: ".slideshow_button_next",
            previous: ".slideshow_button_previous",
            markers: ".slideshow_markers",
            numbers: ".slideshow_numbers",
            classStrip: "slideshow_strip",
            classSlide: "slideshow_slide",
            classSlideActive: "slideshow_slide_sticky",
            classMarker: "slideshow_marker",
            classMarkerActive: "slideshow_marker_sticky",
            classDisabled: "slideshow_disabled",
            classTouch: "slideshow_enable_touch",
            step: 1,
            delay: 3e3,
            interval: 5e3,
            time: 400,
            display: "block",
            canLoop: !1,
            isManual: !0,
            isCarousel: !0,
            breakpoints: []
        },
        tn = function() {
            for (var e = document.body.style, n = Z.length; n--;)
                if ("string" == typeof e[Z[n] + "Transition"]) {
                    en = Z[n];
                    break
                }
            return !!en
        }(),
        on = function() {
            return !(!window.requestAnimationFrame || !window.cancelAnimationFrame)
        }();
    i(e || {}), $(window).resize(o), o(), V.init = a, V.start = r, V.stop = l, V.next = d, V.prev = u, V.change = f, V.transition = h, V.getTransitionX = b, V.getIndexWrapped = g, V.getIndexOffset = k, V.getPositionOffset = y, V.updateConfig = i
};